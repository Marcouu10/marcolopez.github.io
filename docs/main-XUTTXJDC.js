import{a as U,b as Pe,c as rf,d as R,e as Aw,f as tc,g as xw,h as Rw,i as Mw,j as of,k as Nw,l as Qs,m as sf,n as nc,o as Pw,p as kw,q as af,r as Fe,s as Yr,t as yn,u as rc,v as Ys,w as Ow,x as Fw,y as fr,z as Rt}from"./chunk-4ZHOUZTK.js";var cf=null;var uf=1,Lw=Symbol("SIGNAL");function De(n){let e=cf;return cf=n,e}function Vw(){return cf}var lf={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function qA(n){if(!(gf(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===uf)){if(!n.producerMustRecompute(n)&&!hf(n)){n.dirty=!1,n.lastCleanEpoch=uf;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=uf}}function df(n){return n&&(n.nextProducerIndex=0),De(n)}function jw(n,e){if(De(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(gf(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)pf(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function hf(n){mf(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(qA(t),r!==t.version))return!0}return!1}function ff(n){if(mf(n),gf(n))for(let e=0;e<n.producerNode.length;e++)pf(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function pf(n,e){if(zA(n),n.liveConsumerNode.length===1&&GA(n))for(let r=0;r<n.producerNode.length;r++)pf(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];mf(i),i.producerIndexOfThis[r]=e}}function gf(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function mf(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function zA(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function GA(n){return n.producerNode!==void 0}function WA(){throw new Error}var KA=WA;function Bw(n){KA=n}function te(n){return typeof n=="function"}function Yi(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ic=Yi(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Zr(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Ue=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(te(r))try{r()}catch(o){e=o instanceof ic?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{Uw(o)}catch(s){e=e??[],s instanceof ic?e=[...e,...s.errors]:e.push(s)}}if(e)throw new ic(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Uw(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Zr(t,e)}remove(e){let{_finalizers:t}=this;t&&Zr(t,e),e instanceof n&&e._removeParent(this)}};Ue.EMPTY=(()=>{let n=new Ue;return n.closed=!0,n})();var yf=Ue.EMPTY;function oc(n){return n instanceof Ue||n&&"closed"in n&&te(n.remove)&&te(n.add)&&te(n.unsubscribe)}function Uw(n){te(n)?n():n.unsubscribe()}var nn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Zi={setTimeout(n,e,...t){let{delegate:r}=Zi;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Zi;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function sc(n){Zi.setTimeout(()=>{let{onUnhandledError:e}=nn;if(e)e(n);else throw n})}function Zs(){}var $w=vf("C",void 0,void 0);function Hw(n){return vf("E",void 0,n)}function qw(n){return vf("N",n,void 0)}function vf(n,e,t){return{kind:n,value:e,error:t}}var Jr=null;function Ji(n){if(nn.useDeprecatedSynchronousErrorHandling){let e=!Jr;if(e&&(Jr={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Jr;if(Jr=null,t)throw r}}else n()}function zw(n){nn.useDeprecatedSynchronousErrorHandling&&Jr&&(Jr.errorThrown=!0,Jr.error=n)}var Xr=class extends Ue{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,oc(e)&&e.add(this)):this.destination=ZA}static create(e,t,r){return new Un(e,t,r)}next(e){this.isStopped?wf(qw(e),this):this._next(e)}error(e){this.isStopped?wf(Hw(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?wf($w,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},QA=Function.prototype.bind;function _f(n,e){return QA.call(n,e)}var If=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){ac(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){ac(r)}else ac(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){ac(t)}}},Un=class extends Xr{constructor(e,t,r){super();let i;if(te(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&nn.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&_f(e.next,o),error:e.error&&_f(e.error,o),complete:e.complete&&_f(e.complete,o)}):i=e}this.destination=new If(i)}};function ac(n){nn.useDeprecatedSynchronousErrorHandling?zw(n):sc(n)}function YA(n){throw n}function wf(n,e){let{onStoppedNotification:t}=nn;t&&Zi.setTimeout(()=>t(n,e))}var ZA={closed:!0,next:Zs,error:YA,complete:Zs};var Xi=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Et(n){return n}function Ef(...n){return Df(n)}function Df(n){return n.length===0?Et:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var fe=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=XA(t)?t:new Un(t,r,i);return Ji(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=Gw(r),new r((i,o)=>{let s=new Un({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Xi](){return this}pipe(...t){return Df(t)(this)}toPromise(t){return t=Gw(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function Gw(n){var e;return(e=n??nn.Promise)!==null&&e!==void 0?e:Promise}function JA(n){return n&&te(n.next)&&te(n.error)&&te(n.complete)}function XA(n){return n&&n instanceof Xr||JA(n)&&oc(n)}function Cf(n){return te(n?.lift)}function se(n){return e=>{if(Cf(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function le(n,e,t,r,i){return new Tf(n,e,t,r,i)}var Tf=class extends Xr{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function eo(){return se((n,e)=>{let t=null;n._refCount++;let r=le(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var to=class extends fe{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Cf(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ue;let t=this.getSubject();e.add(this.source.subscribe(le(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ue.EMPTY)}return e}refCount(){return eo()(this)}};var Ww=Yi(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var He=(()=>{class n extends fe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new uc(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new Ww}next(t){Ji(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Ji(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Ji(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?yf:(this.currentObservers=null,o.push(t),new Ue(()=>{this.currentObservers=null,Zr(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new fe;return t.source=this,t}}return n.create=(e,t)=>new uc(e,t),n})(),uc=class extends He{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:yf}};var at=class extends He{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Js={now(){return(Js.delegate||Date).now()},delegate:void 0};var cc=class extends He{constructor(e=1/0,t=1/0,r=Js){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(r.push(e),!i&&r.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=r?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<r.length&&r.splice(0,r.length-o),!i){let s=t.now(),a=0;for(let c=1;c<r.length&&r[c]<=s;c+=2)a=c;a&&r.splice(0,a+1)}}};var lc=class extends Ue{constructor(e,t){super()}schedule(e,t=0){return this}};var Xs={setInterval(n,e,...t){let{delegate:r}=Xs;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Xs;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var no=class extends lc{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return Xs.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Xs.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Zr(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var ro=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};ro.now=Js.now;var io=class extends ro{constructor(e,t=ro.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var ea=new io(no);var dc=class extends no{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var hc=class extends io{};var bf=new hc(dc);var Dt=new fe(n=>n.complete());function Kw(n){return n&&te(n.schedule)}function Sf(n){return n[n.length-1]}function Qw(n){return te(Sf(n))?n.pop():void 0}function vn(n){return Kw(Sf(n))?n.pop():void 0}function Yw(n,e){return typeof Sf(n)=="number"?n.pop():e}var fc=n=>n&&typeof n.length=="number"&&typeof n!="function";function pc(n){return te(n?.then)}function gc(n){return te(n[Xi])}function mc(n){return Symbol.asyncIterator&&te(n?.[Symbol.asyncIterator])}function yc(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function ex(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var vc=ex();function _c(n){return te(n?.[vc])}function wc(n){return xw(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield tc(t.read());if(i)return yield tc(void 0);yield yield tc(r)}}finally{t.releaseLock()}})}function Ic(n){return te(n?.getReader)}function Le(n){if(n instanceof fe)return n;if(n!=null){if(gc(n))return tx(n);if(fc(n))return nx(n);if(pc(n))return rx(n);if(mc(n))return Zw(n);if(_c(n))return ix(n);if(Ic(n))return ox(n)}throw yc(n)}function tx(n){return new fe(e=>{let t=n[Xi]();if(te(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function nx(n){return new fe(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function rx(n){return new fe(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,sc)})}function ix(n){return new fe(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function Zw(n){return new fe(e=>{sx(n,e).catch(t=>e.error(t))})}function ox(n){return Zw(wc(n))}function sx(n,e){var t,r,i,o;return Aw(this,void 0,void 0,function*(){try{for(t=Rw(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function Mt(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function $t(n,e=0){return se((t,r)=>{t.subscribe(le(r,i=>Mt(r,n,()=>r.next(i),e),()=>Mt(r,n,()=>r.complete(),e),i=>Mt(r,n,()=>r.error(i),e)))})}function rn(n,e=0){return se((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function Jw(n,e){return Le(n).pipe(rn(e),$t(e))}function Xw(n,e){return Le(n).pipe(rn(e),$t(e))}function eI(n,e){return new fe(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function tI(n,e){return new fe(t=>{let r;return Mt(t,e,()=>{r=n[vc](),Mt(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>te(r?.return)&&r.return()})}function Ec(n,e){if(!n)throw new Error("Iterable cannot be null");return new fe(t=>{Mt(t,e,()=>{let r=n[Symbol.asyncIterator]();Mt(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function nI(n,e){return Ec(wc(n),e)}function rI(n,e){if(n!=null){if(gc(n))return Jw(n,e);if(fc(n))return eI(n,e);if(pc(n))return Xw(n,e);if(mc(n))return Ec(n,e);if(_c(n))return tI(n,e);if(Ic(n))return nI(n,e)}throw yc(n)}function Ce(n,e){return e?rI(n,e):Le(n)}function J(...n){let e=vn(n);return Ce(n,e)}function oo(n,e){let t=te(n)?n:()=>n,r=i=>i.error(t());return new fe(e?i=>e.schedule(r,0,i):r)}function Af(n){return!!n&&(n instanceof fe||te(n.lift)&&te(n.subscribe))}var $n=Yi(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function z(n,e){return se((t,r)=>{let i=0;t.subscribe(le(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:ax}=Array;function ux(n,e){return ax(e)?n(...e):n(e)}function iI(n){return z(e=>ux(n,e))}var{isArray:cx}=Array,{getPrototypeOf:lx,prototype:dx,keys:hx}=Object;function oI(n){if(n.length===1){let e=n[0];if(cx(e))return{args:e,keys:null};if(fx(e)){let t=hx(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function fx(n){return n&&typeof n=="object"&&lx(n)===dx}function sI(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Dc(...n){let e=vn(n),t=Qw(n),{args:r,keys:i}=oI(n);if(r.length===0)return Ce([],e);let o=new fe(px(r,e,i?s=>sI(i,s):Et));return t?o.pipe(iI(t)):o}function px(n,e,t=Et){return r=>{aI(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let c=0;c<i;c++)aI(e,()=>{let l=Ce(n[c],e),h=!1;l.subscribe(le(r,p=>{o[c]=p,h||(h=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function aI(n,e,t){n?Mt(t,n,e):e()}function uI(n,e,t,r,i,o,s,a){let c=[],l=0,h=0,p=!1,m=()=>{p&&!c.length&&!l&&e.complete()},v=M=>l<r?b(M):c.push(M),b=M=>{o&&e.next(M),l++;let N=!1;Le(t(M,h++)).subscribe(le(e,V=>{i?.(V),o?v(V):e.next(V)},()=>{N=!0},void 0,()=>{if(N)try{for(l--;c.length&&l<r;){let V=c.shift();s?Mt(e,s,()=>b(V)):b(V)}m()}catch(V){e.error(V)}}))};return n.subscribe(le(e,v,()=>{p=!0,m()})),()=>{a?.()}}function et(n,e,t=1/0){return te(e)?et((r,i)=>z((o,s)=>e(r,o,i,s))(Le(n(r,i))),t):(typeof e=="number"&&(t=e),se((r,i)=>uI(r,i,n,t)))}function ta(n=1/0){return et(Et,n)}function cI(){return ta(1)}function so(...n){return cI()(Ce(n,vn(n)))}function Cc(n){return new fe(e=>{Le(n()).subscribe(e)})}function xf(...n){let e=vn(n),t=Yw(n,1/0),r=n;return r.length?r.length===1?Le(r[0]):ta(t)(Ce(r,e)):Dt}function gt(n,e){return se((t,r)=>{let i=0;t.subscribe(le(r,o=>n.call(e,o,i++)&&r.next(o)))})}function pr(n){return se((e,t)=>{let r=null,i=!1,o;r=e.subscribe(le(t,void 0,void 0,s=>{o=Le(n(s,pr(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function lI(n,e,t,r,i){return(o,s)=>{let a=t,c=e,l=0;o.subscribe(le(s,h=>{let p=l++;c=a?n(c,h,p):(a=!0,h),r&&s.next(c)},i&&(()=>{a&&s.next(c),s.complete()})))}}function ao(n,e){return te(e)?et(n,e,1):et(n,1)}function gr(n){return se((e,t)=>{let r=!1;e.subscribe(le(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Hn(n){return n<=0?()=>Dt:se((e,t)=>{let r=0;e.subscribe(le(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Rf(n){return z(()=>n)}function Mf(n,e=Et){return n=n??gx,se((t,r)=>{let i,o=!0;t.subscribe(le(r,s=>{let a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function gx(n,e){return n===e}function Tc(n=mx){return se((e,t)=>{let r=!1;e.subscribe(le(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function mx(){return new $n}function na(n){return se((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Ht(n,e){let t=arguments.length>=2;return r=>r.pipe(n?gt((i,o)=>n(i,o,r)):Et,Hn(1),t?gr(e):Tc(()=>new $n))}function uo(n){return n<=0?()=>Dt:se((e,t)=>{let r=[];e.subscribe(le(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Nf(n,e){let t=arguments.length>=2;return r=>r.pipe(n?gt((i,o)=>n(i,o,r)):Et,uo(1),t?gr(e):Tc(()=>new $n))}function ra(){return se((n,e)=>{let t,r=!1;n.subscribe(le(e,i=>{let o=t;t=i,r&&e.next([o,i]),r=!0}))})}function ei(n,e){return se(lI(n,e,arguments.length>=2,!0))}function dI(n={}){let{connector:e=()=>new He,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return o=>{let s,a,c,l=0,h=!1,p=!1,m=()=>{a?.unsubscribe(),a=void 0},v=()=>{m(),s=c=void 0,h=p=!1},b=()=>{let M=s;v(),M?.unsubscribe()};return se((M,N)=>{l++,!p&&!h&&m();let V=c=c??e();N.add(()=>{l--,l===0&&!p&&!h&&(a=Pf(b,i))}),V.subscribe(N),!s&&l>0&&(s=new Un({next:H=>V.next(H),error:H=>{p=!0,m(),a=Pf(v,t,H),V.error(H)},complete:()=>{h=!0,m(),a=Pf(v,r),V.complete()}}),Le(M).subscribe(s))})(o)}}function Pf(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new Un({next:()=>{r.unsubscribe(),n()}});return Le(e(...t)).subscribe(r)}function bc(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,dI({connector:()=>new cc(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function ti(...n){let e=vn(n);return se((t,r)=>{(e?so(n,t,e):so(n,t)).subscribe(r)})}function qe(n,e){return se((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(le(r,c=>{i?.unsubscribe();let l=0,h=o++;Le(n(c,h)).subscribe(i=le(r,p=>r.next(e?e(c,p,h,l++):p),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function Sc(n,e){return te(e)?qe(()=>n,e):qe(()=>n)}function kf(n){return se((e,t)=>{Le(n).subscribe(le(t,()=>t.complete(),Zs)),!t.closed&&e.subscribe(t)})}function tt(n,e,t){let r=te(n)||e||t?{next:n,error:e,complete:t}:n;return r?se((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(le(o,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),o.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),o.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),o.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Et}var KI="https://g.co/ng/security#xss",X=class extends Error{constructor(e,t){super(Sp(e,t)),this.code=e}};function Sp(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function ma(n){return{toString:n}.toString()}var Ac="__parameters__";function yx(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function QI(n,e,t){return ma(()=>{let r=yx(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(c,l,h){let p=c.hasOwnProperty(Ac)?c[Ac]:Object.defineProperty(c,Ac,{value:[]})[Ac];for(;p.length<=h;)p.push(null);return(p[h]=p[h]||[]).push(s),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}function xe(n){for(let e in n)if(n[e]===xe)return e;throw Error("Could not find renamed property on target object.")}function Ot(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Ot).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function hI(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var vx=xe({__forward_ref__:xe});function YI(n){return n.__forward_ref__=YI,n.toString=function(){return Ot(this())},n}function zt(n){return ZI(n)?n():n}function ZI(n){return typeof n=="function"&&n.hasOwnProperty(vx)&&n.__forward_ref__===YI}function G(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Gn(n){return{providers:n.providers||[],imports:n.imports||[]}}function rl(n){return fI(n,XI)||fI(n,eE)}function JI(n){return rl(n)!==null}function fI(n,e){return n.hasOwnProperty(e)?n[e]:null}function _x(n){let e=n&&(n[XI]||n[eE]);return e||null}function pI(n){return n&&(n.hasOwnProperty(gI)||n.hasOwnProperty(wx))?n[gI]:null}var XI=xe({\u0275prov:xe}),gI=xe({\u0275inj:xe}),eE=xe({ngInjectableDef:xe}),wx=xe({ngInjectorDef:xe}),Q=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=G({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function tE(n){return n&&!!n.\u0275providers}var Ix=xe({\u0275cmp:xe}),Ex=xe({\u0275dir:xe}),Dx=xe({\u0275pipe:xe}),Cx=xe({\u0275mod:xe}),Oc=xe({\u0275fac:xe}),sa=xe({__NG_ELEMENT_ID__:xe}),mI=xe({__NG_ENV_ID__:xe});function aa(n){return typeof n=="string"?n:n==null?"":String(n)}function Tx(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():aa(n)}function bx(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new X(-200,n)}function Ap(n,e){throw new X(-201,!1)}var ae=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ae||{}),Hf;function nE(){return Hf}function qt(n){let e=Hf;return Hf=n,e}function rE(n,e,t){let r=rl(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&ae.Optional)return null;if(e!==void 0)return e;Ap(n,"Injector")}var Sx={},ua=Sx,qf="__NG_DI_FLAG__",Fc="ngTempTokenPath",Ax="ngTokenPath",xx=/\n/gm,Rx="\u0275",yI="__source",fo;function Mx(){return fo}function mr(n){let e=fo;return fo=n,e}function Nx(n,e=ae.Default){if(fo===void 0)throw new X(-203,!1);return fo===null?rE(n,void 0,e):fo.get(n,e&ae.Optional?null:void 0,e)}function F(n,e=ae.Default){return(nE()||Nx)(zt(n),e)}function $(n,e=ae.Default){return F(n,il(e))}function il(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function zf(n){let e=[];for(let t=0;t<n.length;t++){let r=zt(n[t]);if(Array.isArray(r)){if(r.length===0)throw new X(900,!1);let i,o=ae.Default;for(let s=0;s<r.length;s++){let a=r[s],c=Px(a);typeof c=="number"?c===-1?i=a.token:o|=c:i=a}e.push(F(i,o))}else e.push(F(r))}return e}function iE(n,e){return n[qf]=e,n.prototype[qf]=e,n}function Px(n){return n[qf]}function kx(n,e,t,r){let i=n[Fc];throw e[yI]&&i.unshift(e[yI]),n.message=Ox(`
`+n.message,i,t,r),n[Ax]=i,n[Fc]=null,n}function Ox(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==Rx?n.slice(2):n;let i=Ot(e);if(Array.isArray(e))i=e.map(Ot).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):Ot(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(xx,`
  `)}`}var ya=iE(QI("Optional"),8);var oE=iE(QI("SkipSelf"),4);function go(n,e){let t=n.hasOwnProperty(Oc);return t?n[Oc]:null}function xp(n,e){n.forEach(t=>Array.isArray(t)?xp(t,e):e(t))}function sE(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Lc(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var ca={},_n=[],mo=new Q(""),aE=new Q("",-1),uE=new Q(""),Vc=class{get(e,t=ua){if(t===ua){let r=new Error(`NullInjectorError: No provider for ${Ot(e)}!`);throw r.name="NullInjectorError",r}return t}},cE=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(cE||{}),In=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(In||{}),_r=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(_r||{});function Fx(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}function Gf(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];Vx(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function Lx(n){return n===3||n===4||n===6}function Vx(n){return n.charCodeAt(0)===64}function Rp(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?vI(n,t,i,null,e[++r]):vI(n,t,i,null,null))}}return n}function vI(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[o+1]=i);return}else if(r===n[o+1]){n[o+2]=i;return}}o++,r!==null&&o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r),i!==null&&n.splice(o++,0,i)}var lE="ng-template";function jx(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&Fx(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Mp(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function Mp(n){return n.type===4&&n.value!==lE}function Bx(n,e,t){let r=n.type===4&&!t?lE:n.value;return e===r}function Ux(n,e,t){let r=4,i=n.attrs,o=i!==null?qx(i):0,s=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!s&&!on(r)&&!on(c))return!1;if(s&&on(c))continue;s=!1,r=c|r&1;continue}if(!s)if(r&4){if(r=2|r&1,c!==""&&!Bx(n,c,t)||c===""&&e.length===1){if(on(r))return!1;s=!0}}else if(r&8){if(i===null||!jx(n,i,c,t)){if(on(r))return!1;s=!0}}else{let l=e[++a],h=$x(c,i,Mp(n),t);if(h===-1){if(on(r))return!1;s=!0;continue}if(l!==""){let p;if(h>o?p="":p=i[h+1].toLowerCase(),r&2&&l!==p){if(on(r))return!1;s=!0}}}}return on(r)||s}function on(n){return(n&1)===0}function $x(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return zx(e,n)}function Hx(n,e,t=!1){for(let r=0;r<e.length;r++)if(Ux(n,e[r],t))return!0;return!1}function qx(n){for(let e=0;e<n.length;e++){let t=n[e];if(Lx(t))return e}return n.length}function zx(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function _I(n,e){return n?":not("+e.trim()+")":e}function Gx(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!on(s)&&(e+=_I(o,i),i=""),r=s,o=o||!on(r);t++}return i!==""&&(e+=_I(o,i)),e}function Wx(n){return n.map(Gx).join(",")}function Kx(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!on(i))break;i=o}r++}return{attrs:e,classes:t}}function mt(n){return ma(()=>{let e=gE(n),t=Pe(U({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===cE.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||In.Emulated,styles:n.styles||_n,_:null,schemas:n.schemas||null,tView:null,id:""});mE(t);let r=n.dependencies;return t.directiveDefs=II(r,!1),t.pipeDefs=II(r,!0),t.id=Zx(t),t})}function Qx(n){return ii(n)||dE(n)}function Yx(n){return n!==null}function Wn(n){return ma(()=>({type:n.type,bootstrap:n.bootstrap||_n,declarations:n.declarations||_n,imports:n.imports||_n,exports:n.exports||_n,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function wI(n,e){if(n==null)return ca;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a=_r.None;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o):(o=i,s=i),e?(t[o]=a!==_r.None?[r,a]:r,e[o]=s):t[o]=r}return t}function ol(n){return ma(()=>{let e=gE(n);return mE(e),e})}function ii(n){return n[Ix]||null}function dE(n){return n[Ex]||null}function hE(n){return n[Dx]||null}function fE(n){let e=ii(n)||dE(n)||hE(n);return e!==null?e.standalone:!1}function pE(n,e){let t=n[Cx]||null;if(!t&&e===!0)throw new Error(`Type ${Ot(n)} does not have '\u0275mod' property.`);return t}function gE(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||ca,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||_n,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:wI(n.inputs,e),outputs:wI(n.outputs),debugInfo:null}}function mE(n){n.features?.forEach(e=>e(n))}function II(n,e){if(!n)return null;let t=e?hE:Qx;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(Yx)}function Zx(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function Np(n){return{\u0275providers:n}}function Pp(...n){return{\u0275providers:yE(!0,n),\u0275fromNgModule:!0}}function yE(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return xp(e,s=>{let a=s;Wf(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&vE(i,o),t}function vE(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];kp(i,o=>{e(o,r)})}}function Wf(n,e,t,r){if(n=zt(n),!n)return!1;let i=null,o=pI(n),s=!o&&ii(n);if(!o&&!s){let c=n.ngModule;if(o=pI(c),o)i=c;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let l of c)Wf(l,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let l;try{xp(o.imports,h=>{Wf(h,e,t,r)&&(l||=[],l.push(h))})}finally{}l!==void 0&&vE(l,e)}if(!a){let l=go(i)||(()=>new i);e({provide:i,useFactory:l,deps:_n},i),e({provide:uE,useValue:i,multi:!0},i),e({provide:mo,useValue:()=>F(i),multi:!0},i)}let c=o.providers;if(c!=null&&!a){let l=n;kp(c,h=>{e(h,l)})}}else return!1;return i!==n&&n.providers!==void 0}function kp(n,e){for(let t of n)tE(t)&&(t=t.\u0275providers),Array.isArray(t)?kp(t,e):e(t)}var Jx=xe({provide:String,useValue:xe});function _E(n){return n!==null&&typeof n=="object"&&Jx in n}function Xx(n){return!!(n&&n.useExisting)}function eR(n){return!!(n&&n.useFactory)}function Kf(n){return typeof n=="function"}var sl=new Q(""),Rc={},tR={},Of;function Op(){return Of===void 0&&(Of=new Vc),Of}var Kt=class{},la=class extends Kt{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Yf(e,s=>this.processProvider(s)),this.records.set(aE,co(void 0,this)),i.has("environment")&&this.records.set(Kt,co(void 0,this));let o=this.records.get(sl);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(uE,_n,ae.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=De(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),De(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=mr(this),r=qt(void 0),i;try{return e()}finally{mr(t),qt(r)}}get(e,t=ua,r=ae.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(mI))return e[mI](this);r=il(r);let i,o=mr(this),s=qt(void 0);try{if(!(r&ae.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=aR(e)&&rl(e);l&&this.injectableDefInScope(l)?c=co(Qf(e),Rc):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ae.Self?Op():this.parent;return t=r&ae.Optional&&t===ua?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Fc]=a[Fc]||[]).unshift(Ot(e)),o)throw a;return kx(a,e,"R3InjectorError",this.source)}else throw a}finally{qt(s),mr(o)}}resolveInjectorInitializers(){let e=De(null),t=mr(this),r=qt(void 0),i;try{let o=this.get(mo,_n,ae.Self);for(let s of o)s()}finally{mr(t),qt(r),De(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Ot(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new X(205,!1)}processProvider(e){e=zt(e);let t=Kf(e)?e:zt(e&&e.provide),r=rR(e);if(!Kf(e)&&e.multi===!0){let i=this.records.get(t);i||(i=co(void 0,Rc,!0),i.factory=()=>zf(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=De(null);try{return t.value===Rc&&(t.value=tR,t.value=t.factory()),typeof t.value=="object"&&t.value&&sR(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{De(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=zt(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Qf(n){let e=rl(n),t=e!==null?e.factory:go(n);if(t!==null)return t;if(n instanceof Q)throw new X(204,!1);if(n instanceof Function)return nR(n);throw new X(204,!1)}function nR(n){if(n.length>0)throw new X(204,!1);let t=_x(n);return t!==null?()=>t.factory(n):()=>new n}function rR(n){if(_E(n))return co(void 0,n.useValue);{let e=iR(n);return co(e,Rc)}}function iR(n,e,t){let r;if(Kf(n)){let i=zt(n);return go(i)||Qf(i)}else if(_E(n))r=()=>zt(n.useValue);else if(eR(n))r=()=>n.useFactory(...zf(n.deps||[]));else if(Xx(n))r=()=>F(zt(n.useExisting));else{let i=zt(n&&(n.useClass||n.provide));if(oR(n))r=()=>new i(...zf(n.deps));else return go(i)||Qf(i)}return r}function co(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function oR(n){return!!n.deps}function sR(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function aR(n){return typeof n=="function"||typeof n=="object"&&n instanceof Q}function Yf(n,e){for(let t of n)Array.isArray(t)?Yf(t,e):t&&tE(t)?Yf(t.\u0275providers,e):e(t)}function Kn(n,e){n instanceof la&&n.assertNotDestroyed();let t,r=mr(n),i=qt(void 0);try{return e()}finally{mr(r),qt(i)}}function uR(){return nE()!==void 0||Mx()!=null}function cR(n){return typeof n=="function"}var Qn=0,pe=1,ne=2,Tt=3,sn=4,an=5,jc=6,EI=7,wr=8,yo=9,En=10,Ft=11,da=12,DI=13,va=14,Dn=15,vo=16,lo=17,_o=18,al=19,wE=20,vr=21,Ff=22,Gt=23,Ir=25,IE=1;var oi=7,Bc=8,Uc=9,Wt=10,$c=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}($c||{});function ni(n){return Array.isArray(n)&&typeof n[IE]=="object"}function Yn(n){return Array.isArray(n)&&n[IE]===!0}function EE(n){return(n.flags&4)!==0}function ul(n){return n.componentOffset>-1}function DE(n){return(n.flags&1)===1}function _a(n){return!!n.template}function Zf(n){return(n[ne]&512)!==0}var Jf=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function CE(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function cl(){return TE}function TE(n){return n.type.prototype.ngOnChanges&&(n.setInput=dR),lR}cl.ngInherit=!0;function lR(){let n=SE(this),e=n?.current;if(e){let t=n.previous;if(t===ca)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function dR(n,e,t,r,i){let o=this.declaredInputs[r],s=SE(n)||hR(n,{previous:ca,current:null}),a=s.current||(s.current={}),c=s.previous,l=c[o];a[o]=new Jf(l&&l.currentValue,t,c===ca),CE(n,e,i,t)}var bE="__ngSimpleChanges__";function SE(n){return n[bE]||null}function hR(n,e){return n[bE]=e}var CI=null;var yr=function(n,e,t){CI?.(n,e,t)},fR="svg",pR="math";function qn(n){for(;Array.isArray(n);)n=n[Qn];return n}function gR(n,e){return qn(e[n])}function Cn(n,e){return qn(e[n.index])}function AE(n,e){return n.data[e]}function Do(n,e){let t=e[n];return ni(t)?t:t[Qn]}function Fp(n){return(n[ne]&128)===128}function mR(n){return Yn(n[Tt])}function Hc(n,e){return e==null?null:n[e]}function xE(n){n[lo]=0}function RE(n){n[ne]&1024||(n[ne]|=1024,Fp(n)&&dl(n))}function ll(n){return!!(n[ne]&9216||n[Gt]?.dirty)}function Xf(n){n[En].changeDetectionScheduler?.notify(8),n[ne]&64&&(n[ne]|=1024),ll(n)&&dl(n)}function dl(n){n[En].changeDetectionScheduler?.notify(0);let e=si(n);for(;e!==null&&!(e[ne]&8192||(e[ne]|=8192,!Fp(e)));)e=si(e)}function ME(n,e){if((n[ne]&256)===256)throw new X(911,!1);n[vr]===null&&(n[vr]=[]),n[vr].push(e)}function yR(n,e){if(n[vr]===null)return;let t=n[vr].indexOf(e);t!==-1&&n[vr].splice(t,1)}function si(n){let e=n[Tt];return Yn(e)?e[Tt]:e}var Ie={lFrame:UE(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var NE=!1;function vR(){return Ie.lFrame.elementDepthCount}function _R(){Ie.lFrame.elementDepthCount++}function wR(){Ie.lFrame.elementDepthCount--}function PE(){return Ie.bindingsEnabled}function IR(){return Ie.skipHydrationRootTNode!==null}function ER(n){return Ie.skipHydrationRootTNode===n}function DR(){Ie.skipHydrationRootTNode=null}function it(){return Ie.lFrame.lView}function Co(){return Ie.lFrame.tView}function Tn(){let n=kE();for(;n!==null&&n.type===64;)n=n.parent;return n}function kE(){return Ie.lFrame.currentTNode}function CR(){let n=Ie.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function wa(n,e){let t=Ie.lFrame;t.currentTNode=n,t.isParent=e}function OE(){return Ie.lFrame.isParent}function TR(){Ie.lFrame.isParent=!1}function FE(){return NE}function TI(n){NE=n}function bR(){return Ie.lFrame.bindingIndex}function SR(n){return Ie.lFrame.bindingIndex=n}function LE(){return Ie.lFrame.bindingIndex++}function AR(n){let e=Ie.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function xR(){return Ie.lFrame.inI18n}function RR(n,e){let t=Ie.lFrame;t.bindingIndex=t.bindingRootIndex=n,ep(e)}function MR(){return Ie.lFrame.currentDirectiveIndex}function ep(n){Ie.lFrame.currentDirectiveIndex=n}function VE(n){Ie.lFrame.currentQueryIndex=n}function NR(n){let e=n[pe];return e.type===2?e.declTNode:e.type===1?n[an]:null}function jE(n,e,t){if(t&ae.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&ae.Host);)if(i=NR(o),i===null||(o=o[va],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=Ie.lFrame=BE();return r.currentTNode=e,r.lView=n,!0}function Lp(n){let e=BE(),t=n[pe];Ie.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function BE(){let n=Ie.lFrame,e=n===null?null:n.child;return e===null?UE(n):e}function UE(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function $E(){let n=Ie.lFrame;return Ie.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var HE=$E;function Vp(){let n=$E();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function hl(){return Ie.lFrame.selectedIndex}function ai(n){Ie.lFrame.selectedIndex=n}function PR(){let n=Ie.lFrame;return AE(n.tView,n.selectedIndex)}function kR(){return Ie.lFrame.currentNamespace}var qE=!0;function jp(){return qE}function Bp(n){qE=n}function OR(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=TE(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function Up(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:h}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),h!=null&&(n.destroyHooks??=[]).push(t,h)}}function Mc(n,e,t){zE(n,e,3,t)}function Nc(n,e,t,r){(n[ne]&3)===t&&zE(n,e,t,r)}function Lf(n,e){let t=n[ne];(t&3)===e&&(t&=16383,t+=1,n[ne]=t)}function zE(n,e,t,r){let i=r!==void 0?n[lo]&65535:0,o=r??-1,s=e.length-1,a=0;for(let c=i;c<s;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[lo]+=65536),(a<o||o==-1)&&(FR(n,t,e,c),n[lo]=(n[lo]&4294901760)+c+2),c++}function bI(n,e){yr(4,n,e);let t=De(null);try{e.call(n)}finally{De(t),yr(5,n,e)}}function FR(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[ne]>>14<n[lo]>>16&&(n[ne]&3)===e&&(n[ne]+=16384,bI(a,o)):bI(a,o)}var po=-1,ha=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function LR(n){return n instanceof ha}function VR(n){return(n.flags&8)!==0}function jR(n){return(n.flags&16)!==0}var Vf={},tp=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=il(r);let i=this.injector.get(e,Vf,r);return i!==Vf||t===Vf?i:this.parentInjector.get(e,t,r)}};function GE(n){return n!==po}function qc(n){return n&32767}function BR(n){return n>>16}function zc(n,e){let t=BR(n),r=e;for(;t>0;)r=r[va],t--;return r}var np=!0;function SI(n){let e=np;return np=n,e}var UR=256,WE=UR-1,KE=5,$R=0,wn={};function HR(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(sa)&&(r=t[sa]),r==null&&(r=t[sa]=$R++);let i=r&WE,o=1<<i;e.data[n+(i>>KE)]|=o}function QE(n,e){let t=YE(n,e);if(t!==-1)return t;let r=e[pe];r.firstCreatePass&&(n.injectorIndex=e.length,jf(r.data,n),jf(e,null),jf(r.blueprint,null));let i=$p(n,e),o=n.injectorIndex;if(GE(i)){let s=qc(i),a=zc(i,e),c=a[pe].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|c[s+l]}return e[o+8]=i,o}function jf(n,e){n.push(0,0,0,0,0,0,0,0,e)}function YE(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function $p(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=tD(i),r===null)return po;if(t++,i=i[va],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return po}function qR(n,e,t){HR(n,e,t)}function ZE(n,e,t){if(t&ae.Optional||n!==void 0)return n;Ap(e,"NodeInjector")}function JE(n,e,t,r){if(t&ae.Optional&&r===void 0&&(r=null),!(t&(ae.Self|ae.Host))){let i=n[yo],o=qt(void 0);try{return i?i.get(e,r,t&ae.Optional):rE(e,r,t&ae.Optional)}finally{qt(o)}}return ZE(r,e,t)}function XE(n,e,t,r=ae.Default,i){if(n!==null){if(e[ne]&2048&&!(r&ae.Self)){let s=QR(n,e,t,r,wn);if(s!==wn)return s}let o=eD(n,e,t,r,wn);if(o!==wn)return o}return JE(e,t,r,i)}function eD(n,e,t,r,i){let o=WR(t);if(typeof o=="function"){if(!jE(e,n,r))return r&ae.Host?ZE(i,t,r):JE(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&ae.Optional))Ap(t);else return s}finally{HE()}}else if(typeof o=="number"){let s=null,a=YE(n,e),c=po,l=r&ae.Host?e[Dn][an]:null;for((a===-1||r&ae.SkipSelf)&&(c=a===-1?$p(n,e):e[a+8],c===po||!xI(r,!1)?a=-1:(s=e[pe],a=qc(c),e=zc(c,e)));a!==-1;){let h=e[pe];if(AI(o,a,h.data)){let p=zR(a,e,t,s,r,l);if(p!==wn)return p}c=e[a+8],c!==po&&xI(r,e[pe].data[a+8]===l)&&AI(o,a,e)?(s=h,a=qc(c),e=zc(c,e)):a=-1}}return i}function zR(n,e,t,r,i,o){let s=e[pe],a=s.data[n+8],c=r==null?ul(a)&&np:r!=s&&(a.type&3)!==0,l=i&ae.Host&&o===a,h=GR(a,s,t,c,l);return h!==null?fa(e,s,h,a):wn}function GR(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,c=n.directiveStart,l=n.directiveEnd,h=o>>20,p=r?a:a+h,m=i?a+h:l;for(let v=p;v<m;v++){let b=s[v];if(v<c&&t===b||v>=c&&b.type===t)return v}if(i){let v=s[c];if(v&&_a(v)&&v.type===t)return c}return null}function fa(n,e,t,r){let i=n[t],o=e.data;if(LR(i)){let s=i;s.resolving&&bx(Tx(o[t]));let a=SI(s.canSeeViewProviders);s.resolving=!0;let c,l=s.injectImpl?qt(s.injectImpl):null,h=jE(n,r,ae.Default);try{i=n[t]=s.factory(void 0,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&OR(t,o[t],e)}finally{l!==null&&qt(l),SI(a),s.resolving=!1,HE()}}return i}function WR(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(sa)?n[sa]:void 0;return typeof e=="number"?e>=0?e&WE:KR:e}function AI(n,e,t){let r=1<<n;return!!(t[e+(n>>KE)]&r)}function xI(n,e){return!(n&ae.Self)&&!(n&ae.Host&&e)}var ri=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return XE(this._tNode,this._lView,e,il(r),t)}};function KR(){return new ri(Tn(),it())}function Hp(n){return ma(()=>{let e=n.prototype.constructor,t=e[Oc]||rp(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[Oc]||rp(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function rp(n){return ZI(n)?()=>{let e=rp(zt(n));return e&&e()}:go(n)}function QR(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[ne]&2048&&!(s[ne]&512);){let a=eD(o,s,t,r|ae.Self,wn);if(a!==wn)return a;let c=o.parent;if(!c){let l=s[wE];if(l){let h=l.get(t,wn,r);if(h!==wn)return h}c=tD(s),s=s[va]}o=c}return i}function tD(n){let e=n[pe],t=e.type;return t===2?e.declTNode:t===1?n[an]:null}function RI(n,e=null,t=null,r){let i=nD(n,e,t,r);return i.resolveInjectorInitializers(),i}function nD(n,e=null,t=null,r,i=new Set){let o=[t||_n,Pp(n)];return r=r||(typeof n=="object"?void 0:Ot(n)),new la(o,e||Op(),r||null,i)}var ui=class n{static{this.THROW_IF_NOT_FOUND=ua}static{this.NULL=new Vc}static create(e,t){if(Array.isArray(e))return RI({name:""},t,e,"");{let r=e.name??"";return RI({name:r},e.parent,e.providers,r)}}static{this.\u0275prov=G({token:n,providedIn:"any",factory:()=>F(aE)})}static{this.__NG_ELEMENT_ID__=-1}};var YR=new Q("");YR.__NG_ELEMENT_ID__=n=>{let e=Tn();if(e===null)throw new X(204,!1);if(e.type&2)return e.value;if(n&ae.Optional)return null;throw new X(204,!1)};var ZR="ngOriginalError";function Bf(n){return n[ZR]}var rD=!0,iD=(()=>{class n{static{this.__NG_ELEMENT_ID__=JR}static{this.__NG_ENV_ID__=t=>t}}return n})(),ip=class extends iD{constructor(e){super(),this._lView=e}onDestroy(e){return ME(this._lView,e),()=>yR(this._lView,e)}};function JR(){return new ip(it())}var To=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new at(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=G({token:n,providedIn:"root",factory:()=>new n})}}return n})();var op=class extends He{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,uR()&&(this.destroyRef=$(iD,{optional:!0})??void 0,this.pendingTasks=$(To,{optional:!0})??void 0)}emit(e){let t=De(null);try{super.next(e)}finally{De(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof Ue&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},Ct=op;function Gc(...n){}function oD(n){let e,t;function r(){n=Gc;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function MI(n){return queueMicrotask(()=>n()),()=>{n=Gc}}var qp="isAngularZone",Wc=qp+"_ID",XR=0,Ae=class n{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ct(!1),this.onMicrotaskEmpty=new Ct(!1),this.onStable=new Ct(!1),this.onError=new Ct(!1);let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=rD}=e;if(typeof Zone>"u")throw new X(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,nM(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(qp)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new X(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new X(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,eM,Gc,Gc);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},eM={};function zp(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function tM(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){oD(()=>{n.callbackScheduled=!1,sp(n),n.isCheckStableRunning=!0,zp(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),sp(n)}function nM(n){let e=()=>{tM(n)},t=XR++;n._inner=n._inner.fork({name:"angular",properties:{[qp]:!0,[Wc]:t,[Wc+t]:!0},onInvokeTask:(r,i,o,s,a,c)=>{if(rM(c))return r.invokeTask(o,s,a,c);try{return NI(n),r.invokeTask(o,s,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),PI(n)}},onInvoke:(r,i,o,s,a,c,l)=>{try{return NI(n),r.invoke(o,s,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!iM(c)&&e(),PI(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,sp(n),zp(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function sp(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function NI(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function PI(n){n._nesting--,zp(n)}var ap=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ct,this.onMicrotaskEmpty=new Ct,this.onStable=new Ct,this.onError=new Ct}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function rM(n){return sD(n,"__ignore_ng_zone__")}function iM(n){return sD(n,"__scheduler_tick__")}function sD(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var zn=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Bf(e);for(;t&&Bf(t);)t=Bf(t);return t||null}},oM=new Q("",{providedIn:"root",factory:()=>{let n=$(Ae),e=$(zn);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function sM(){return fl(Tn(),it())}function fl(n,e){return new pl(Cn(n,e))}var pl=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=sM}}return n})();function aD(n){return(n.flags&128)===128}var uD=new Map,aM=0;function uM(){return aM++}function cM(n){uD.set(n[al],n)}function up(n){uD.delete(n[al])}var kI="__ngContext__";function ci(n,e){ni(e)?(n[kI]=e[al],cM(e)):n[kI]=e}function cD(n){return dD(n[da])}function lD(n){return dD(n[sn])}function dD(n){for(;n!==null&&!Yn(n);)n=n[sn];return n}var cp;function hD(n){cp=n}function lM(){if(cp!==void 0)return cp;if(typeof document<"u")return document;throw new X(210,!1)}var Gp=new Q("",{providedIn:"root",factory:()=>dM}),dM="ng",Wp=new Q(""),Qt=new Q("",{providedIn:"platform",factory:()=>"unknown"});var Kp=new Q("",{providedIn:"root",factory:()=>lM().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var hM="h",fM="b";var pM=()=>null;function Qp(n,e,t=!1){return pM(n,e,t)}var fD=!1,gM=new Q("",{providedIn:"root",factory:()=>fD});var Kc=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${KI})`}};function Yp(n){return n instanceof Kc?n.changingThisBreaksApplicationSecurity:n}function pD(n,e){let t=mM(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${KI})`)}return t===e}function mM(n){return n instanceof Kc&&n.getTypeName()||null}var yM=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function gD(n){return n=String(n),n.match(yM)?n:"unsafe:"+n}var Zp=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Zp||{});function gl(n){let e=vM();return e?e.sanitize(Zp.URL,n)||"":pD(n,"URL")?Yp(n):gD(aa(n))}function vM(){let n=it();return n&&n[En].sanitizer}function mD(n){return n instanceof Function?n():n}var di=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(di||{}),_M;function Jp(n,e){return _M(n,e)}function ho(n,e,t,r,i){if(r!=null){let o,s=!1;Yn(r)?o=r:ni(r)&&(s=!0,r=r[Qn]);let a=qn(r);n===0&&t!==null?i==null?ID(e,t,a):Qc(e,t,a,i||null,!0):n===1&&t!==null?Qc(e,t,a,i||null,!0):n===2?kM(e,a,s):n===3&&e.destroyNode(a),o!=null&&FM(e,n,o,t,i)}}function wM(n,e){return n.createText(e)}function IM(n,e,t){n.setValue(e,t)}function yD(n,e,t){return n.createElement(e,t)}function EM(n,e){vD(n,e),e[Qn]=null,e[an]=null}function DM(n,e,t,r,i,o){r[Qn]=i,r[an]=e,ml(n,r,t,1,i,o)}function vD(n,e){e[En].changeDetectionScheduler?.notify(9),ml(n,e,e[Ft],2,null,null)}function CM(n){let e=n[da];if(!e)return Uf(n[pe],n);for(;e;){let t=null;if(ni(e))t=e[da];else{let r=e[Wt];r&&(t=r)}if(!t){for(;e&&!e[sn]&&e!==n;)ni(e)&&Uf(e[pe],e),e=e[Tt];e===null&&(e=n),ni(e)&&Uf(e[pe],e),t=e&&e[sn]}e=t}}function TM(n,e,t,r){let i=Wt+r,o=t.length;r>0&&(t[i-1][sn]=e),r<o-Wt?(e[sn]=t[i],sE(t,Wt+r,e)):(t.push(e),e[sn]=null),e[Tt]=t;let s=e[vo];s!==null&&t!==s&&_D(s,e);let a=e[_o];a!==null&&a.insertView(n),Xf(e),e[ne]|=128}function _D(n,e){let t=n[Uc],r=e[Tt];if(ni(r))n[ne]|=$c.HasTransplantedViews;else{let i=r[Tt][Dn];e[Dn]!==i&&(n[ne]|=$c.HasTransplantedViews)}t===null?n[Uc]=[e]:t.push(e)}function Xp(n,e){let t=n[Uc],r=t.indexOf(e);t.splice(r,1)}function lp(n,e){if(n.length<=Wt)return;let t=Wt+e,r=n[t];if(r){let i=r[vo];i!==null&&i!==n&&Xp(i,r),e>0&&(n[t-1][sn]=r[sn]);let o=Lc(n,Wt+e);EM(r[pe],r);let s=o[_o];s!==null&&s.detachView(o[pe]),r[Tt]=null,r[sn]=null,r[ne]&=-129}return r}function wD(n,e){if(!(e[ne]&256)){let t=e[Ft];t.destroyNode&&ml(n,e,t,3,null,null),CM(e)}}function Uf(n,e){if(e[ne]&256)return;let t=De(null);try{e[ne]&=-129,e[ne]|=256,e[Gt]&&ff(e[Gt]),SM(n,e),bM(n,e),e[pe].type===1&&e[Ft].destroy();let r=e[vo];if(r!==null&&Yn(e[Tt])){r!==e[Tt]&&Xp(r,e);let i=e[_o];i!==null&&i.detachView(n)}up(e)}finally{De(t)}}function bM(n,e){let t=n.cleanup,r=e[EI];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let s=t[o+3];s>=0?r[s]():r[-s].unsubscribe(),o+=2}else{let s=r[t[o+1]];t[o].call(s)}r!==null&&(e[EI]=null);let i=e[vr];if(i!==null){e[vr]=null;for(let o=0;o<i.length;o++){let s=i[o];s()}}}function SM(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof ha)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],c=o[s+1];yr(4,a,c);try{c.call(a)}finally{yr(5,a,c)}}else{yr(4,i,o);try{o.call(i)}finally{yr(5,i,o)}}}}}function AM(n,e,t){return xM(n,e.parent,t)}function xM(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[Qn];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:o}=n.data[r.directiveStart+i];if(o===In.None||o===In.Emulated)return null}return Cn(r,t)}}function Qc(n,e,t,r,i){n.insertBefore(e,t,r,i)}function ID(n,e,t){n.appendChild(e,t)}function OI(n,e,t,r,i){r!==null?Qc(n,e,t,r,i):ID(n,e,t)}function ED(n,e){return n.parentNode(e)}function RM(n,e){return n.nextSibling(e)}function MM(n,e,t){return PM(n,e,t)}function NM(n,e,t){return n.type&40?Cn(n,t):null}var PM=NM,FI;function eg(n,e,t,r){let i=AM(n,r,e),o=e[Ft],s=r.parent||e[an],a=MM(s,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)OI(o,i,t[c],a,!1);else OI(o,i,t,a,!1);FI!==void 0&&FI(o,r,e,t,i)}function ia(n,e){if(e!==null){let t=e.type;if(t&3)return Cn(e,n);if(t&4)return dp(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return ia(n,r);{let i=n[e.index];return Yn(i)?dp(-1,i):qn(i)}}else{if(t&128)return ia(n,e.next);if(t&32)return Jp(e,n)()||qn(n[e.index]);{let r=DD(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=si(n[Dn]);return ia(i,r)}else return ia(n,e.next)}}}return null}function DD(n,e){if(e!==null){let r=n[Dn][an],i=e.projection;return r.projection[i]}return null}function dp(n,e){let t=Wt+n+1;if(t<e.length){let r=e[t],i=r[pe].firstChild;if(i!==null)return ia(r,i)}return e[oi]}function kM(n,e,t){n.removeChild(null,e,t)}function tg(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],c=t.type;if(s&&e===0&&(a&&ci(qn(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)tg(n,e,t.child,r,i,o,!1),ho(e,n,i,a,o);else if(c&32){let l=Jp(t,r),h;for(;h=l();)ho(e,n,i,h,o);ho(e,n,i,a,o)}else c&16?OM(n,e,r,t,i,o):ho(e,n,i,a,o);t=s?t.projectionNext:t.next}}function ml(n,e,t,r,i,o){tg(t,r,n.firstChild,e,i,o,!1)}function OM(n,e,t,r,i,o){let s=t[Dn],c=s[an].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let h=c[l];ho(e,n,i,h,o)}else{let l=c,h=s[Tt];aD(r)&&(l.flags|=128),tg(n,e,l,h,i,o,!0)}}function FM(n,e,t,r,i){let o=t[oi],s=qn(t);o!==s&&ho(e,n,r,o,i);for(let a=Wt;a<t.length;a++){let c=t[a];ml(c[pe],c,n,e,r,o)}}function LM(n,e,t){n.setAttribute(e,"style",t)}function CD(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function TD(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&Gf(n,e,r),i!==null&&CD(n,e,i),o!==null&&LM(n,e,o)}var bo={};function ge(n=1){bD(Co(),it(),hl()+n,!1)}function bD(n,e,t,r){if(!r)if((e[ne]&3)===3){let o=n.preOrderCheckHooks;o!==null&&Mc(e,o,t)}else{let o=n.preOrderHooks;o!==null&&Nc(e,o,0,t)}ai(t)}function ot(n,e=ae.Default){let t=it();if(t===null)return F(n,e);let r=Tn();return XE(r,t,zt(n),e)}function SD(n,e,t,r,i,o){let s=De(null);try{let a=null;i&_r.SignalBased&&(a=e[r][Lw]),a!==null&&a.transformFn!==void 0&&(o=a.transformFn(o)),i&_r.HasDecoratorInputTransform&&(o=n.inputTransforms[r].call(e,o)),n.setInput!==null?n.setInput(e,a,o,t,r):CE(e,a,r,o)}finally{De(s)}}function VM(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)ai(~i);else{let o=i,s=t[++r],a=t[++r];RR(s,o);let c=e[o];a(2,c)}}}finally{ai(-1)}}function yl(n,e,t,r,i,o,s,a,c,l,h){let p=e.blueprint.slice();return p[Qn]=i,p[ne]=r|4|128|8|64,(l!==null||n&&n[ne]&2048)&&(p[ne]|=2048),xE(p),p[Tt]=p[va]=n,p[wr]=t,p[En]=s||n&&n[En],p[Ft]=a||n&&n[Ft],p[yo]=c||n&&n[yo]||null,p[an]=o,p[al]=uM(),p[jc]=h,p[wE]=l,p[Dn]=e.type==2?n[Dn]:p,p}function vl(n,e,t,r,i){let o=n.data[e];if(o===null)o=jM(n,e,t,r,i),xR()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=CR();o.injectorIndex=s===null?-1:s.injectorIndex}return wa(o,!0),o}function jM(n,e,t,r,i){let o=kE(),s=OE(),a=s?o:o&&o.parent,c=n.data[e]=qM(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),o!==null&&(s?o.child==null&&c.parent!==null&&(o.child=c):o.next===null&&(o.next=c,c.prev=o)),c}function AD(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function xD(n,e,t,r,i){let o=hl(),s=r&2;try{ai(-1),s&&e.length>Ir&&bD(n,e,Ir,!1),yr(s?2:0,i),t(r,i)}finally{ai(o),yr(s?3:1,i)}}function RD(n,e,t){if(EE(e)){let r=De(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let c=t[s];a.contentQueries(1,c,s)}}}finally{De(r)}}}function MD(n,e,t){PE()&&(ZM(n,e,t,Cn(t,e)),(t.flags&64)===64&&FD(n,e,t))}function ND(n,e,t=Cn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function PD(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=ng(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function ng(n,e,t,r,i,o,s,a,c,l,h){let p=Ir+r,m=p+i,v=BM(p,m),b=typeof l=="function"?l():l;return v[pe]={type:n,blueprint:v,template:t,queries:null,viewQuery:a,declTNode:e,data:v.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:b,incompleteFirstPass:!1,ssrId:h}}function BM(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:bo);return t}function UM(n,e,t,r){let o=r.get(gM,fD)||t===In.ShadowDom,s=n.selectRootElement(e,o);return $M(s),s}function $M(n){HM(n)}var HM=()=>null;function qM(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return IR()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function LI(n,e,t,r,i){for(let o in e){if(!e.hasOwnProperty(o))continue;let s=e[o];if(s===void 0)continue;r??={};let a,c=_r.None;Array.isArray(s)?(a=s[0],c=s[1]):a=s;let l=o;if(i!==null){if(!i.hasOwnProperty(o))continue;l=i[o]}n===0?VI(r,t,l,a,c):VI(r,t,l,a)}return r}function VI(n,e,t,r,i){let o;n.hasOwnProperty(t)?(o=n[t]).push(e,r):o=n[t]=[e,r],i!==void 0&&o.push(i)}function zM(n,e,t){let r=e.directiveStart,i=e.directiveEnd,o=n.data,s=e.attrs,a=[],c=null,l=null;for(let h=r;h<i;h++){let p=o[h],m=t?t.get(p):null,v=m?m.inputs:null,b=m?m.outputs:null;c=LI(0,p.inputs,h,c,v),l=LI(1,p.outputs,h,l,b);let M=c!==null&&s!==null&&!Mp(e)?sN(c,h,s):null;a.push(M)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function GM(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function WM(n,e,t,r,i,o,s,a){let c=Cn(e,t),l=e.inputs,h;!a&&l!=null&&(h=l[r])?(rg(n,t,h,r,i),ul(e)&&KM(t,e.index)):e.type&3?(r=GM(r),i=s!=null?s(i,e.value||"",r):i,o.setProperty(c,r,i)):e.type&12}function KM(n,e){let t=Do(e,n);t[ne]&16||(t[ne]|=64)}function kD(n,e,t,r){if(PE()){let i=r===null?null:{"":-1},o=XM(n,t),s,a;o===null?s=a=null:[s,a]=o,s!==null&&OD(n,e,t,s,i,a),i&&eN(t,r,i)}t.mergedAttrs=Rp(t.mergedAttrs,t.attrs)}function OD(n,e,t,r,i,o){for(let l=0;l<r.length;l++)qR(QE(t,e),n,r[l].type);nN(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let h=r[l];h.providersResolver&&h.providersResolver(h)}let s=!1,a=!1,c=AD(n,e,r.length,null);for(let l=0;l<r.length;l++){let h=r[l];t.mergedAttrs=Rp(t.mergedAttrs,h.hostAttrs),rN(n,t,e,c,h),tN(c,h,i),h.contentQueries!==null&&(t.flags|=4),(h.hostBindings!==null||h.hostAttrs!==null||h.hostVars!==0)&&(t.flags|=64);let p=h.type.prototype;!s&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),s=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}zM(n,t,o)}function QM(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;YM(s)!=a&&s.push(a),s.push(t,r,o)}}function YM(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function ZM(n,e,t,r){let i=t.directiveStart,o=t.directiveEnd;ul(t)&&iN(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||QE(t,e),ci(r,e);let s=t.initialInputs;for(let a=i;a<o;a++){let c=n.data[a],l=fa(e,n,a,t);if(ci(l,e),s!==null&&oN(e,a-i,l,c,t,s),_a(c)){let h=Do(t.index,e);h[wr]=fa(e,n,a,t)}}}function FD(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=MR();try{ai(o);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];ep(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&JM(c,l)}}finally{ai(-1),ep(s)}}function JM(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function XM(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let o=0;o<t.length;o++){let s=t[o];if(Hx(e,s.selectors,!1))if(r||(r=[]),_a(s))if(s.findHostDirectiveDefs!==null){let a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),r.unshift(...a,s);let c=a.length;hp(n,e,c)}else r.unshift(s),hp(n,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,r,i),r.push(s)}return r===null?null:[r,i]}function hp(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function eN(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new X(-301,!1);r.push(e[i],o)}}}function tN(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;_a(e)&&(t[""]=n)}}function nN(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function rN(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=go(i.type,!0)),s=new ha(o,_a(i),ot);n.blueprint[r]=s,t[r]=s,QM(n,e,r,AD(n,t,i.hostVars,bo),i)}function iN(n,e,t){let r=Cn(e,n),i=PD(t),o=n[En].rendererFactory,s=16;t.signals?s=4096:t.onPush&&(s=64);let a=_l(n,yl(n,i,null,s,r,e,null,o.createRenderer(r,t),null,null,null));n[e.index]=a}function oN(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;){let c=s[a++],l=s[a++],h=s[a++],p=s[a++];SD(r,t,c,l,h,p)}}function sN(n,e,t){let r=null,i=0;for(;i<t.length;){let o=t[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(n.hasOwnProperty(o)){r===null&&(r=[]);let s=n[o];for(let a=0;a<s.length;a+=3)if(s[a]===e){r.push(o,s[a+1],s[a+2],t[i+1]);break}}i+=2}return r}function LD(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function VD(n,e){let t=n.contentQueries;if(t!==null){let r=De(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];VE(o),a.contentQueries(2,e[s],s)}}}finally{De(r)}}}function _l(n,e){return n[da]?n[DI][sn]=e:n[da]=e,n[DI]=e,e}function fp(n,e,t){VE(0);let r=De(null);try{e(n,t)}finally{De(r)}}function aN(n,e){let t=n[yo],r=t?t.get(zn,null):null;r&&r.handleError(e)}function rg(n,e,t,r,i){for(let o=0;o<t.length;){let s=t[o++],a=t[o++],c=t[o++],l=e[s],h=n.data[s];SD(h,l,r,a,c,i)}}function jD(n,e,t){let r=gR(e,n);IM(n[Ft],r,t)}function uN(n,e){let t=Do(e,n),r=t[pe];cN(r,t);let i=t[Qn];i!==null&&t[jc]===null&&(t[jc]=Qp(i,t[yo])),ig(r,t,t[wr])}function cN(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function ig(n,e,t){Lp(e);try{let r=n.viewQuery;r!==null&&fp(1,r,t);let i=n.template;i!==null&&xD(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[_o]?.finishViewCreation(n),n.staticContentQueries&&VD(n,e),n.staticViewQueries&&fp(2,n.viewQuery,t);let o=n.components;o!==null&&lN(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ne]&=-5,Vp()}}function lN(n,e){for(let t=0;t<e.length;t++)uN(n,e[t])}function dN(n,e,t,r){let i=De(null);try{let o=e.tView,a=n[ne]&4096?4096:16,c=yl(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[vo]=l;let h=n[_o];return h!==null&&(c[_o]=h.createEmbeddedView(o)),ig(o,c,t),c}finally{De(i)}}function jI(n,e){return!e||e.firstChild===null||aD(n)}function hN(n,e,t,r=!0){let i=e[pe];if(TM(i,e,n,t),r){let s=dp(t,n),a=e[Ft],c=ED(a,n[oi]);c!==null&&DM(i,n[an],a,e,c,s)}let o=e[jc];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function Yc(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(qn(o)),Yn(o)&&fN(o,r);let s=t.type;if(s&8)Yc(n,e,t.child,r);else if(s&32){let a=Jp(t,e),c;for(;c=a();)r.push(c)}else if(s&16){let a=DD(e,t);if(Array.isArray(a))r.push(...a);else{let c=si(e[Dn]);Yc(c[pe],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function fN(n,e){for(let t=Wt;t<n.length;t++){let r=n[t],i=r[pe].firstChild;i!==null&&Yc(r[pe],r,i,e)}n[oi]!==n[Qn]&&e.push(n[oi])}var BD=[];function pN(n){return n[Gt]??gN(n)}function gN(n){let e=BD.pop()??Object.create(yN);return e.lView=n,e}function mN(n){n.lView[Gt]!==n&&(n.lView=null,BD.push(n))}var yN=Pe(U({},lf),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{dl(n.lView)},consumerOnSignalRead(){this.lView[Gt]=this}});function vN(n){let e=n[Gt]??Object.create(_N);return e.lView=n,e}var _N=Pe(U({},lf),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{let e=si(n.lView);for(;e&&!UD(e[pe]);)e=si(e);e&&RE(e)},consumerOnSignalRead(){this.lView[Gt]=this}});function UD(n){return n.type!==2}var wN=100;function $D(n,e=!0,t=0){let r=n[En],i=r.rendererFactory,o=!1;o||i.begin?.();try{IN(n,t)}catch(s){throw e&&aN(n,s),s}finally{o||(i.end?.(),r.inlineEffectRunner?.flush())}}function IN(n,e){let t=FE();try{TI(!0),pp(n,e);let r=0;for(;ll(n);){if(r===wN)throw new X(103,!1);r++,pp(n,1)}}finally{TI(t)}}function EN(n,e,t,r){let i=e[ne];if((i&256)===256)return;let o=!1,s=!1;!o&&e[En].inlineEffectRunner?.flush(),Lp(e);let a=!0,c=null,l=null;o||(UD(n)?(l=pN(e),c=df(l)):Vw()===null?(a=!1,l=vN(e),c=df(l)):e[Gt]&&(ff(e[Gt]),e[Gt]=null));try{xE(e),SR(n.bindingStartIndex),t!==null&&xD(n,e,t,2,r);let h=(i&3)===3;if(!o)if(h){let v=n.preOrderCheckHooks;v!==null&&Mc(e,v,null)}else{let v=n.preOrderHooks;v!==null&&Nc(e,v,0,null),Lf(e,0)}if(s||DN(e),HD(e,0),n.contentQueries!==null&&VD(n,e),!o)if(h){let v=n.contentCheckHooks;v!==null&&Mc(e,v)}else{let v=n.contentHooks;v!==null&&Nc(e,v,1),Lf(e,1)}VM(n,e);let p=n.components;p!==null&&zD(e,p,0);let m=n.viewQuery;if(m!==null&&fp(2,m,r),!o)if(h){let v=n.viewCheckHooks;v!==null&&Mc(e,v)}else{let v=n.viewHooks;v!==null&&Nc(e,v,2),Lf(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Ff]){for(let v of e[Ff])v();e[Ff]=null}o||(e[ne]&=-73)}catch(h){throw o||dl(e),h}finally{l!==null&&(jw(l,c),a&&mN(l)),Vp()}}function HD(n,e){for(let t=cD(n);t!==null;t=lD(t))for(let r=Wt;r<t.length;r++){let i=t[r];qD(i,e)}}function DN(n){for(let e=cD(n);e!==null;e=lD(e)){if(!(e[ne]&$c.HasTransplantedViews))continue;let t=e[Uc];for(let r=0;r<t.length;r++){let i=t[r];RE(i)}}}function CN(n,e,t){let r=Do(e,n);qD(r,t)}function qD(n,e){Fp(n)&&pp(n,e)}function pp(n,e){let r=n[pe],i=n[ne],o=n[Gt],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&hf(o)),s||=!1,o&&(o.dirty=!1),n[ne]&=-9217,s)EN(r,n,r.template,n[wr]);else if(i&8192){HD(n,1);let a=r.components;a!==null&&zD(n,a,1)}}function zD(n,e,t){for(let r=0;r<e.length;r++)CN(n,e[r],t)}function GD(n,e){let t=FE()?64:1088;for(n[En].changeDetectionScheduler?.notify(e);n;){n[ne]|=t;let r=si(n);if(Zf(n)&&!r)return n;n=r}return null}var li=class{get rootNodes(){let e=this._lView,t=e[pe];return Yc(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[wr]}set context(e){this._lView[wr]=e}get destroyed(){return(this._lView[ne]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Tt];if(Yn(e)){let t=e[Bc],r=t?t.indexOf(this):-1;r>-1&&(lp(e,r),Lc(t,r))}this._attachedToViewContainer=!1}wD(this._lView[pe],this._lView)}onDestroy(e){ME(this._lView,e)}markForCheck(){GD(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[ne]&=-129}reattach(){Xf(this._lView),this._lView[ne]|=128}detectChanges(){this._lView[ne]|=1024,$D(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new X(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Zf(this._lView),t=this._lView[vo];t!==null&&!e&&Xp(t,this._lView),vD(this._lView[pe],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new X(902,!1);this._appRef=e;let t=Zf(this._lView),r=this._lView[vo];r!==null&&!t&&_D(r,this._lView),Xf(this._lView)}},og=(()=>{class n{static{this.__NG_ELEMENT_ID__=SN}}return n})(),TN=og,bN=class extends TN{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=dN(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new li(i)}};function SN(){return AN(Tn(),it())}function AN(n,e){return n.type&4?new bN(e,n,fl(n,e)):null}var QH=new RegExp(`^(\\d+)*(${fM}|${hM})*(.*)`);var xN=()=>null;function BI(n,e){return xN(n,e)}var wo=class{},sg=new Q("",{providedIn:"root",factory:()=>!1});var WD=new Q(""),KD=new Q(""),gp=class{},Zc=class{};function RN(n){let e=Error(`No component factory found for ${Ot(n)}.`);return e[MN]=n,e}var MN="ngComponent";var mp=class{resolveComponentFactory(e){throw RN(e)}},Io=class{static{this.NULL=new mp}},Eo=class{};var NN=(()=>{class n{static{this.\u0275prov=G({token:n,providedIn:"root",factory:()=>null})}}return n})();function yp(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=hI(i,a);else if(o==2){let c=a,l=e[++s];r=hI(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var Jc=class extends Io{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=ii(e);return new pa(t,this.ngModule)}};function UI(n,e){let t=[];for(let r in n){if(!n.hasOwnProperty(r))continue;let i=n[r];if(i===void 0)continue;let o=Array.isArray(i),s=o?i[0]:i,a=o?i[1]:_r.None;e?t.push({propName:s,templateName:r,isSignal:(a&_r.SignalBased)!==0}):t.push({propName:s,templateName:r})}return t}function PN(n){let e=n.toLowerCase();return e==="svg"?fR:e==="math"?pR:null}var pa=class extends Zc{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=UI(e.inputs,!0);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return UI(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Wx(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let o=De(null);try{i=i||this.ngModule;let s=i instanceof Kt?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let a=s?new tp(e,s):e,c=a.get(Eo,null);if(c===null)throw new X(407,!1);let l=a.get(NN,null),h=a.get(wo,null),p={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,changeDetectionScheduler:h},m=c.createRenderer(null,this.componentDef),v=this.componentDef.selectors[0][0]||"div",b=r?UM(m,r,this.componentDef.encapsulation,a):yD(m,v,PN(v)),M=512;this.componentDef.signals?M|=4096:this.componentDef.onPush||(M|=16);let N=null;b!==null&&(N=Qp(b,a,!0));let V=ng(0,null,null,1,0,null,null,null,null,null,null),H=yl(null,V,null,M,null,null,p,m,a,null,N);Lp(H);let O,Y,ee=null;try{let Z=this.componentDef,I,y=null;Z.findHostDirectiveDefs?(I=[],y=new Map,Z.findHostDirectiveDefs(Z,I,y),I.push(Z)):I=[Z];let w=kN(H,b);ee=ON(w,b,Z,I,H,p,m),Y=AE(V,Ir),b&&VN(m,Z,b,r),t!==void 0&&jN(Y,this.ngContentSelectors,t),O=LN(ee,Z,I,y,H,[BN]),ig(V,H,null)}catch(Z){throw ee!==null&&up(ee),up(H),Z}finally{Vp()}return new vp(this.componentType,O,fl(Y,H),H,Y)}finally{De(o)}}},vp=class extends gp{constructor(e,t,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new li(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let o=this._rootLView;rg(o[pe],o,i,e,t),this.previousInputValues.set(e,t);let s=Do(this._tNode.index,o);GD(s,1)}}get injector(){return new ri(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function kN(n,e){let t=n[pe],r=Ir;return n[r]=e,vl(t,r,2,"#host",null)}function ON(n,e,t,r,i,o,s){let a=i[pe];FN(r,n,e,s);let c=null;e!==null&&(c=Qp(e,i[yo]));let l=o.rendererFactory.createRenderer(e,t),h=16;t.signals?h=4096:t.onPush&&(h=64);let p=yl(i,PD(t),null,h,i[n.index],n,o,l,null,null,c);return a.firstCreatePass&&hp(a,n,r.length-1),_l(i,p),i[n.index]=p}function FN(n,e,t,r){for(let i of n)e.mergedAttrs=Rp(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(yp(e,e.mergedAttrs,!0),t!==null&&TD(r,t,e))}function LN(n,e,t,r,i,o){let s=Tn(),a=i[pe],c=Cn(s,i);OD(a,i,s,t,null,r);for(let h=0;h<t.length;h++){let p=s.directiveStart+h,m=fa(i,a,p,s);ci(m,i)}FD(a,i,s),c&&ci(c,i);let l=fa(i,a,s.directiveStart+s.componentOffset,s);if(n[wr]=i[wr]=l,o!==null)for(let h of o)h(l,e);return RD(a,s,i),l}function VN(n,e,t,r){if(r)Gf(n,t,["ng-version","18.2.14"]);else{let{attrs:i,classes:o}=Kx(e.selectors[0]);i&&Gf(n,t,i),o&&o.length>0&&CD(n,t,o.join(" "))}}function jN(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null?Array.from(o):null)}}function BN(){let n=Tn();Up(it()[pe],n)}var Ia=(()=>{class n{static{this.__NG_ELEMENT_ID__=UN}}return n})();function UN(){let n=Tn();return HN(n,it())}var $N=Ia,QD=class extends $N{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return fl(this._hostTNode,this._hostLView)}get injector(){return new ri(this._hostTNode,this._hostLView)}get parentInjector(){let e=$p(this._hostTNode,this._hostLView);if(GE(e)){let t=zc(e,this._hostLView),r=qc(e),i=t[pe].data[r+8];return new ri(i,t)}else return new ri(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=$I(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Wt}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=BI(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,jI(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!cR(e),a;if(s)a=t;else{let b=t||{};a=b.index,r=b.injector,i=b.projectableNodes,o=b.environmentInjector||b.ngModuleRef}let c=s?e:new pa(ii(e)),l=r||this.parentInjector;if(!o&&c.ngModule==null){let M=(s?l:this.parentInjector).get(Kt,null);M&&(o=M)}let h=ii(c.componentType??{}),p=BI(this._lContainer,h?.id??null),m=p?.firstChild??null,v=c.create(l,i,m,o);return this.insertImpl(v.hostView,a,jI(this._hostTNode,p)),v}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(mR(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Tt],l=new QD(c,c[an],c[Tt]);l.detach(l.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return hN(s,i,o,r),e.attachToViewContainerRef(),sE($f(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=$I(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=lp(this._lContainer,t);r&&(Lc($f(this._lContainer),t),wD(r[pe],r))}detach(e){let t=this._adjustIndex(e,-1),r=lp(this._lContainer,t);return r&&Lc($f(this._lContainer),t)!=null?new li(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function $I(n){return n[Bc]}function $f(n){return n[Bc]||(n[Bc]=[])}function HN(n,e){let t,r=e[n.index];return Yn(r)?t=r:(t=LD(r,e,null,n),e[n.index]=t,_l(e,t)),zN(t,e,n,r),new QD(t,n,e)}function qN(n,e){let t=n[Ft],r=t.createComment(""),i=Cn(e,n),o=ED(t,i);return Qc(t,o,r,RM(t,i),!1),r}var zN=KN,GN=()=>!1;function WN(n,e,t){return GN(n,e,t)}function KN(n,e,t,r){if(n[oi])return;let i;t.type&8?i=qn(r):i=qN(e,t),n[oi]=i}var HI=new Set;function YD(n){HI.has(n)||(HI.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var Er=class{},ga=class{};var _p=class extends Er{constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Jc(this);let o=pE(e);this._bootstrapComponents=mD(o.bootstrap),this._r3Injector=nD(e,t,[{provide:Er,useValue:this},{provide:Io,useValue:this.componentFactoryResolver},...r],Ot(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},wp=class extends ga{constructor(e){super(),this.moduleType=e}create(e){return new _p(this.moduleType,e,[])}};var Xc=class extends Er{constructor(e){super(),this.componentFactoryResolver=new Jc(this),this.instance=null;let t=new la([...e.providers,{provide:Er,useValue:this},{provide:Io,useValue:this.componentFactoryResolver}],e.parent||Op(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function ag(n,e,t=null){return new Xc({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}function ZD(n){return YN(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function QN(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function YN(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function el(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function ZN(n,e,t,r){let i=el(n,e,t);return el(n,e+1,r)||i}function JN(n){return(n.flags&32)===32}function XN(n,e,t,r,i,o,s,a,c){let l=e.consts,h=vl(e,n,4,s||null,a||null);kD(e,t,h,Hc(l,c)),Up(e,h);let p=h.tView=ng(2,h,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,h),p.queries=e.queries.embeddedTView(h)),h}function eP(n,e,t,r,i,o,s,a,c,l){let h=t+Ir,p=e.firstCreatePass?XN(h,e,n,r,i,o,s,a,c):e.data[h];wa(p,!1);let m=tP(e,n,p,t);jp()&&eg(e,n,m,p),ci(m,n);let v=LD(m,n,m,p);return n[h]=v,_l(n,v),WN(v,p,n),DE(p)&&MD(e,n,p),c!=null&&ND(n,p,l),p}function un(n,e,t,r,i,o,s,a){let c=it(),l=Co(),h=Hc(l.consts,o);return eP(c,l,n,e,t,r,i,h,s,a),un}var tP=nP;function nP(n,e,t,r){return Bp(!0),e[Ft].createComment("")}var oa=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(oa||{}),rP=(()=>{class n{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=G({token:n,providedIn:"root",factory:()=>new n})}}return n})(),qI=class n{constructor(){this.ngZone=$(Ae),this.scheduler=$(wo),this.errorHandler=$(zn,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[oa.EarlyRead,oa.Write,oa.MixedReadWrite,oa.Read]}execute(){this.executing=!0;for(let e of n.PHASES)for(let t of this.sequences)if(!(t.erroredOrDestroyed||!t.hooks[e]))try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[e](t.pipelinedValue))}catch(r){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let e of this.sequences)e.afterRun(),e.once&&(this.sequences.delete(e),e.destroy());for(let e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}static{this.\u0275prov=G({token:n,providedIn:"root",factory:()=>new n})}};function iP(n,e,t,r){return el(n,LE(),t)?e+aa(t)+r:bo}function oP(n,e,t,r,i,o){let s=bR(),a=ZN(n,s,t,i);return AR(2),a?e+aa(t)+r+aa(i)+o:bo}function bt(n,e,t){let r=it(),i=LE();if(el(r,i,e)){let o=Co(),s=PR();WM(o,s,r,n,e,r[Ft],t,!1)}return bt}function zI(n,e,t,r,i){let o=e.inputs,s=i?"class":"style";rg(n,t,o[s],s,r)}function sP(n,e,t,r,i,o){let s=e.consts,a=Hc(s,i),c=vl(e,n,2,r,a);return kD(e,t,c,Hc(s,o)),c.attrs!==null&&yp(c,c.attrs,!1),c.mergedAttrs!==null&&yp(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function ue(n,e,t,r){let i=it(),o=Co(),s=Ir+n,a=i[Ft],c=o.firstCreatePass?sP(s,o,i,e,t,r):o.data[s],l=aP(o,i,c,a,e,n);i[s]=l;let h=DE(c);return wa(c,!0),TD(a,l,c),!JN(c)&&jp()&&eg(o,i,l,c),vR()===0&&ci(l,i),_R(),h&&(MD(o,i,c),RD(o,c,i)),r!==null&&ND(i,c),ue}function ce(){let n=Tn();OE()?TR():(n=n.parent,wa(n,!1));let e=n;ER(e)&&DR(),wR();let t=Co();return t.firstCreatePass&&(Up(t,n),EE(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&VR(e)&&zI(t,e,it(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&jR(e)&&zI(t,e,it(),e.stylesWithoutHost,!1),ce}function de(n,e,t,r){return ue(n,e,t,r),ce(),de}var aP=(n,e,t,r,i,o)=>(Bp(!0),yD(r,i,kR()));var tl="en-US";var uP=tl;function cP(n){typeof n=="string"&&(uP=n.toLowerCase().replace(/_/g,"-"))}function ve(n,e=""){let t=it(),r=Co(),i=n+Ir,o=r.firstCreatePass?vl(r,i,1,e,null):r.data[i],s=lP(r,t,o,e,n);t[i]=s,jp()&&eg(r,t,s,o),wa(o,!1)}var lP=(n,e,t,r,i)=>(Bp(!0),wM(e[Ft],r));function wl(n){return Te("",n,""),wl}function Te(n,e,t){let r=it(),i=iP(r,n,e,t);return i!==bo&&jD(r,hl(),i),Te}function Ea(n,e,t,r,i){let o=it(),s=oP(o,n,e,t,r,i);return s!==bo&&jD(o,hl(),s),Ea}var dP=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=yE(!1,t.type),i=r.length>0?ag([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=G({token:n,providedIn:"environment",factory:()=>new n(F(Kt))})}}return n})();function yt(n){YD("NgStandalone"),n.getStandaloneInjector=e=>e.get(dP).getOrCreateStandaloneInjector(n)}var Dr=class{constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},JD=new Dr("18.2.14");var Il=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();var XD=new Q("");function Da(n){return!!n&&typeof n.then=="function"}function eC(n){return!!n&&typeof n.subscribe=="function"}var tC=new Q(""),nC=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=$(tC,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=i();if(Da(o))t.push(o);else if(eC(o)){let s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),ug=new Q("");function hP(){Bw(()=>{throw new X(600,!1)})}function fP(n){return n.isBoundToModule}var pP=10;function gP(n,e,t){try{let r=t();return Da(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var hi=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=$(oM),this.afterRenderManager=$(rP),this.zonelessEnabled=$(sg),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new He,this.afterTick=new He,this.componentTypes=[],this.components=[],this.isStable=$(To).hasPendingTasks.pipe(z(t=>!t)),this._injector=$(Kt)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,r){let i=t instanceof Zc;if(!this._injector.get(nC).done){let m=!i&&fE(t),v=!1;throw new X(405,v)}let s;i?s=t:s=this._injector.get(Io).resolveComponentFactory(t),this.componentTypes.push(s.componentType);let a=fP(s)?void 0:this._injector.get(Er),c=r||s.selector,l=s.create(ui.NULL,[],c,a),h=l.location.nativeElement,p=l.injector.get(XD,null);return p?.registerApplication(h),l.onDestroy(()=>{this.detachView(l.hostView),Pc(this.components,l),p?.unregisterApplication(h)}),this._loadComponent(l),l}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new X(101,!1);let t=De(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,De(t),this.afterTick.next()}}synchronize(){let t=null;this._injector.destroyed||(t=this._injector.get(Eo,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let r=0;for(;this.dirtyFlags!==0&&r++<pP;)this.synchronizeOnce(t)}synchronizeOnce(t){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(r);for(let{_lView:i,notifyErrorHandler:o}of this._views)mP(i,o,r,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else t?.begin?.(),t?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>ll(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Pc(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let r=this._injector.get(ug,[]);[...this._bootstrapListeners,...r].forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Pc(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new X(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Pc(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function mP(n,e,t,r){if(!t&&!ll(n))return;$D(n,e,t&&!r?0:1)}var Ip=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},cg=(()=>{class n{compileModuleSync(t){return new wp(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=pE(t),o=mD(i.declarations).reduce((s,a)=>{let c=ii(a);return c&&s.push(new pa(c)),s},[]);return new Ip(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var yP=(()=>{class n{constructor(){this.zone=$(Ae),this.changeDetectionScheduler=$(wo),this.applicationRef=$(hi)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function vP({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new Ae(Pe(U({},_P()),{scheduleInRootZone:t})),[{provide:Ae,useFactory:n},{provide:mo,multi:!0,useFactory:()=>{let r=$(yP,{optional:!0});return()=>r.initialize()}},{provide:mo,multi:!0,useFactory:()=>{let r=$(wP);return()=>{r.initialize()}}},e===!0?{provide:WD,useValue:!0}:[],{provide:KD,useValue:t??rD}]}function _P(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var wP=(()=>{class n{constructor(){this.subscription=new Ue,this.initialized=!1,this.zone=$(Ae),this.pendingTasks=$(To)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Ae.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Ae.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var IP=(()=>{class n{constructor(){this.appRef=$(hi),this.taskService=$(To),this.ngZone=$(Ae),this.zonelessEnabled=$(sg),this.disableScheduling=$(WD,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new Ue,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Wc):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&($(KD,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof ap||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?MI:oD;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Wc+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,MI(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function EP(){return typeof $localize<"u"&&$localize.locale||tl}var lg=new Q("",{providedIn:"root",factory:()=>$(lg,ae.Optional|ae.SkipSelf)||EP()});var Ep=new Q("");function xc(n){return!n.moduleRef}function DP(n){let e=xc(n)?n.r3Injector:n.moduleRef.injector,t=e.get(Ae);return t.run(()=>{xc(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(zn,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),xc(n)){let o=()=>e.destroy(),s=n.platformInjector.get(Ep);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(Ep);s.add(o),n.moduleRef.onDestroy(()=>{Pc(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return gP(r,t,()=>{let o=e.get(nC);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(lg,tl);if(cP(s||tl),xc(n)){let a=e.get(hi);return n.rootComponent!==void 0&&a.bootstrap(n.rootComponent),a}else return CP(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function CP(n,e){let t=n.injector.get(hi);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new X(-403,!1);e.push(n)}var kc=null,rC=new Q("");function TP(n=[],e){return ui.create({name:e,providers:[{provide:sl,useValue:"platform"},{provide:Ep,useValue:new Set([()=>kc=null])},...n]})}function bP(n=[]){if(kc)return kc;let e=TP(n);return e.get(rC,!1)||(kc=e),hP(),SP(e),e}function SP(n){n.get(Wp,null)?.forEach(t=>t())}function dg(){return!1}var Ca=(()=>{class n{static{this.__NG_ELEMENT_ID__=AP}}return n})();function AP(n){return xP(Tn(),it(),(n&16)===16)}function xP(n,e,t){if(ul(n)&&!t){let r=Do(n.index,e);return new li(r,r)}else if(n.type&175){let r=e[Dn];return new li(r,e)}return null}var Dp=class{constructor(){}supports(e){return ZD(e)}create(e){return new Cp(e)}},RP=(n,e)=>e,Cp=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||RP}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<GI(r,i,o)?t:r,a=GI(s,i,o),c=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let l=a-i,h=c-i;if(l!=h){for(let m=0;m<l;m++){let v=m<o.length?o[m]:o[m]=0,b=v+m;h<=b&&b<l&&(o[m]=v+1)}let p=s.previousIndex;o[p]=h-l}}a!==c&&e(s,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!ZD(e))throw new X(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,QN(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new Tp(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new nl),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new nl),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Tp=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},bp=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},nl=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new bp,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function GI(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function WI(){return new hg([new Dp])}var hg=(()=>{class n{static{this.\u0275prov=G({token:n,providedIn:"root",factory:WI})}constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||WI()),deps:[[n,new oE,new ya]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new X(901,!1)}}return n})();function iC(n){let{rootComponent:e,appProviders:t,platformProviders:r,platformRef:i}=n;try{let o=i?.injector??bP(r);if(o.get(rC,!1)===!0&&!n.platformRef)throw new X(401,!1);let s=[vP({}),{provide:wo,useExisting:IP},...t||[]],a=new Xc({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return DP({r3Injector:a.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}}var cC=null;function So(){return cC}function lC(n){cC??=n}var El=class{};var Yt=new Q(""),dC=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:()=>$(kP),providedIn:"platform"})}}return n})();var kP=(()=>{class n extends dC{constructor(){super(),this._doc=$(Yt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return So().getBaseHref(this._doc)}onPopState(t){let r=So().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=So().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function hC(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function oC(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function fi(n){return n&&n[0]!=="?"?"?"+n:n}var Cl=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:()=>$(fC),providedIn:"root"})}}return n})(),OP=new Q(""),fC=(()=>{class n extends Cl{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??$(Yt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return hC(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+fi(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+fi(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+fi(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(F(dC),F(OP,8))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Ta=(()=>{class n{constructor(t){this._subject=new Ct,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=VP(oC(sC(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+fi(r))}normalize(t){return n.stripTrailingSlash(LP(this._basePath,sC(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+fi(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+fi(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=fi}static{this.joinWithSlash=hC}static{this.stripTrailingSlash=oC}static{this.\u0275fac=function(r){return new(r||n)(F(Cl))}}static{this.\u0275prov=G({token:n,factory:()=>FP(),providedIn:"root"})}}return n})();function FP(){return new Ta(F(Cl))}function LP(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function sC(n){return n.replace(/\/index.html$/,"")}function VP(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function pC(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var fg=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},bn=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;if(!this._differ&&t)if(0)try{}catch{}else this._differ=this._differs.find(t).create(this.ngForTrackBy)}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new fg(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,s),aC(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);aC(o,i)})}static ngTemplateContextGuard(t,r){return!0}static{this.\u0275fac=function(r){return new(r||n)(ot(Ia),ot(og),ot(hg))}}static{this.\u0275dir=ol({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return n})();function aC(n,e){n.context.$implicit=e.item}var cn=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Wn({type:n})}static{this.\u0275inj=Gn({})}}return n})(),gC="browser",jP="server";function pi(n){return n===jP}var Dl=class{};var mg=class extends El{constructor(){super(...arguments),this.supportsDOMEvents=!0}},yg=class n extends mg{static makeCurrent(){lC(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=BP();return t==null?null:UP(t)}resetBaseElement(){Sa=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return pC(document.cookie,e)}},Sa=null;function BP(){return Sa=Sa||document.querySelector("base"),Sa?Sa.getAttribute("href"):null}function UP(n){return new URL(n,document.baseURI).pathname}var $P=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})(),vg=new Q(""),_C=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new X(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)(F(vg),F(Ae))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})(),Tl=class{constructor(e){this._doc=e}},pg="ng-app-id",wC=(()=>{class n{constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=pi(o),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${pg}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let o=i.get(t);return o.usage+=r,o.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,o=i?.get(r);if(o?.parentNode===t)return i.delete(r),o.removeAttribute(pg),o;{let s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=r,this.platformIsServer&&s.setAttribute(pg,this.appId),t.appendChild(s),s}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),o=this.styleRef,s=o.get(r)?.elements;s?s.push(i):o.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)(F(Yt),F(Gp),F(Kp,8),F(Qt))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})(),gg={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},wg=/%COMP%/g,IC="%COMP%",HP=`_nghost-${IC}`,qP=`_ngcontent-${IC}`,zP=!0,GP=new Q("",{providedIn:"root",factory:()=>zP});function WP(n){return qP.replace(wg,n)}function KP(n){return HP.replace(wg,n)}function EC(n,e){return e.map(t=>t.replace(wg,n))}var mC=(()=>{class n{constructor(t,r,i,o,s,a,c,l=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=pi(a),this.defaultRenderer=new Aa(t,s,c,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===In.ShadowDom&&(r=Pe(U({},r),{encapsulation:In.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof bl?i.applyToHost(t):i instanceof xa&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(r.encapsulation){case In.Emulated:o=new bl(c,l,r,this.appId,h,s,a,p);break;case In.ShadowDom:return new _g(c,l,t,r,s,a,this.nonce,p);default:o=new xa(c,l,r,h,s,a,p);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)(F(_C),F(wC),F(Gp),F(GP),F(Yt),F(Qt),F(Ae),F(Kp))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})(),Aa=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(gg[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(yC(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(yC(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new X(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=gg[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=gg[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(di.DashCase|di.Important)?e.style.setProperty(t,r,i&di.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&di.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=So().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function yC(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var _g=class extends Aa{constructor(e,t,r,i,o,s,a,c){super(e,o,s,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=EC(i.id,i.styles);for(let h of l){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=h,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},xa=class extends Aa{constructor(e,t,r,i,o,s,a,c){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?EC(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},bl=class extends xa{constructor(e,t,r,i,o,s,a,c){let l=i+"-"+r.id;super(e,t,r,o,s,a,c,l),this.contentAttr=WP(l),this.hostAttr=KP(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},QP=(()=>{class n extends Tl{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)(F(Yt))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})(),vC=["alt","control","meta","shift"],YP={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ZP={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},JP=(()=>{class n extends Tl{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let o=n.parseEventName(r),s=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>So().onAndCancel(t,o.domEventName,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),vC.forEach(l=>{let h=r.indexOf(l);h>-1&&(r.splice(h,1),s+=l+".")}),s+=o,r.length!=0||o.length===0)return null;let c={};return c.domEventName=i,c.fullKey=s,c}static matchEventFullKeyCode(t,r){let i=YP[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),vC.forEach(s=>{if(s!==i){let a=ZP[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||n)(F(Yt))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac})}}return n})();function DC(n,e,t){return iC(U({rootComponent:n,platformRef:t?.platformRef},XP(e)))}function XP(n){return{appProviders:[...i1,...n?.providers??[]],platformProviders:r1}}function e1(){yg.makeCurrent()}function t1(){return new zn}function n1(){return hD(document),document}var r1=[{provide:Qt,useValue:gC},{provide:Wp,useValue:e1,multi:!0},{provide:Yt,useFactory:n1,deps:[]}];var i1=[{provide:sl,useValue:"root"},{provide:zn,useFactory:t1,deps:[]},{provide:vg,useClass:QP,multi:!0,deps:[Yt,Ae,Qt]},{provide:vg,useClass:JP,multi:!0,deps:[Yt]},mC,wC,_C,{provide:Eo,useExisting:mC},{provide:Dl,useClass:$P,deps:[]},[]];var CC=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||n)(F(Yt))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var oe="primary",Ga=Symbol("RouteTitle"),Tg=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Po(n){return new Tg(n)}function s1(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function a1(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Sn(n[t],e[t]))return!1;return!0}function Sn(n,e){let t=n?bg(n):void 0,r=e?bg(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!NC(n[i],e[i]))return!1;return!0}function bg(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function NC(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}else return n===e}function PC(n){return n.length>0?n[n.length-1]:null}function Cr(n){return Af(n)?n:Da(n)?Ce(Promise.resolve(n)):J(n)}var u1={exact:OC,subset:FC},kC={exact:c1,subset:l1,ignored:()=>!0};function TC(n,e,t){return u1[t.paths](n.root,e.root,t.matrixParams)&&kC[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function c1(n,e){return Sn(n,e)}function OC(n,e,t){if(!mi(n.segments,e.segments)||!xl(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!OC(n.children[r],e.children[r],t))return!1;return!0}function l1(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>NC(n[t],e[t]))}function FC(n,e,t){return LC(n,e,e.segments,t)}function LC(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!mi(i,t)||e.hasChildren()||!xl(i,t,r))}else if(n.segments.length===t.length){if(!mi(n.segments,t)||!xl(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!FC(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!mi(n.segments,i)||!xl(n.segments,i,r)||!n.children[oe]?!1:LC(n.children[oe],e,o,r)}}function xl(n,e,t){return e.every((r,i)=>kC[t](n[i].parameters,r.parameters))}var Jn=class{constructor(e=new Ee([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Po(this.queryParams),this._queryParamMap}toString(){return f1.serialize(this)}},Ee=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Rl(this)}},gi=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Po(this.parameters),this._parameterMap}toString(){return jC(this)}};function d1(n,e){return mi(n,e)&&n.every((t,r)=>Sn(t.parameters,e[r].parameters))}function mi(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function h1(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===oe&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==oe&&(t=t.concat(e(i,r)))}),t}var Jg=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:()=>new Fa,providedIn:"root"})}}return n})(),Fa=class{parse(e){let t=new Ag(e);return new Jn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Ra(e.root,!0)}`,r=m1(e.queryParams),i=typeof e.fragment=="string"?`#${p1(e.fragment)}`:"";return`${t}${r}${i}`}},f1=new Fa;function Rl(n){return n.segments.map(e=>jC(e)).join("/")}function Ra(n,e){if(!n.hasChildren())return Rl(n);if(e){let t=n.children[oe]?Ra(n.children[oe],!1):"",r=[];return Object.entries(n.children).forEach(([i,o])=>{i!==oe&&r.push(`${i}:${Ra(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=h1(n,(r,i)=>i===oe?[Ra(n.children[oe],!1)]:[`${i}:${Ra(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[oe]!=null?`${Rl(n)}/${t[0]}`:`${Rl(n)}/(${t.join("//")})`}}function VC(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Sl(n){return VC(n).replace(/%3B/gi,";")}function p1(n){return encodeURI(n)}function Sg(n){return VC(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ml(n){return decodeURIComponent(n)}function bC(n){return Ml(n.replace(/\+/g,"%20"))}function jC(n){return`${Sg(n.path)}${g1(n.parameters)}`}function g1(n){return Object.entries(n).map(([e,t])=>`;${Sg(e)}=${Sg(t)}`).join("")}function m1(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Sl(t)}=${Sl(i)}`).join("&"):`${Sl(t)}=${Sl(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var y1=/^[^\/()?;#]+/;function Ig(n){let e=n.match(y1);return e?e[0]:""}var v1=/^[^\/()?;=#]+/;function _1(n){let e=n.match(v1);return e?e[0]:""}var w1=/^[^=?&#]+/;function I1(n){let e=n.match(w1);return e?e[0]:""}var E1=/^[^&#]+/;function D1(n){let e=n.match(E1);return e?e[0]:""}var Ag=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ee([],{}):new Ee([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[oe]=new Ee(e,t)),r}parseSegment(){let e=Ig(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new X(4009,!1);return this.capture(e),new gi(Ml(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=_1(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Ig(this.remaining);i&&(r=i,this.capture(r))}e[Ml(t)]=Ml(r)}parseQueryParam(e){let t=I1(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let s=D1(this.remaining);s&&(r=s,this.capture(r))}let i=bC(t),o=bC(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Ig(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new X(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=oe);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[oe]:new Ee([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new X(4011,!1)}};function BC(n){return n.segments.length>0?new Ee([],{[oe]:n}):n}function UC(n){let e={};for(let[r,i]of Object.entries(n.children)){let o=UC(i);if(r===oe&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let t=new Ee(n.segments,e);return C1(t)}function C1(n){if(n.numberOfChildren===1&&n.children[oe]){let e=n.children[oe];return new Ee(n.segments.concat(e.segments),e.children)}return n}function La(n){return n instanceof Jn}function T1(n,e,t=null,r=null){let i=$C(n);return HC(i,e,t,r)}function $C(n){let e;function t(o){let s={};for(let c of o.children){let l=t(c);s[c.outlet]=l}let a=new Ee(o.url,s);return o===n&&(e=a),a}let r=t(n.root),i=BC(r);return e??i}function HC(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Eg(i,i,i,t,r);let o=b1(e);if(o.toRoot())return Eg(i,i,new Ee([],{}),t,r);let s=S1(o,i,n),a=s.processChildren?Pa(s.segmentGroup,s.index,o.commands):zC(s.segmentGroup,s.index,o.commands);return Eg(i,s.segmentGroup,a,t,r)}function Nl(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Va(n){return typeof n=="object"&&n!=null&&n.outlets}function Eg(n,e,t,r,i){let o={};r&&Object.entries(r).forEach(([c,l])=>{o[c]=Array.isArray(l)?l.map(h=>`${h}`):`${l}`});let s;n===e?s=t:s=qC(n,e,t);let a=BC(UC(s));return new Jn(a,o,i)}function qC(n,e,t){let r={};return Object.entries(n.children).forEach(([i,o])=>{o===e?r[i]=t:r[i]=qC(o,e,t)}),new Ee(n.segments,r)}var Pl=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Nl(r[0]))throw new X(4003,!1);let i=r.find(Va);if(i&&i!==PC(r))throw new X(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function b1(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Pl(!0,0,n);let e=0,t=!1,r=n.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new Pl(t,e,r)}var Ro=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function S1(n,e,t){if(n.isAbsolute)return new Ro(e,!0,0);if(!t)return new Ro(e,!1,NaN);if(t.parent===null)return new Ro(t,!0,0);let r=Nl(n.commands[0])?0:1,i=t.segments.length-1+r;return A1(t,i,n.numberOfDoubleDots)}function A1(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new X(4005,!1);i=r.segments.length}return new Ro(r,!1,i-o)}function x1(n){return Va(n[0])?n[0].outlets:{[oe]:n}}function zC(n,e,t){if(n??=new Ee([],{}),n.segments.length===0&&n.hasChildren())return Pa(n,e,t);let r=R1(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let o=new Ee(n.segments.slice(0,r.pathIndex),{});return o.children[oe]=new Ee(n.segments.slice(r.pathIndex),n.children),Pa(o,0,i)}else return r.match&&i.length===0?new Ee(n.segments,{}):r.match&&!n.hasChildren()?xg(n,e,t):r.match?Pa(n,0,i):xg(n,e,t)}function Pa(n,e,t){if(t.length===0)return new Ee(n.segments,{});{let r=x1(t),i={};if(Object.keys(r).some(o=>o!==oe)&&n.children[oe]&&n.numberOfChildren===1&&n.children[oe].segments.length===0){let o=Pa(n.children[oe],e,t);return new Ee(n.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=zC(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new Ee(n.segments,i)}}function R1(n,e,t){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;let s=n.segments[i],a=t[r];if(Va(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!AC(c,l,s))return o;r+=2}else{if(!AC(c,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function xg(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(Va(o)){let c=M1(o.outlets);return new Ee(r,c)}if(i===0&&Nl(t[0])){let c=n.segments[e];r.push(new gi(c.path,SC(t[0]))),i++;continue}let s=Va(o)?o.outlets[oe]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&Nl(a)?(r.push(new gi(s,SC(a))),i+=2):(r.push(new gi(s,{})),i++)}return new Ee(r,{})}function M1(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=xg(new Ee([],{}),0,r))}),e}function SC(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function AC(n,e,t){return n==t.path&&Sn(e,t.parameters)}var ka="imperative",ut=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(ut||{}),Zt=class{constructor(e,t){this.id=e,this.url=t}},ja=class extends Zt{constructor(e,t,r="imperative",i=null){super(e,t),this.type=ut.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},yi=class extends Zt{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=ut.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Vt=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Vt||{}),Rg=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Rg||{}),Zn=class extends Zt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=ut.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},vi=class extends Zt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=ut.NavigationSkipped}},Ba=class extends Zt{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=ut.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},kl=class extends Zt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ut.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Mg=class extends Zt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ut.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ng=class extends Zt{constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o,this.type=ut.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Pg=class extends Zt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ut.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},kg=class extends Zt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ut.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Og=class{constructor(e){this.route=e,this.type=ut.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Fg=class{constructor(e){this.route=e,this.type=ut.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Lg=class{constructor(e){this.snapshot=e,this.type=ut.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Vg=class{constructor(e){this.snapshot=e,this.type=ut.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},jg=class{constructor(e){this.snapshot=e,this.type=ut.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Bg=class{constructor(e){this.snapshot=e,this.type=ut.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Ua=class{},ko=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function N1(n,e){return n.providers&&!n._injector&&(n._injector=ag(n.providers,e,`Route: ${n.path}`)),n._injector??e}function ln(n){return n.outlet||oe}function P1(n,e){let t=n.filter(r=>ln(r)===e);return t.push(...n.filter(r=>ln(r)!==e)),t}function Wa(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Ug=class{get injector(){return Wa(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new Ul(this.rootInjector),this.attachRef=null}},Ul=(()=>{class n{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Ug(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||n)(F(Kt))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ol=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=$g(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=$g(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Hg(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Hg(e,this._root).map(t=>t.value)}};function $g(n,e){if(n===e.value)return e;for(let t of e.children){let r=$g(n,t);if(r)return r}return null}function Hg(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Hg(n,t);if(r.length)return r.unshift(e),r}return[]}var Lt=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function xo(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Fl=class extends Ol{constructor(e,t){super(e),this.snapshot=t,Xg(this,e)}toString(){return this.snapshot.toString()}};function GC(n){let e=k1(n),t=new at([new gi("",{})]),r=new at({}),i=new at({}),o=new at({}),s=new at(""),a=new Oo(t,r,o,s,i,oe,n,e.root);return a.snapshot=e.root,new Fl(new Lt(a,[]),e)}function k1(n){let e={},t={},r={},i="",o=new Mo([],e,r,i,t,oe,n,null,{});return new Vl("",new Lt(o,[]))}var Oo=class{constructor(e,t,r,i,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(z(l=>l[Ga]))??J(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(z(e=>Po(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(z(e=>Po(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Ll(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:U(U({},e.params),n.params),data:U(U({},e.data),n.data),resolve:U(U(U(U({},n.data),e.data),i?.data),n._resolvedData)}:r={params:U({},n.params),data:U({},n.data),resolve:U(U({},n.data),n._resolvedData??{})},i&&KC(i)&&(r.resolve[Ga]=i.title),r}var Mo=class{get title(){return this.data?.[Ga]}constructor(e,t,r,i,o,s,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Po(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Po(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Vl=class extends Ol{constructor(e,t){super(t),this.url=e,Xg(this,t)}toString(){return WC(this._root)}};function Xg(n,e){e.value._routerState=n,e.children.forEach(t=>Xg(n,t))}function WC(n){let e=n.children.length>0?` { ${n.children.map(WC).join(", ")} } `:"";return`${n.value}${e}`}function Dg(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Sn(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Sn(e.params,t.params)||n.paramsSubject.next(t.params),a1(e.url,t.url)||n.urlSubject.next(t.url),Sn(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function qg(n,e){let t=Sn(n.params,e.params)&&d1(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||qg(n.parent,e.parent))}function KC(n){return typeof n.title=="string"||n.title===null}var O1=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=oe,this.activateEvents=new Ct,this.deactivateEvents=new Ct,this.attachEvents=new Ct,this.detachEvents=new Ct,this.parentContexts=$(Ul),this.location=$(Ia),this.changeDetector=$(Ca),this.inputBinder=$(em,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new X(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new X(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new X(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new X(4013,!1);this._activatedRoute=t;let i=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new zg(t,a,i.injector);this.activated=i.createComponent(s,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=ol({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[cl]})}}return n})(),zg=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Oo?this.route:e===Ul?this.childContexts:this.parent.get(e,t)}},em=new Q("");function F1(n,e,t){let r=$a(n,e._root,t?t._root:void 0);return new Fl(r,e)}function $a(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=L1(n,e,t);return new Lt(r,i)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>$a(n,a)),s}}let r=V1(e.value),i=e.children.map(o=>$a(n,o));return new Lt(r,i)}}function L1(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return $a(n,r,i);return $a(n,r)})}function V1(n){return new Oo(new at(n.url),new at(n.params),new at(n.queryParams),new at(n.fragment),new at(n.data),n.outlet,n.component,n)}var Ha=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},QC="ngNavigationCancelingError";function jl(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=La(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=YC(!1,Vt.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function YC(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[QC]=!0,t.cancellationCode=e,t}function j1(n){return ZC(n)&&La(n.url)}function ZC(n){return!!n&&n[QC]}var B1=(n,e,t,r)=>z(i=>(new Gg(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Gg=class{constructor(e,t,r,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Dg(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=xo(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=xo(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=xo(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=xo(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new Bg(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Vg(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(Dg(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),Dg(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,r)}},Bl=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},No=class{constructor(e,t){this.component=e,this.route=t}};function U1(n,e,t){let r=n._root,i=e?e._root:null;return Ma(r,i,t,[r.value])}function $1(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Lo(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!JI(n)?n:e.get(n):r}function Ma(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=xo(e);return n.children.forEach(s=>{H1(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Oa(a,t.getContext(s),i)),i}function H1(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=q1(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Bl(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?Ma(n,e,a?a.children:null,r,i):Ma(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new No(a.outlet.component,s))}else s&&Oa(e,a,i),i.canActivateChecks.push(new Bl(r)),o.component?Ma(n,null,a?a.children:null,r,i):Ma(n,null,t,r,i);return i}function q1(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!mi(n.url,e.url);case"pathParamsOrQueryParamsChange":return!mi(n.url,e.url)||!Sn(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!qg(n,e)||!Sn(n.queryParams,e.queryParams);case"paramsChange":default:return!qg(n,e)}}function Oa(n,e,t){let r=xo(n),i=n.value;Object.entries(r).forEach(([o,s])=>{i.component?e?Oa(s,e.children.getContext(o),t):Oa(s,null,t):Oa(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new No(e.outlet.component,i)):t.canDeactivateChecks.push(new No(null,i)):t.canDeactivateChecks.push(new No(null,i))}function Ka(n){return typeof n=="function"}function z1(n){return typeof n=="boolean"}function G1(n){return n&&Ka(n.canLoad)}function W1(n){return n&&Ka(n.canActivate)}function K1(n){return n&&Ka(n.canActivateChild)}function Q1(n){return n&&Ka(n.canDeactivate)}function Y1(n){return n&&Ka(n.canMatch)}function JC(n){return n instanceof $n||n?.name==="EmptyError"}var Al=Symbol("INITIAL_VALUE");function Fo(){return qe(n=>Dc(n.map(e=>e.pipe(Hn(1),ti(Al)))).pipe(z(e=>{for(let t of e)if(t!==!0){if(t===Al)return Al;if(t===!1||Z1(t))return t}return!0}),gt(e=>e!==Al),Hn(1)))}function Z1(n){return La(n)||n instanceof Ha}function J1(n,e){return et(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?J(Pe(U({},t),{guardsResult:!0})):X1(s,r,i,n).pipe(et(a=>a&&z1(a)?ek(r,o,n,e):J(a)),z(a=>Pe(U({},t),{guardsResult:a})))})}function X1(n,e,t,r){return Ce(n).pipe(et(i=>ok(i.component,i.route,t,e,r)),Ht(i=>i!==!0,!0))}function ek(n,e,t,r){return Ce(e).pipe(ao(i=>so(nk(i.route.parent,r),tk(i.route,r),ik(n,i.path,t),rk(n,i.route,t))),Ht(i=>i!==!0,!0))}function tk(n,e){return n!==null&&e&&e(new jg(n)),J(!0)}function nk(n,e){return n!==null&&e&&e(new Lg(n)),J(!0)}function rk(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return J(!0);let i=r.map(o=>Cc(()=>{let s=Wa(e)??t,a=Lo(o,s),c=W1(a)?a.canActivate(e,n):Kn(s,()=>a(e,n));return Cr(c).pipe(Ht())}));return J(i).pipe(Fo())}function ik(n,e,t){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>$1(s)).filter(s=>s!==null).map(s=>Cc(()=>{let a=s.guards.map(c=>{let l=Wa(s.node)??t,h=Lo(c,l),p=K1(h)?h.canActivateChild(r,n):Kn(l,()=>h(r,n));return Cr(p).pipe(Ht())});return J(a).pipe(Fo())}));return J(o).pipe(Fo())}function ok(n,e,t,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return J(!0);let s=o.map(a=>{let c=Wa(e)??i,l=Lo(a,c),h=Q1(l)?l.canDeactivate(n,e,t,r):Kn(c,()=>l(n,e,t,r));return Cr(h).pipe(Ht())});return J(s).pipe(Fo())}function sk(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return J(!0);let o=i.map(s=>{let a=Lo(s,n),c=G1(a)?a.canLoad(e,t):Kn(n,()=>a(e,t));return Cr(c)});return J(o).pipe(Fo(),XC(r))}function XC(n){return Ef(tt(e=>{if(typeof e!="boolean")throw jl(n,e)}),z(e=>e===!0))}function ak(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return J(!0);let o=i.map(s=>{let a=Lo(s,n),c=Y1(a)?a.canMatch(e,t):Kn(n,()=>a(e,t));return Cr(c)});return J(o).pipe(Fo(),XC(r))}var qa=class{constructor(e){this.segmentGroup=e||null}},za=class extends Error{constructor(e){super(),this.urlTree=e}};function Ao(n){return oo(new qa(n))}function uk(n){return oo(new X(4e3,!1))}function ck(n){return oo(YC(!1,Vt.GuardRejected))}var Wg=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return J(r);if(i.numberOfChildren>1||!i.children[oe])return uk(`${e.redirectTo}`);i=i.children[oe]}}applyRedirectCommands(e,t,r,i,o){if(typeof t!="string"){let a=t,{queryParams:c,fragment:l,routeConfig:h,url:p,outlet:m,params:v,data:b,title:M}=i,N=Kn(o,()=>a({params:v,data:b,queryParams:c,fragment:l,routeConfig:h,url:p,outlet:m,title:M}));if(N instanceof Jn)throw new za(N);t=N}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new za(s);return s}applyRedirectCreateUrlTree(e,t,r,i){let o=this.createSegmentGroup(e,t.root,r,i);return new Jn(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=t[a]}else r[i]=o}),r}createSegmentGroup(e,t,r,i){let o=this.createSegments(e,t.segments,r,i),s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,r,i)}),new Ee(o,s)}createSegments(e,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new X(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Kg={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function lk(n,e,t,r,i){let o=e0(n,e,t);return o.matched?(r=N1(e,r),ak(r,e,t,i).pipe(z(s=>s===!0?o:U({},Kg)))):J(o)}function e0(n,e,t){if(e.path==="**")return dk(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?U({},Kg):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||s1)(t,n,e);if(!i)return U({},Kg);let o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});let s=i.consumed.length>0?U(U({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function dk(n){return{matched:!0,parameters:n.length>0?PC(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function xC(n,e,t,r){return t.length>0&&pk(n,t,r)?{segmentGroup:new Ee(e,fk(r,new Ee(t,n.children))),slicedSegments:[]}:t.length===0&&gk(n,t,r)?{segmentGroup:new Ee(n.segments,hk(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Ee(n.segments,n.children),slicedSegments:t}}function hk(n,e,t,r){let i={};for(let o of t)if($l(n,e,o)&&!r[ln(o)]){let s=new Ee([],{});i[ln(o)]=s}return U(U({},r),i)}function fk(n,e){let t={};t[oe]=e;for(let r of n)if(r.path===""&&ln(r)!==oe){let i=new Ee([],{});t[ln(r)]=i}return t}function pk(n,e,t){return t.some(r=>$l(n,e,r)&&ln(r)!==oe)}function gk(n,e,t){return t.some(r=>$l(n,e,r))}function $l(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function mk(n,e,t){return e.length===0&&!n.children[t]}var Qg=class{};function yk(n,e,t,r,i,o,s="emptyOnly"){return new Yg(n,e,t,r,i,s,o).recognize()}var vk=31,Yg=class{constructor(e,t,r,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new Wg(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new X(4002,`'${e.segmentGroup}'`)}recognize(){let e=xC(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(z(({children:t,rootSnapshot:r})=>{let i=new Lt(r,t),o=new Vl("",i),s=T1(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new Mo([],Object.freeze({}),Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),oe,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,oe,t).pipe(z(r=>({children:r,rootSnapshot:t})),pr(r=>{if(r instanceof za)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof qa?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,o):this.processSegment(e,t,r,r.segments,i,!0,o).pipe(z(s=>s instanceof Lt?[s]:[]))}processChildren(e,t,r,i){let o=[];for(let s of Object.keys(r.children))s==="primary"?o.unshift(s):o.push(s);return Ce(o).pipe(ao(s=>{let a=r.children[s],c=P1(t,s);return this.processSegmentGroup(e,c,a,s,i)}),ei((s,a)=>(s.push(...a),s)),gr(null),Nf(),et(s=>{if(s===null)return Ao(r);let a=t0(s);return _k(a),J(a)}))}processSegment(e,t,r,i,o,s,a){return Ce(t).pipe(ao(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,o,s,a).pipe(pr(l=>{if(l instanceof qa)return J(null);throw l}))),Ht(c=>!!c),pr(c=>{if(JC(c))return mk(r,i,o)?J(new Qg):Ao(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,o,s,a,c){return ln(r)!==s&&(s===oe||!$l(i,o,r))?Ao(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,s,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,o,s,c):Ao(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s,a){let{matched:c,parameters:l,consumedSegments:h,positionalParamSegments:p,remainingSegments:m}=e0(t,i,o);if(!c)return Ao(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>vk&&(this.allowRedirects=!1));let v=new Mo(o,l,Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,RC(i),ln(i),i.component??i._loadedComponent??null,i,MC(i)),b=Ll(v,a,this.paramsInheritanceStrategy);v.params=Object.freeze(b.params),v.data=Object.freeze(b.data);let M=this.applyRedirects.applyRedirectCommands(h,i.redirectTo,p,v,e);return this.applyRedirects.lineralizeSegments(i,M).pipe(et(N=>this.processSegment(e,r,t,N.concat(m),s,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,o,s){let a=lk(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(qe(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(qe(({routes:l})=>{let h=r._loadedInjector??e,{parameters:p,consumedSegments:m,remainingSegments:v}=c,b=new Mo(m,p,Object.freeze(U({},this.urlTree.queryParams)),this.urlTree.fragment,RC(r),ln(r),r.component??r._loadedComponent??null,r,MC(r)),M=Ll(b,s,this.paramsInheritanceStrategy);b.params=Object.freeze(M.params),b.data=Object.freeze(M.data);let{segmentGroup:N,slicedSegments:V}=xC(t,m,v,l);if(V.length===0&&N.hasChildren())return this.processChildren(h,l,N,b).pipe(z(O=>new Lt(b,O)));if(l.length===0&&V.length===0)return J(new Lt(b,[]));let H=ln(r)===o;return this.processSegment(h,l,N,V,H?oe:o,!0,b).pipe(z(O=>new Lt(b,O instanceof Lt?[O]:[])))}))):Ao(t)))}getChildConfig(e,t,r){return t.children?J({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?J({routes:t._loadedRoutes,injector:t._loadedInjector}):sk(e,t,r,this.urlSerializer).pipe(et(i=>i?this.configLoader.loadChildren(e,t).pipe(tt(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):ck(t))):J({routes:[],injector:e})}};function _k(n){n.sort((e,t)=>e.value.outlet===oe?-1:t.value.outlet===oe?1:e.value.outlet.localeCompare(t.value.outlet))}function wk(n){let e=n.value.routeConfig;return e&&e.path===""}function t0(n){let e=[],t=new Set;for(let r of n){if(!wk(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=t0(r.children);e.push(new Lt(r.value,i))}return e.filter(r=>!t.has(r))}function RC(n){return n.data||{}}function MC(n){return n.resolve||{}}function Ik(n,e,t,r,i,o){return et(s=>yk(n,e,t,r,s.extractedUrl,i,o).pipe(z(({state:a,tree:c})=>Pe(U({},s),{targetSnapshot:a,urlAfterRedirects:c}))))}function Ek(n,e){return et(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return J(t);let o=new Set(i.map(c=>c.route)),s=new Set;for(let c of o)if(!s.has(c))for(let l of n0(c))s.add(l);let a=0;return Ce(s).pipe(ao(c=>o.has(c)?Dk(c,r,n,e):(c.data=Ll(c,c.parent,n).resolve,J(void 0))),tt(()=>a++),uo(1),et(c=>a===s.size?J(t):Dt))})}function n0(n){let e=n.children.map(t=>n0(t)).flat();return[n,...e]}function Dk(n,e,t,r){let i=n.routeConfig,o=n._resolve;return i?.title!==void 0&&!KC(i)&&(o[Ga]=i.title),Ck(o,n,e,r).pipe(z(s=>(n._resolvedData=s,n.data=Ll(n,n.parent,t).resolve,null)))}function Ck(n,e,t,r){let i=bg(n);if(i.length===0)return J({});let o={};return Ce(i).pipe(et(s=>Tk(n[s],e,t,r).pipe(Ht(),tt(a=>{if(a instanceof Ha)throw jl(new Fa,a);o[s]=a}))),uo(1),Rf(o),pr(s=>JC(s)?Dt:oo(s)))}function Tk(n,e,t,r){let i=Wa(e)??r,o=Lo(n,i),s=o.resolve?o.resolve(e,t):Kn(i,()=>o(e,t));return Cr(s)}function Cg(n){return qe(e=>{let t=n(e);return t?Ce(t).pipe(z(()=>e)):J(e)})}var r0=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===oe);return r}getResolvedTitleForRoute(t){return t.data[Ga]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:()=>$(bk),providedIn:"root"})}}return n})(),bk=(()=>{class n extends r0{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||n)(F(CC))}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),tm=new Q("",{providedIn:"root",factory:()=>({})}),Sk=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=mt({type:n,selectors:[["ng-component"]],standalone:!0,features:[yt],decls:1,vars:0,template:function(r,i){r&1&&de(0,"router-outlet")},dependencies:[O1],encapsulation:2})}}return n})();function nm(n){let e=n.children&&n.children.map(nm),t=e?Pe(U({},n),{children:e}):U({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==oe&&(t.component=Sk),t}var rm=new Q(""),Ak=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=$(cg)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return J(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=Cr(t.loadComponent()).pipe(z(i0),tt(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),na(()=>{this.componentLoaders.delete(t)})),i=new to(r,()=>new He).pipe(eo());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return J({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=xk(r,this.compiler,t,this.onLoadEndListener).pipe(na(()=>{this.childrenLoaders.delete(r)})),s=new to(o,()=>new He).pipe(eo());return this.childrenLoaders.set(r,s),s}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function xk(n,e,t,r){return Cr(n.loadChildren()).pipe(z(i0),et(i=>i instanceof ga||Array.isArray(i)?J(i):Ce(e.compileModuleAsync(i))),z(i=>{r&&r(n);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(t).injector,s=o.get(rm,[],{optional:!0,self:!0}).flat()),{routes:s.map(nm),injector:o}}))}function Rk(n){return n&&typeof n=="object"&&"default"in n}function i0(n){return Rk(n)?n.default:n}var im=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:()=>$(Mk),providedIn:"root"})}}return n})(),Mk=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Nk=new Q("");var Pk=new Q(""),kk=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new He,this.transitionAbortSubject=new He,this.configLoader=$(Ak),this.environmentInjector=$(Kt),this.urlSerializer=$(Jg),this.rootContexts=$(Ul),this.location=$(Ta),this.inputBindingEnabled=$(em,{optional:!0})!==null,this.titleStrategy=$(r0),this.options=$(tm,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=$(im),this.createViewTransition=$(Nk,{optional:!0}),this.navigationErrorHandler=$(Pk,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>J(void 0),this.rootComponentType=null;let t=i=>this.events.next(new Og(i)),r=i=>this.events.next(new Fg(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(Pe(U(U({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new at({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:ka,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(gt(o=>o.id!==0),z(o=>Pe(U({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),qe(o=>{let s=!1,a=!1;return J(o).pipe(qe(c=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Vt.SupersededByNewNavigation),Dt;this.currentTransition=o,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?Pe(U({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=c.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!l&&h!=="reload"){let p="";return this.events.next(new vi(c.id,this.urlSerializer.serialize(c.rawUrl),p,Rg.IgnoredSameUrlNavigation)),c.resolve(!1),Dt}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return J(c).pipe(qe(p=>{let m=this.transitions?.getValue();return this.events.next(new ja(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),m!==this.transitions?.getValue()?Dt:Promise.resolve(p)}),Ik(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),tt(p=>{o.targetSnapshot=p.targetSnapshot,o.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=Pe(U({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let m=new kl(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(m)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:p,extractedUrl:m,source:v,restoredState:b,extras:M}=c,N=new ja(p,this.urlSerializer.serialize(m),v,b);this.events.next(N);let V=GC(this.rootComponentType).snapshot;return this.currentTransition=o=Pe(U({},c),{targetSnapshot:V,urlAfterRedirects:m,extras:Pe(U({},M),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=m,J(o)}else{let p="";return this.events.next(new vi(c.id,this.urlSerializer.serialize(c.extractedUrl),p,Rg.IgnoredByUrlHandlingStrategy)),c.resolve(!1),Dt}}),tt(c=>{let l=new Mg(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),z(c=>(this.currentTransition=o=Pe(U({},c),{guards:U1(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),J1(this.environmentInjector,c=>this.events.next(c)),tt(c=>{if(o.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw jl(this.urlSerializer,c.guardsResult);let l=new Ng(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),gt(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",Vt.GuardRejected),!1)),Cg(c=>{if(c.guards.canActivateChecks.length)return J(c).pipe(tt(l=>{let h=new Pg(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),qe(l=>{let h=!1;return J(l).pipe(Ek(this.paramsInheritanceStrategy,this.environmentInjector),tt({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(l,"",Vt.NoDataFromResolver)}}))}),tt(l=>{let h=new kg(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}))}),Cg(c=>{let l=h=>{let p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(tt(m=>{h.component=m}),z(()=>{})));for(let m of h.children)p.push(...l(m));return p};return Dc(l(c.targetSnapshot.root)).pipe(gr(null),Hn(1))}),Cg(()=>this.afterPreactivation()),qe(()=>{let{currentSnapshot:c,targetSnapshot:l}=o,h=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return h?Ce(h).pipe(z(()=>o)):J(o)}),z(c=>{let l=F1(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=Pe(U({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),tt(()=>{this.events.next(new Ua)}),B1(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Hn(1),tt({next:c=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new yi(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{s=!0}}),kf(this.transitionAbortSubject.pipe(tt(c=>{throw c}))),na(()=>{!s&&!a&&this.cancelNavigationTransition(o,"",Vt.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),pr(c=>{if(a=!0,ZC(c))this.events.next(new Zn(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),j1(c)?this.events.next(new ko(c.url,c.navigationBehaviorOptions)):o.resolve(!1);else{let l=new Ba(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0);try{let h=Kn(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(h instanceof Ha){let{message:p,cancellationCode:m}=jl(this.urlSerializer,h);this.events.next(new Zn(o.id,this.urlSerializer.serialize(o.extractedUrl),p,m)),this.events.next(new ko(h.redirectTo,h.navigationBehaviorOptions))}else{this.events.next(l);let p=t.errorHandler(c);o.resolve(!!p)}}catch(h){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(h)}}return Dt}))}))}cancelNavigationTransition(t,r,i){let o=new Zn(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Ok(n){return n!==ka}var Fk=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:()=>$(Lk),providedIn:"root"})}}return n})(),Zg=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},Lk=(()=>{class n extends Zg{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Hp(n)))(i||n)}})()}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),o0=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:()=>$(Vk),providedIn:"root"})}}return n})(),Vk=(()=>{class n extends o0{constructor(){super(...arguments),this.location=$(Ta),this.urlSerializer=$(Jg),this.options=$(tm,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=$(im),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Jn,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=GC(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof ja)this.stateMemento=this.createStateMemento();else if(t instanceof vi)this.rawUrlTree=r.initialUrl;else if(t instanceof kl){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof Ua?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof Zn&&(t.code===Vt.GuardRejected||t.code===Vt.NoDataFromResolver)?this.restoreHistory(r):t instanceof Ba?this.restoreHistory(r,!0):t instanceof yi&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof Jn?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let o=this.browserPageId,s=U(U({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(i,"",s)}else{let o=U(U({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",o)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.currentUrlTree===t.finalUrl&&o===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Hp(n)))(i||n)}})()}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Na=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Na||{});function jk(n,e){n.events.pipe(gt(t=>t instanceof yi||t instanceof Zn||t instanceof Ba||t instanceof vi),z(t=>t instanceof yi||t instanceof vi?Na.COMPLETE:(t instanceof Zn?t.code===Vt.Redirect||t.code===Vt.SupersededByNewNavigation:!1)?Na.REDIRECTING:Na.FAILED),gt(t=>t!==Na.REDIRECTING),Hn(1)).subscribe(()=>{e()})}function Bk(n){throw n}var Uk={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},$k={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},s0=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=$(Il),this.stateManager=$(o0),this.options=$(tm,{optional:!0})||{},this.pendingTasks=$(To),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=$(kk),this.urlSerializer=$(Jg),this.location=$(Ta),this.urlHandlingStrategy=$(im),this._events=new He,this.errorHandler=this.options.errorHandler||Bk,this.navigated=!1,this.routeReuseStrategy=$(Fk),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=$(rm,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!$(em,{optional:!0}),this.eventsSubscription=new Ue,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof Zn&&r.code!==Vt.Redirect&&r.code!==Vt.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof yi)this.navigated=!0;else if(r instanceof ko){let s=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=U({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||Ok(i.source)},s);this.scheduleNavigation(a,ka,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}qk(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),ka,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let c=U({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(nm),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=r,l=c?this.currentUrlTree.fragment:s,h=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":h=U(U({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let m=i?i.snapshot:this.routerState.snapshot.root;p=$C(m)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),p=this.currentUrlTree.root}return HC(p,t,h,l??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=La(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,ka,null,r)}navigate(t,r={skipLocationChange:!1}){return Hk(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=U({},Uk):r===!1?i=U({},$k):i=r,La(t))return TC(this.currentUrlTree,t,i);let o=this.parseUrl(t);return TC(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(t,r,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,l;s?(a=s.resolve,c=s.reject,l=s.promise):l=new Promise((p,m)=>{a=p,c=m});let h=this.pendingTasks.add();return jk(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(p=>Promise.reject(p))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Hk(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new X(4008,!1)}function qk(n){return!(n instanceof Ua)&&!(n instanceof ko)}var zk=new Q("");function a0(n,...e){return Np([{provide:rm,multi:!0,useValue:n},[],{provide:Oo,useFactory:Gk,deps:[s0]},{provide:ug,multi:!0,useFactory:Wk},e.map(t=>t.\u0275providers)])}function Gk(n){return n.routerState.root}function Wk(){let n=$(ui);return e=>{let t=n.get(hi);if(e!==t.components[0])return;let r=n.get(s0),i=n.get(Kk);n.get(Qk)===1&&r.initialNavigation(),n.get(Yk,null,ae.Optional)?.setUpPreloading(),n.get(zk,null,ae.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Kk=new Q("",{factory:()=>new He}),Qk=new Q("",{providedIn:"root",factory:()=>1});var Yk=new Q("");var u0=[];var Zk="firebase",Jk="10.14.1";fr(Zk,Jk,"app");var Vo=new Dr("ANGULARFIRE2_VERSION");var Xk=(n,e)=>{let t=e?[e]:Fw(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},_i=class{constructor(){return Xk(eO)}},eO="app-check";function om(){}var Hl=class{zone;delegate;constructor(e,t=bf){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i.runGuarded(()=>{e.apply(this,[s])})};return this.delegate.schedule(o,t,r)}},sm=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",om,{},om,om)),t.pipe(tt({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},ql=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Hl(Zone.current)),this.insideAngular=t.run(()=>new Hl(Zone.current,ea)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(F(Ae))};static \u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function tO(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function Nt(n){return nO(tO())(n)}function nO(n){return function(t){return t=t.lift(new sm(n.ngZone)),t.pipe(rn(n.outsideAngular),$t(n.insideAngular))}}var rO="firebase",iO="10.14.1";Rt.registerVersion(rO,iO,"app-compat");var oO=["ngOnDestroy"],d0=(n,e,t,r={})=>new Proxy(n,{get:(i,o)=>t.runOutsideAngular(()=>{if(n[o])return r?.spy?.get&&r.spy.get(o,n[o]),n[o];if(oO.indexOf(o)>-1)return()=>{};let s=e.toPromise().then(a=>{let c=a?.[o];return typeof c=="function"?c.bind(a):c?.then?c.then(l=>t.run(()=>l)):t.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>s[c],apply:(a,c,l)=>s.then(h=>{let p=h?.(...l);return r?.spy?.apply&&r.spy.apply(o,l,p),p})})})});var zl=class{constructor(e){return e}},jo=new Q("angularfire2.app.options"),Bo=new Q("angularfire2.app.name");function Qa(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let s=Rt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Rt.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(s.options)){let a=!!module.hot;sO("error",`${s.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new zl(s)}var sO=(n,...e)=>{dg()&&typeof console<"u"&&console[n](...e)},aO={provide:zl,useFactory:Qa,deps:[jo,Ae,[new ya,Bo]]},h0=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:jo,useValue:t},{provide:Bo,useValue:r}]}}constructor(t){Rt.registerVersion("angularfire",Vo.full,"core"),Rt.registerVersion("angularfire",Vo.full,"app-compat"),Rt.registerVersion("angular",JD.full,t.toString())}static \u0275fac=function(r){return new(r||n)(F(Qt))};static \u0275mod=Wn({type:n});static \u0275inj=Gn({providers:[aO]})}return n})();function Gl(n,e,t,r,i){let[,o,s]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(o)return uO(i,s)||(l0("error",`${e} was already initialized on the ${t} Firebase App with different settings.${cO?" You may need to reload as Firebase is not HMR aware.":""}`),l0("warn",{is:i,was:s})),o;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function uO(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var cO=typeof module<"u"&&!!module.hot,l0=(n,...e)=>{dg()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var hO=new Map,fO={activated:!1,tokenObservers:[]},pO={initialized:!1,enabled:!1};function dn(n){return hO.get(n)||Object.assign({},fO)}function y0(){return pO}var gO="https://content-firebaseappcheck.googleapis.com/v1";var mO="exchangeDebugToken",f0={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Jq=24*60*60*1e3;var um=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return R(this,null,function*(){this.stop();try{this.pending=new of,this.pending.promise.catch(t=>{}),yield yO(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new of,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function yO(n){return new Promise(e=>{setTimeout(e,n)})}var vO={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Tr=new kw("appCheck","AppCheck",vO);function v0(n){if(!dn(n).activated)throw Tr.create("use-before-activation",{appName:n.name})}function _0(r,i){return R(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let v=yield s.getHeartbeatsHeader();v&&(o["X-Firebase-Client"]=v)}let a={method:"POST",body:JSON.stringify(e),headers:o},c;try{c=yield fetch(n,a)}catch(v){throw Tr.create("fetch-network-error",{originalErrorMessage:v?.message})}if(c.status!==200)throw Tr.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(v){throw Tr.create("fetch-parse-error",{originalErrorMessage:v?.message})}let h=l.ttl.match(/^([\d.]+)(s)$/);if(!h||!h[2]||isNaN(Number(h[1])))throw Tr.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let p=Number(h[1])*1e3,m=Date.now();return{token:l.token,expireTimeMillis:m+p,issuedAtTimeMillis:m}})}function w0(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${gO}/projects/${t}/apps/${r}:${mO}?key=${i}`,body:{debug_token:e}}}var _O="firebase-app-check-database",wO=1,cm="firebase-app-check-store";var Wl=null;function IO(){return Wl||(Wl=new Promise((n,e)=>{try{let t=indexedDB.open(_O,wO);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(Tr.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(cm,{keyPath:"compositeKey"})}}}catch(t){e(Tr.create("storage-open",{originalErrorMessage:t?.message}))}}),Wl)}function EO(n,e){return DO(CO(n),e)}function DO(n,e){return R(this,null,function*(){let r=(yield IO()).transaction(cm,"readwrite"),o=r.objectStore(cm).put({compositeKey:n,value:e});return new Promise((s,a)=>{o.onsuccess=c=>{s()},r.onerror=c=>{var l;a(Tr.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function CO(n){return`${n.options.appId}-${n.name}`}var lm=new rc("@firebase/app-check");function am(n,e){return nc()?EO(n,e).catch(t=>{lm.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function I0(){return y0().enabled}function E0(){return R(this,null,function*(){let n=y0();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var TO={error:"UNKNOWN_ERROR"};function bO(n){return Mw.encodeString(JSON.stringify(n),!1)}function dm(n,e=!1){return R(this,null,function*(){let t=n.app;v0(t);let r=dn(t),i=r.token,o;if(i&&!Ya(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(Ya(c)?i=c:yield am(t,void 0))}if(!e&&i&&Ya(i))return{token:i.token};let s=!1;if(I0()){r.exchangeTokenPromise||(r.exchangeTokenPromise=_0(w0(t,yield E0()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),s=!0);let c=yield r.exchangeTokenPromise;return yield am(t,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),s=!0),i=yield dn(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?lm.warn(c.message):lm.error(c),o=c}let a;return i?o?Ya(i)?a={token:i.token,internalError:o}:a=g0(o):(a={token:i.token},r.token=i,yield am(t,i)):a=g0(o),s&&RO(t,a),a})}function SO(n){return R(this,null,function*(){let e=n.app;v0(e);let{provider:t}=dn(e);if(I0()){let r=yield E0(),{token:i}=yield _0(w0(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function AO(n,e,t,r){let{app:i}=n,o=dn(i),s={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&Ya(o.token)){let a=o.token;Promise.resolve().then(()=>{t({token:a.token}),p0(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>p0(n))}function D0(n,e){let t=dn(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function p0(n){let{app:e}=n,t=dn(e),r=t.tokenRefresher;r||(r=xO(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function xO(n){let{app:e}=n;return new um(()=>R(this,null,function*(){let t=dn(e),r;if(t.token?r=yield dm(n,!0):r=yield dm(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=dn(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},f0.RETRIAL_MIN_WAIT,f0.RETRIAL_MAX_WAIT)}function RO(n,e){let t=dn(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Ya(n){return n.expireTimeMillis-Date.now()>0}function g0(n){return{token:bO(TO),error:n}}var hm=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=dn(this.app);for(let t of e)D0(this.app,t.next);return Promise.resolve()}};function MO(n,e){return new hm(n,e)}function NO(n){return{getToken:e=>dm(n,e),getLimitedUseToken:()=>SO(n),addTokenListener:e=>AO(n,"INTERNAL",e),removeTokenListener:e=>D0(n.app,e)}}var PO="@firebase/app-check",kO="0.8.8";var OO="app-check",m0="app-check-internal";function FO(){Ys(new Yr(OO,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return MO(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(m0).initialize()})),Ys(new Yr(m0,n=>{let e=n.getProvider("app-check").getImmediate();return NO(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),fr(PO,kO)}FO();var LO=["localhost","0.0.0.0","127.0.0.1"],lz=typeof window<"u"&&LO.includes(window.location.hostname);var fm=new Q("angularfire2.auth.use-emulator"),pm=new Q("angularfire2.auth.settings"),gm=new Q("angularfire2.auth.tenant-id"),mm=new Q("angularfire2.auth.langugage-code"),ym=new Q("angularfire2.auth.use-device-language"),vm=new Q("angularfire.auth.persistence"),_m=(n,e,t,r,i,o,s,a)=>Gl(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let c=e.runOutsideAngular(()=>n.auth());if(t&&c.useEmulator(...t),r&&(c.tenantId=r),c.languageCode=i,o&&c.useDeviceLanguage(),s)for(let[l,h]of Object.entries(s))c.settings[l]=h;return a&&c.setPersistence(a),c},[t,r,i,o,s,a]),T0=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,o,s,a,c,l,h,p,m,v){let b=new He,M=J(void 0).pipe($t(s.outsideAngular),qe(()=>o.runOutsideAngular(()=>import("./chunk-DT56ZVVI.js"))),z(()=>Qa(t,o,r)),z(N=>_m(N,o,a,l,h,p,c,m)),bc({bufferSize:1,refCount:!1}));if(pi(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=J(null);else{M.pipe(Ht()).subscribe();let N=M.pipe(qe(O=>O.getRedirectResult().then(Y=>Y,()=>null)),Nt,bc({bufferSize:1,refCount:!1})),V=M.pipe(qe(O=>new fe(Y=>({unsubscribe:o.runOutsideAngular(()=>O.onAuthStateChanged(ee=>Y.next(ee),ee=>Y.error(ee),()=>Y.complete()))})))),H=M.pipe(qe(O=>new fe(Y=>({unsubscribe:o.runOutsideAngular(()=>O.onIdTokenChanged(ee=>Y.next(ee),ee=>Y.error(ee),()=>Y.complete()))}))));this.authState=N.pipe(Sc(V),rn(s.outsideAngular),$t(s.insideAngular)),this.user=N.pipe(Sc(H),rn(s.outsideAngular),$t(s.insideAngular)),this.idToken=this.user.pipe(qe(O=>O?Ce(O.getIdToken()):J(null))),this.idTokenResult=this.user.pipe(qe(O=>O?Ce(O.getIdTokenResult()):J(null))),this.credential=xf(N,b,this.authState.pipe(gt(O=>!O))).pipe(z(O=>O?.user?O:null),rn(s.outsideAngular),$t(s.insideAngular))}return d0(this,M,o,{spy:{apply:(N,V,H)=>{(N.startsWith("signIn")||N.startsWith("createUser"))&&H.then(O=>b.next(O))}}})}static \u0275fac=function(r){return new(r||n)(F(jo),F(Bo,8),F(Qt),F(Ae),F(ql),F(fm,8),F(pm,8),F(gm,8),F(mm,8),F(ym,8),F(vm,8),F(_i,8))};static \u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var b0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},S0={};var br,wm;(function(){var n;function e(I,y){function w(){}w.prototype=y.prototype,I.D=y.prototype,I.prototype=new w,I.prototype.constructor=I,I.C=function(E,D,T){for(var _=Array(arguments.length-2),Vn=2;Vn<arguments.length;Vn++)_[Vn-2]=arguments[Vn];return y.prototype[D].apply(E,_)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,y,w){w||(w=0);var E=Array(16);if(typeof y=="string")for(var D=0;16>D;++D)E[D]=y.charCodeAt(w++)|y.charCodeAt(w++)<<8|y.charCodeAt(w++)<<16|y.charCodeAt(w++)<<24;else for(D=0;16>D;++D)E[D]=y[w++]|y[w++]<<8|y[w++]<<16|y[w++]<<24;y=I.g[0],w=I.g[1],D=I.g[2];var T=I.g[3],_=y+(T^w&(D^T))+E[0]+3614090360&4294967295;y=w+(_<<7&4294967295|_>>>25),_=T+(D^y&(w^D))+E[1]+3905402710&4294967295,T=y+(_<<12&4294967295|_>>>20),_=D+(w^T&(y^w))+E[2]+606105819&4294967295,D=T+(_<<17&4294967295|_>>>15),_=w+(y^D&(T^y))+E[3]+3250441966&4294967295,w=D+(_<<22&4294967295|_>>>10),_=y+(T^w&(D^T))+E[4]+4118548399&4294967295,y=w+(_<<7&4294967295|_>>>25),_=T+(D^y&(w^D))+E[5]+1200080426&4294967295,T=y+(_<<12&4294967295|_>>>20),_=D+(w^T&(y^w))+E[6]+2821735955&4294967295,D=T+(_<<17&4294967295|_>>>15),_=w+(y^D&(T^y))+E[7]+4249261313&4294967295,w=D+(_<<22&4294967295|_>>>10),_=y+(T^w&(D^T))+E[8]+1770035416&4294967295,y=w+(_<<7&4294967295|_>>>25),_=T+(D^y&(w^D))+E[9]+2336552879&4294967295,T=y+(_<<12&4294967295|_>>>20),_=D+(w^T&(y^w))+E[10]+4294925233&4294967295,D=T+(_<<17&4294967295|_>>>15),_=w+(y^D&(T^y))+E[11]+2304563134&4294967295,w=D+(_<<22&4294967295|_>>>10),_=y+(T^w&(D^T))+E[12]+1804603682&4294967295,y=w+(_<<7&4294967295|_>>>25),_=T+(D^y&(w^D))+E[13]+4254626195&4294967295,T=y+(_<<12&4294967295|_>>>20),_=D+(w^T&(y^w))+E[14]+2792965006&4294967295,D=T+(_<<17&4294967295|_>>>15),_=w+(y^D&(T^y))+E[15]+1236535329&4294967295,w=D+(_<<22&4294967295|_>>>10),_=y+(D^T&(w^D))+E[1]+4129170786&4294967295,y=w+(_<<5&4294967295|_>>>27),_=T+(w^D&(y^w))+E[6]+3225465664&4294967295,T=y+(_<<9&4294967295|_>>>23),_=D+(y^w&(T^y))+E[11]+643717713&4294967295,D=T+(_<<14&4294967295|_>>>18),_=w+(T^y&(D^T))+E[0]+3921069994&4294967295,w=D+(_<<20&4294967295|_>>>12),_=y+(D^T&(w^D))+E[5]+3593408605&4294967295,y=w+(_<<5&4294967295|_>>>27),_=T+(w^D&(y^w))+E[10]+38016083&4294967295,T=y+(_<<9&4294967295|_>>>23),_=D+(y^w&(T^y))+E[15]+3634488961&4294967295,D=T+(_<<14&4294967295|_>>>18),_=w+(T^y&(D^T))+E[4]+3889429448&4294967295,w=D+(_<<20&4294967295|_>>>12),_=y+(D^T&(w^D))+E[9]+568446438&4294967295,y=w+(_<<5&4294967295|_>>>27),_=T+(w^D&(y^w))+E[14]+3275163606&4294967295,T=y+(_<<9&4294967295|_>>>23),_=D+(y^w&(T^y))+E[3]+4107603335&4294967295,D=T+(_<<14&4294967295|_>>>18),_=w+(T^y&(D^T))+E[8]+1163531501&4294967295,w=D+(_<<20&4294967295|_>>>12),_=y+(D^T&(w^D))+E[13]+2850285829&4294967295,y=w+(_<<5&4294967295|_>>>27),_=T+(w^D&(y^w))+E[2]+4243563512&4294967295,T=y+(_<<9&4294967295|_>>>23),_=D+(y^w&(T^y))+E[7]+1735328473&4294967295,D=T+(_<<14&4294967295|_>>>18),_=w+(T^y&(D^T))+E[12]+2368359562&4294967295,w=D+(_<<20&4294967295|_>>>12),_=y+(w^D^T)+E[5]+4294588738&4294967295,y=w+(_<<4&4294967295|_>>>28),_=T+(y^w^D)+E[8]+2272392833&4294967295,T=y+(_<<11&4294967295|_>>>21),_=D+(T^y^w)+E[11]+1839030562&4294967295,D=T+(_<<16&4294967295|_>>>16),_=w+(D^T^y)+E[14]+4259657740&4294967295,w=D+(_<<23&4294967295|_>>>9),_=y+(w^D^T)+E[1]+2763975236&4294967295,y=w+(_<<4&4294967295|_>>>28),_=T+(y^w^D)+E[4]+1272893353&4294967295,T=y+(_<<11&4294967295|_>>>21),_=D+(T^y^w)+E[7]+4139469664&4294967295,D=T+(_<<16&4294967295|_>>>16),_=w+(D^T^y)+E[10]+3200236656&4294967295,w=D+(_<<23&4294967295|_>>>9),_=y+(w^D^T)+E[13]+681279174&4294967295,y=w+(_<<4&4294967295|_>>>28),_=T+(y^w^D)+E[0]+3936430074&4294967295,T=y+(_<<11&4294967295|_>>>21),_=D+(T^y^w)+E[3]+3572445317&4294967295,D=T+(_<<16&4294967295|_>>>16),_=w+(D^T^y)+E[6]+76029189&4294967295,w=D+(_<<23&4294967295|_>>>9),_=y+(w^D^T)+E[9]+3654602809&4294967295,y=w+(_<<4&4294967295|_>>>28),_=T+(y^w^D)+E[12]+3873151461&4294967295,T=y+(_<<11&4294967295|_>>>21),_=D+(T^y^w)+E[15]+530742520&4294967295,D=T+(_<<16&4294967295|_>>>16),_=w+(D^T^y)+E[2]+3299628645&4294967295,w=D+(_<<23&4294967295|_>>>9),_=y+(D^(w|~T))+E[0]+4096336452&4294967295,y=w+(_<<6&4294967295|_>>>26),_=T+(w^(y|~D))+E[7]+1126891415&4294967295,T=y+(_<<10&4294967295|_>>>22),_=D+(y^(T|~w))+E[14]+2878612391&4294967295,D=T+(_<<15&4294967295|_>>>17),_=w+(T^(D|~y))+E[5]+4237533241&4294967295,w=D+(_<<21&4294967295|_>>>11),_=y+(D^(w|~T))+E[12]+1700485571&4294967295,y=w+(_<<6&4294967295|_>>>26),_=T+(w^(y|~D))+E[3]+2399980690&4294967295,T=y+(_<<10&4294967295|_>>>22),_=D+(y^(T|~w))+E[10]+4293915773&4294967295,D=T+(_<<15&4294967295|_>>>17),_=w+(T^(D|~y))+E[1]+2240044497&4294967295,w=D+(_<<21&4294967295|_>>>11),_=y+(D^(w|~T))+E[8]+1873313359&4294967295,y=w+(_<<6&4294967295|_>>>26),_=T+(w^(y|~D))+E[15]+4264355552&4294967295,T=y+(_<<10&4294967295|_>>>22),_=D+(y^(T|~w))+E[6]+2734768916&4294967295,D=T+(_<<15&4294967295|_>>>17),_=w+(T^(D|~y))+E[13]+1309151649&4294967295,w=D+(_<<21&4294967295|_>>>11),_=y+(D^(w|~T))+E[4]+4149444226&4294967295,y=w+(_<<6&4294967295|_>>>26),_=T+(w^(y|~D))+E[11]+3174756917&4294967295,T=y+(_<<10&4294967295|_>>>22),_=D+(y^(T|~w))+E[2]+718787259&4294967295,D=T+(_<<15&4294967295|_>>>17),_=w+(T^(D|~y))+E[9]+3951481745&4294967295,I.g[0]=I.g[0]+y&4294967295,I.g[1]=I.g[1]+(D+(_<<21&4294967295|_>>>11))&4294967295,I.g[2]=I.g[2]+D&4294967295,I.g[3]=I.g[3]+T&4294967295}r.prototype.u=function(I,y){y===void 0&&(y=I.length);for(var w=y-this.blockSize,E=this.B,D=this.h,T=0;T<y;){if(D==0)for(;T<=w;)i(this,I,T),T+=this.blockSize;if(typeof I=="string"){for(;T<y;)if(E[D++]=I.charCodeAt(T++),D==this.blockSize){i(this,E),D=0;break}}else for(;T<y;)if(E[D++]=I[T++],D==this.blockSize){i(this,E),D=0;break}}this.h=D,this.o+=y},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var y=1;y<I.length-8;++y)I[y]=0;var w=8*this.o;for(y=I.length-8;y<I.length;++y)I[y]=w&255,w/=256;for(this.u(I),I=Array(16),y=w=0;4>y;++y)for(var E=0;32>E;E+=8)I[w++]=this.g[y]>>>E&255;return I};function o(I,y){var w=a;return Object.prototype.hasOwnProperty.call(w,I)?w[I]:w[I]=y(I)}function s(I,y){this.h=y;for(var w=[],E=!0,D=I.length-1;0<=D;D--){var T=I[D]|0;E&&T==y||(w[D]=T,E=!1)}this.g=w}var a={};function c(I){return-128<=I&&128>I?o(I,function(y){return new s([y|0],0>y?-1:0)}):new s([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return p;if(0>I)return N(l(-I));for(var y=[],w=1,E=0;I>=w;E++)y[E]=I/w|0,w*=4294967296;return new s(y,0)}function h(I,y){if(I.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(I.charAt(0)=="-")return N(h(I.substring(1),y));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=l(Math.pow(y,8)),E=p,D=0;D<I.length;D+=8){var T=Math.min(8,I.length-D),_=parseInt(I.substring(D,D+T),y);8>T?(T=l(Math.pow(y,T)),E=E.j(T).add(l(_))):(E=E.j(w),E=E.add(l(_)))}return E}var p=c(0),m=c(1),v=c(16777216);n=s.prototype,n.m=function(){if(M(this))return-N(this).m();for(var I=0,y=1,w=0;w<this.g.length;w++){var E=this.i(w);I+=(0<=E?E:4294967296+E)*y,y*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(b(this))return"0";if(M(this))return"-"+N(this).toString(I);for(var y=l(Math.pow(I,6)),w=this,E="";;){var D=Y(w,y).g;w=V(w,D.j(y));var T=((0<w.g.length?w.g[0]:w.h)>>>0).toString(I);if(w=D,b(w))return T+E;for(;6>T.length;)T="0"+T;E=T+E}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function b(I){if(I.h!=0)return!1;for(var y=0;y<I.g.length;y++)if(I.g[y]!=0)return!1;return!0}function M(I){return I.h==-1}n.l=function(I){return I=V(this,I),M(I)?-1:b(I)?0:1};function N(I){for(var y=I.g.length,w=[],E=0;E<y;E++)w[E]=~I.g[E];return new s(w,~I.h).add(m)}n.abs=function(){return M(this)?N(this):this},n.add=function(I){for(var y=Math.max(this.g.length,I.g.length),w=[],E=0,D=0;D<=y;D++){var T=E+(this.i(D)&65535)+(I.i(D)&65535),_=(T>>>16)+(this.i(D)>>>16)+(I.i(D)>>>16);E=_>>>16,T&=65535,_&=65535,w[D]=_<<16|T}return new s(w,w[w.length-1]&-2147483648?-1:0)};function V(I,y){return I.add(N(y))}n.j=function(I){if(b(this)||b(I))return p;if(M(this))return M(I)?N(this).j(N(I)):N(N(this).j(I));if(M(I))return N(this.j(N(I)));if(0>this.l(v)&&0>I.l(v))return l(this.m()*I.m());for(var y=this.g.length+I.g.length,w=[],E=0;E<2*y;E++)w[E]=0;for(E=0;E<this.g.length;E++)for(var D=0;D<I.g.length;D++){var T=this.i(E)>>>16,_=this.i(E)&65535,Vn=I.i(D)>>>16,Rs=I.i(D)&65535;w[2*E+2*D]+=_*Rs,H(w,2*E+2*D),w[2*E+2*D+1]+=T*Rs,H(w,2*E+2*D+1),w[2*E+2*D+1]+=_*Vn,H(w,2*E+2*D+1),w[2*E+2*D+2]+=T*Vn,H(w,2*E+2*D+2)}for(E=0;E<y;E++)w[E]=w[2*E+1]<<16|w[2*E];for(E=y;E<2*y;E++)w[E]=0;return new s(w,0)};function H(I,y){for(;(I[y]&65535)!=I[y];)I[y+1]+=I[y]>>>16,I[y]&=65535,y++}function O(I,y){this.g=I,this.h=y}function Y(I,y){if(b(y))throw Error("division by zero");if(b(I))return new O(p,p);if(M(I))return y=Y(N(I),y),new O(N(y.g),N(y.h));if(M(y))return y=Y(I,N(y)),new O(N(y.g),y.h);if(30<I.g.length){if(M(I)||M(y))throw Error("slowDivide_ only works with positive integers.");for(var w=m,E=y;0>=E.l(I);)w=ee(w),E=ee(E);var D=Z(w,1),T=Z(E,1);for(E=Z(E,2),w=Z(w,2);!b(E);){var _=T.add(E);0>=_.l(I)&&(D=D.add(w),T=_),E=Z(E,1),w=Z(w,1)}return y=V(I,D.j(y)),new O(D,y)}for(D=p;0<=I.l(y);){for(w=Math.max(1,Math.floor(I.m()/y.m())),E=Math.ceil(Math.log(w)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),T=l(w),_=T.j(y);M(_)||0<_.l(I);)w-=E,T=l(w),_=T.j(y);b(T)&&(T=m),D=D.add(T),I=V(I,_)}return new O(D,I)}n.A=function(I){return Y(this,I).h},n.and=function(I){for(var y=Math.max(this.g.length,I.g.length),w=[],E=0;E<y;E++)w[E]=this.i(E)&I.i(E);return new s(w,this.h&I.h)},n.or=function(I){for(var y=Math.max(this.g.length,I.g.length),w=[],E=0;E<y;E++)w[E]=this.i(E)|I.i(E);return new s(w,this.h|I.h)},n.xor=function(I){for(var y=Math.max(this.g.length,I.g.length),w=[],E=0;E<y;E++)w[E]=this.i(E)^I.i(E);return new s(w,this.h^I.h)};function ee(I){for(var y=I.g.length+1,w=[],E=0;E<y;E++)w[E]=I.i(E)<<1|I.i(E-1)>>>31;return new s(w,I.h)}function Z(I,y){var w=y>>5;y%=32;for(var E=I.g.length-w,D=[],T=0;T<E;T++)D[T]=0<y?I.i(T+w)>>>y|I.i(T+w+1)<<32-y:I.i(T+w);return new s(D,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,wm=S0.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=h,br=S0.Integer=s}).apply(typeof b0<"u"?b0:typeof self<"u"?self:typeof window<"u"?window:{});var Kl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xn={};var Im,jO,Uo,Em,Za,Ql,Dm,Cm,Tm;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,d,f){return u==Array.prototype||u==Object.prototype||(u[d]=f.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Kl=="object"&&Kl];for(var d=0;d<u.length;++d){var f=u[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(u,d){if(d)e:{var f=r;u=u.split(".");for(var g=0;g<u.length-1;g++){var C=u[g];if(!(C in f))break e;f=f[C]}u=u[u.length-1],g=f[u],d=d(g),d!=g&&d!=null&&e(f,u,{configurable:!0,writable:!0,value:d})}}function o(u,d){u instanceof String&&(u+="");var f=0,g=!1,C={next:function(){if(!g&&f<u.length){var A=f++;return{value:d(A,u[A]),done:!1}}return g=!0,{done:!0,value:void 0}}};return C[Symbol.iterator]=function(){return C},C}i("Array.prototype.values",function(u){return u||function(){return o(this,function(d,f){return f})}});var s=s||{},a=this||self;function c(u){var d=typeof u;return d=d!="object"?d:u?Array.isArray(u)?"array":d:"null",d=="array"||d=="object"&&typeof u.length=="number"}function l(u){var d=typeof u;return d=="object"&&u!=null||d=="function"}function h(u,d,f){return u.call.apply(u.bind,arguments)}function p(u,d,f){if(!u)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var C=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(C,g),u.apply(d,C)}}return function(){return u.apply(d,arguments)}}function m(u,d,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,m.apply(null,arguments)}function v(u,d){var f=Array.prototype.slice.call(arguments,1);return function(){var g=f.slice();return g.push.apply(g,arguments),u.apply(this,g)}}function b(u,d){function f(){}f.prototype=d.prototype,u.aa=d.prototype,u.prototype=new f,u.prototype.constructor=u,u.Qb=function(g,C,A){for(var L=Array(arguments.length-2),Se=2;Se<arguments.length;Se++)L[Se-2]=arguments[Se];return d.prototype[C].apply(g,L)}}function M(u){let d=u.length;if(0<d){let f=Array(d);for(let g=0;g<d;g++)f[g]=u[g];return f}return[]}function N(u,d){for(let f=1;f<arguments.length;f++){let g=arguments[f];if(c(g)){let C=u.length||0,A=g.length||0;u.length=C+A;for(let L=0;L<A;L++)u[C+L]=g[L]}else u.push(g)}}class V{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function H(u){return/^[\s\xa0]*$/.test(u)}function O(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function Y(u){return Y[" "](u),u}Y[" "]=function(){};var ee=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function Z(u,d,f){for(let g in u)d.call(f,u[g],g,u)}function I(u,d){for(let f in u)d.call(void 0,u[f],f,u)}function y(u){let d={};for(let f in u)d[f]=u[f];return d}let w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(u,d){let f,g;for(let C=1;C<arguments.length;C++){g=arguments[C];for(f in g)u[f]=g[f];for(let A=0;A<w.length;A++)f=w[A],Object.prototype.hasOwnProperty.call(g,f)&&(u[f]=g[f])}}function D(u){var d=1;u=u.split(":");let f=[];for(;0<d&&u.length;)f.push(u.shift()),d--;return u.length&&f.push(u.join(":")),f}function T(u){a.setTimeout(()=>{throw u},0)}function _(){var u=Nh;let d=null;return u.g&&(d=u.g,u.g=u.g.next,u.g||(u.h=null),d.next=null),d}class Vn{constructor(){this.h=this.g=null}add(d,f){let g=Rs.get();g.set(d,f),this.h?this.h.next=g:this.g=g,this.h=g}}var Rs=new V(()=>new lA,u=>u.reset());class lA{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Ms,Ns=!1,Nh=new Vn,S_=()=>{let u=a.Promise.resolve(void 0);Ms=()=>{u.then(dA)}};var dA=()=>{for(var u;u=_();){try{u.h.call(u.g)}catch(f){T(f)}var d=Rs;d.j(u),100>d.h&&(d.h++,u.next=d.g,d.g=u)}Ns=!1};function cr(){this.s=this.s,this.C=this.C}cr.prototype.s=!1,cr.prototype.ma=function(){this.s||(this.s=!0,this.N())},cr.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function dt(u,d){this.type=u,this.g=this.target=d,this.defaultPrevented=!1}dt.prototype.h=function(){this.defaultPrevented=!0};var hA=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,d=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let f=()=>{};a.addEventListener("test",f,d),a.removeEventListener("test",f,d)}catch{}return u}();function Ps(u,d){if(dt.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var f=this.type=u.type,g=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=d,d=u.relatedTarget){if(ee){e:{try{Y(d.nodeName);var C=!0;break e}catch{}C=!1}C||(d=null)}}else f=="mouseover"?d=u.fromElement:f=="mouseout"&&(d=u.toElement);this.relatedTarget=d,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:fA[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Ps.aa.h.call(this)}}b(Ps,dt);var fA={2:"touch",3:"pen",4:"mouse"};Ps.prototype.h=function(){Ps.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var ks="closure_listenable_"+(1e6*Math.random()|0),pA=0;function gA(u,d,f,g,C){this.listener=u,this.proxy=null,this.src=d,this.type=f,this.capture=!!g,this.ha=C,this.key=++pA,this.da=this.fa=!1}function Vu(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ju(u){this.src=u,this.g={},this.h=0}ju.prototype.add=function(u,d,f,g,C){var A=u.toString();u=this.g[A],u||(u=this.g[A]=[],this.h++);var L=kh(u,d,g,C);return-1<L?(d=u[L],f||(d.fa=!1)):(d=new gA(d,this.src,A,!!g,C),d.fa=f,u.push(d)),d};function Ph(u,d){var f=d.type;if(f in u.g){var g=u.g[f],C=Array.prototype.indexOf.call(g,d,void 0),A;(A=0<=C)&&Array.prototype.splice.call(g,C,1),A&&(Vu(d),u.g[f].length==0&&(delete u.g[f],u.h--))}}function kh(u,d,f,g){for(var C=0;C<u.length;++C){var A=u[C];if(!A.da&&A.listener==d&&A.capture==!!f&&A.ha==g)return C}return-1}var Oh="closure_lm_"+(1e6*Math.random()|0),Fh={};function A_(u,d,f,g,C){if(g&&g.once)return R_(u,d,f,g,C);if(Array.isArray(d)){for(var A=0;A<d.length;A++)A_(u,d[A],f,g,C);return null}return f=Bh(f),u&&u[ks]?u.K(d,f,l(g)?!!g.capture:!!g,C):x_(u,d,f,!1,g,C)}function x_(u,d,f,g,C,A){if(!d)throw Error("Invalid event type");var L=l(C)?!!C.capture:!!C,Se=Vh(u);if(Se||(u[Oh]=Se=new ju(u)),f=Se.add(d,f,g,L,A),f.proxy)return f;if(g=mA(),f.proxy=g,g.src=u,g.listener=f,u.addEventListener)hA||(C=L),C===void 0&&(C=!1),u.addEventListener(d.toString(),g,C);else if(u.attachEvent)u.attachEvent(N_(d.toString()),g);else if(u.addListener&&u.removeListener)u.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return f}function mA(){function u(f){return d.call(u.src,u.listener,f)}let d=yA;return u}function R_(u,d,f,g,C){if(Array.isArray(d)){for(var A=0;A<d.length;A++)R_(u,d[A],f,g,C);return null}return f=Bh(f),u&&u[ks]?u.L(d,f,l(g)?!!g.capture:!!g,C):x_(u,d,f,!0,g,C)}function M_(u,d,f,g,C){if(Array.isArray(d))for(var A=0;A<d.length;A++)M_(u,d[A],f,g,C);else g=l(g)?!!g.capture:!!g,f=Bh(f),u&&u[ks]?(u=u.i,d=String(d).toString(),d in u.g&&(A=u.g[d],f=kh(A,f,g,C),-1<f&&(Vu(A[f]),Array.prototype.splice.call(A,f,1),A.length==0&&(delete u.g[d],u.h--)))):u&&(u=Vh(u))&&(d=u.g[d.toString()],u=-1,d&&(u=kh(d,f,g,C)),(f=-1<u?d[u]:null)&&Lh(f))}function Lh(u){if(typeof u!="number"&&u&&!u.da){var d=u.src;if(d&&d[ks])Ph(d.i,u);else{var f=u.type,g=u.proxy;d.removeEventListener?d.removeEventListener(f,g,u.capture):d.detachEvent?d.detachEvent(N_(f),g):d.addListener&&d.removeListener&&d.removeListener(g),(f=Vh(d))?(Ph(f,u),f.h==0&&(f.src=null,d[Oh]=null)):Vu(u)}}}function N_(u){return u in Fh?Fh[u]:Fh[u]="on"+u}function yA(u,d){if(u.da)u=!0;else{d=new Ps(d,this);var f=u.listener,g=u.ha||u.src;u.fa&&Lh(u),u=f.call(g,d)}return u}function Vh(u){return u=u[Oh],u instanceof ju?u:null}var jh="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bh(u){return typeof u=="function"?u:(u[jh]||(u[jh]=function(d){return u.handleEvent(d)}),u[jh])}function ht(){cr.call(this),this.i=new ju(this),this.M=this,this.F=null}b(ht,cr),ht.prototype[ks]=!0,ht.prototype.removeEventListener=function(u,d,f,g){M_(this,u,d,f,g)};function wt(u,d){var f,g=u.F;if(g)for(f=[];g;g=g.F)f.push(g);if(u=u.M,g=d.type||d,typeof d=="string")d=new dt(d,u);else if(d instanceof dt)d.target=d.target||u;else{var C=d;d=new dt(g,u),E(d,C)}if(C=!0,f)for(var A=f.length-1;0<=A;A--){var L=d.g=f[A];C=Bu(L,g,!0,d)&&C}if(L=d.g=u,C=Bu(L,g,!0,d)&&C,C=Bu(L,g,!1,d)&&C,f)for(A=0;A<f.length;A++)L=d.g=f[A],C=Bu(L,g,!1,d)&&C}ht.prototype.N=function(){if(ht.aa.N.call(this),this.i){var u=this.i,d;for(d in u.g){for(var f=u.g[d],g=0;g<f.length;g++)Vu(f[g]);delete u.g[d],u.h--}}this.F=null},ht.prototype.K=function(u,d,f,g){return this.i.add(String(u),d,!1,f,g)},ht.prototype.L=function(u,d,f,g){return this.i.add(String(u),d,!0,f,g)};function Bu(u,d,f,g){if(d=u.i.g[String(d)],!d)return!0;d=d.concat();for(var C=!0,A=0;A<d.length;++A){var L=d[A];if(L&&!L.da&&L.capture==f){var Se=L.listener,st=L.ha||L.src;L.fa&&Ph(u.i,L),C=Se.call(st,g)!==!1&&C}}return C&&!g.defaultPrevented}function P_(u,d,f){if(typeof u=="function")f&&(u=m(u,f));else if(u&&typeof u.handleEvent=="function")u=m(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:a.setTimeout(u,d||0)}function k_(u){u.g=P_(()=>{u.g=null,u.i&&(u.i=!1,k_(u))},u.l);let d=u.h;u.h=null,u.m.apply(null,d)}class vA extends cr{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:k_(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Os(u){cr.call(this),this.h=u,this.g={}}b(Os,cr);var O_=[];function F_(u){Z(u.g,function(d,f){this.g.hasOwnProperty(f)&&Lh(d)},u),u.g={}}Os.prototype.N=function(){Os.aa.N.call(this),F_(this)},Os.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Uh=a.JSON.stringify,_A=a.JSON.parse,wA=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function $h(){}$h.prototype.h=null;function L_(u){return u.h||(u.h=u.i())}function V_(){}var Fs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Hh(){dt.call(this,"d")}b(Hh,dt);function qh(){dt.call(this,"c")}b(qh,dt);var Gr={},j_=null;function Uu(){return j_=j_||new ht}Gr.La="serverreachability";function B_(u){dt.call(this,Gr.La,u)}b(B_,dt);function Ls(u){let d=Uu();wt(d,new B_(d))}Gr.STAT_EVENT="statevent";function U_(u,d){dt.call(this,Gr.STAT_EVENT,u),this.stat=d}b(U_,dt);function It(u){let d=Uu();wt(d,new U_(d,u))}Gr.Ma="timingevent";function $_(u,d){dt.call(this,Gr.Ma,u),this.size=d}b($_,dt);function Vs(u,d){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},d)}function js(){this.g=!0}js.prototype.xa=function(){this.g=!1};function IA(u,d,f,g,C,A){u.info(function(){if(u.g)if(A)for(var L="",Se=A.split("&"),st=0;st<Se.length;st++){var we=Se[st].split("=");if(1<we.length){var ft=we[0];we=we[1];var pt=ft.split("_");L=2<=pt.length&&pt[1]=="type"?L+(ft+"="+we+"&"):L+(ft+"=redacted&")}}else L=null;else L=A;return"XMLHTTP REQ ("+g+") [attempt "+C+"]: "+d+`
`+f+`
`+L})}function EA(u,d,f,g,C,A,L){u.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+C+"]: "+d+`
`+f+`
`+A+" "+L})}function Gi(u,d,f,g){u.info(function(){return"XMLHTTP TEXT ("+d+"): "+CA(u,f)+(g?" "+g:"")})}function DA(u,d){u.info(function(){return"TIMEOUT: "+d})}js.prototype.info=function(){};function CA(u,d){if(!u.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(u=0;u<f.length;u++)if(Array.isArray(f[u])){var g=f[u];if(!(2>g.length)){var C=g[1];if(Array.isArray(C)&&!(1>C.length)){var A=C[0];if(A!="noop"&&A!="stop"&&A!="close")for(var L=1;L<C.length;L++)C[L]=""}}}}return Uh(f)}catch{return d}}var $u={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},H_={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},zh;function Hu(){}b(Hu,$h),Hu.prototype.g=function(){return new XMLHttpRequest},Hu.prototype.i=function(){return{}},zh=new Hu;function lr(u,d,f,g){this.j=u,this.i=d,this.l=f,this.R=g||1,this.U=new Os(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new q_}function q_(){this.i=null,this.g="",this.h=!1}var z_={},Gh={};function Wh(u,d,f){u.L=1,u.v=Wu(jn(d)),u.m=f,u.P=!0,G_(u,null)}function G_(u,d){u.F=Date.now(),qu(u),u.A=jn(u.v);var f=u.A,g=u.R;Array.isArray(g)||(g=[String(g)]),sw(f.i,"t",g),u.C=0,f=u.j.J,u.h=new q_,u.g=Cw(u.j,f?d:null,!u.m),0<u.O&&(u.M=new vA(m(u.Y,u,u.g),u.O)),d=u.U,f=u.g,g=u.ca;var C="readystatechange";Array.isArray(C)||(C&&(O_[0]=C.toString()),C=O_);for(var A=0;A<C.length;A++){var L=A_(f,C[A],g||d.handleEvent,!1,d.h||d);if(!L)break;d.g[L.key]=L}d=u.H?y(u.H):{},u.m?(u.u||(u.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,d)):(u.u="GET",u.g.ea(u.A,u.u,null,d)),Ls(),IA(u.i,u.u,u.A,u.l,u.R,u.m)}lr.prototype.ca=function(u){u=u.target;let d=this.M;d&&Bn(u)==3?d.j():this.Y(u)},lr.prototype.Y=function(u){try{if(u==this.g)e:{let pt=Bn(this.g);var d=this.g.Ba();let Qi=this.g.Z();if(!(3>pt)&&(pt!=3||this.g&&(this.h.h||this.g.oa()||fw(this.g)))){this.J||pt!=4||d==7||(d==8||0>=Qi?Ls(3):Ls(2)),Kh(this);var f=this.g.Z();this.X=f;t:if(W_(this)){var g=fw(this.g);u="";var C=g.length,A=Bn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Wr(this),Bs(this);var L="";break t}this.h.i=new a.TextDecoder}for(d=0;d<C;d++)this.h.h=!0,u+=this.h.i.decode(g[d],{stream:!(A&&d==C-1)});g.length=0,this.h.g+=u,this.C=0,L=this.h.g}else L=this.g.oa();if(this.o=f==200,EA(this.i,this.u,this.A,this.l,this.R,pt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Se,st=this.g;if((Se=st.g?st.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(Se)){var we=Se;break t}}we=null}if(f=we)Gi(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qh(this,f);else{this.o=!1,this.s=3,It(12),Wr(this),Bs(this);break e}}if(this.P){f=!0;let tn;for(;!this.J&&this.C<L.length;)if(tn=TA(this,L),tn==Gh){pt==4&&(this.s=4,It(14),f=!1),Gi(this.i,this.l,null,"[Incomplete Response]");break}else if(tn==z_){this.s=4,It(15),Gi(this.i,this.l,L,"[Invalid Chunk]"),f=!1;break}else Gi(this.i,this.l,tn,null),Qh(this,tn);if(W_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pt!=4||L.length!=0||this.h.h||(this.s=1,It(16),f=!1),this.o=this.o&&f,!f)Gi(this.i,this.l,L,"[Invalid Chunked Response]"),Wr(this),Bs(this);else if(0<L.length&&!this.W){this.W=!0;var ft=this.j;ft.g==this&&ft.ba&&!ft.M&&(ft.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),tf(ft),ft.M=!0,It(11))}}else Gi(this.i,this.l,L,null),Qh(this,L);pt==4&&Wr(this),this.o&&!this.J&&(pt==4?ww(this.j,this):(this.o=!1,qu(this)))}else $A(this.g),f==400&&0<L.indexOf("Unknown SID")?(this.s=3,It(12)):(this.s=0,It(13)),Wr(this),Bs(this)}}}catch{}finally{}};function W_(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function TA(u,d){var f=u.C,g=d.indexOf(`
`,f);return g==-1?Gh:(f=Number(d.substring(f,g)),isNaN(f)?z_:(g+=1,g+f>d.length?Gh:(d=d.slice(g,g+f),u.C=g+f,d)))}lr.prototype.cancel=function(){this.J=!0,Wr(this)};function qu(u){u.S=Date.now()+u.I,K_(u,u.I)}function K_(u,d){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Vs(m(u.ba,u),d)}function Kh(u){u.B&&(a.clearTimeout(u.B),u.B=null)}lr.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(DA(this.i,this.A),this.L!=2&&(Ls(),It(17)),Wr(this),this.s=2,Bs(this)):K_(this,this.S-u)};function Bs(u){u.j.G==0||u.J||ww(u.j,u)}function Wr(u){Kh(u);var d=u.M;d&&typeof d.ma=="function"&&d.ma(),u.M=null,F_(u.U),u.g&&(d=u.g,u.g=null,d.abort(),d.ma())}function Qh(u,d){try{var f=u.j;if(f.G!=0&&(f.g==u||Yh(f.h,u))){if(!u.K&&Yh(f.h,u)&&f.G==3){try{var g=f.Da.g.parse(d)}catch{g=null}if(Array.isArray(g)&&g.length==3){var C=g;if(C[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<u.F)Ju(f),Yu(f);else break e;ef(f),It(18)}}else f.za=C[1],0<f.za-f.T&&37500>C[2]&&f.F&&f.v==0&&!f.C&&(f.C=Vs(m(f.Za,f),6e3));if(1>=Z_(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Qr(f,11)}else if((u.K||f.g==u)&&Ju(f),!H(d))for(C=f.Da.g.parse(d),d=0;d<C.length;d++){let we=C[d];if(f.T=we[0],we=we[1],f.G==2)if(we[0]=="c"){f.K=we[1],f.ia=we[2];let ft=we[3];ft!=null&&(f.la=ft,f.j.info("VER="+f.la));let pt=we[4];pt!=null&&(f.Aa=pt,f.j.info("SVER="+f.Aa));let Qi=we[5];Qi!=null&&typeof Qi=="number"&&0<Qi&&(g=1.5*Qi,f.L=g,f.j.info("backChannelRequestTimeoutMs_="+g)),g=f;let tn=u.g;if(tn){let ec=tn.g?tn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ec){var A=g.h;A.g||ec.indexOf("spdy")==-1&&ec.indexOf("quic")==-1&&ec.indexOf("h2")==-1||(A.j=A.l,A.g=new Set,A.h&&(Zh(A,A.h),A.h=null))}if(g.D){let nf=tn.g?tn.g.getResponseHeader("X-HTTP-Session-Id"):null;nf&&(g.ya=nf,Ne(g.I,g.D,nf))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-u.F,f.j.info("Handshake RTT: "+f.R+"ms")),g=f;var L=u;if(g.qa=Dw(g,g.J?g.ia:null,g.W),L.K){J_(g.h,L);var Se=L,st=g.L;st&&(Se.I=st),Se.B&&(Kh(Se),qu(Se)),g.g=L}else vw(g);0<f.i.length&&Zu(f)}else we[0]!="stop"&&we[0]!="close"||Qr(f,7);else f.G==3&&(we[0]=="stop"||we[0]=="close"?we[0]=="stop"?Qr(f,7):Xh(f):we[0]!="noop"&&f.l&&f.l.ta(we),f.v=0)}}Ls(4)}catch{}}var bA=class{constructor(u,d){this.g=u,this.map=d}};function Q_(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Y_(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Z_(u){return u.h?1:u.g?u.g.size:0}function Yh(u,d){return u.h?u.h==d:u.g?u.g.has(d):!1}function Zh(u,d){u.g?u.g.add(d):u.h=d}function J_(u,d){u.h&&u.h==d?u.h=null:u.g&&u.g.has(d)&&u.g.delete(d)}Q_.prototype.cancel=function(){if(this.i=X_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function X_(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let d=u.i;for(let f of u.g.values())d=d.concat(f.D);return d}return M(u.i)}function SA(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var d=[],f=u.length,g=0;g<f;g++)d.push(u[g]);return d}d=[],f=0;for(g in u)d[f++]=u[g];return d}function AA(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var d=[];u=u.length;for(var f=0;f<u;f++)d.push(f);return d}d=[],f=0;for(let g in u)d[f++]=g;return d}}}function ew(u,d){if(u.forEach&&typeof u.forEach=="function")u.forEach(d,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,d,void 0);else for(var f=AA(u),g=SA(u),C=g.length,A=0;A<C;A++)d.call(void 0,g[A],f&&f[A],u)}var tw=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function xA(u,d){if(u){u=u.split("&");for(var f=0;f<u.length;f++){var g=u[f].indexOf("="),C=null;if(0<=g){var A=u[f].substring(0,g);C=u[f].substring(g+1)}else A=u[f];d(A,C?decodeURIComponent(C.replace(/\+/g," ")):"")}}}function Kr(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Kr){this.h=u.h,zu(this,u.j),this.o=u.o,this.g=u.g,Gu(this,u.s),this.l=u.l;var d=u.i,f=new Hs;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),nw(this,f),this.m=u.m}else u&&(d=String(u).match(tw))?(this.h=!1,zu(this,d[1]||"",!0),this.o=Us(d[2]||""),this.g=Us(d[3]||"",!0),Gu(this,d[4]),this.l=Us(d[5]||"",!0),nw(this,d[6]||"",!0),this.m=Us(d[7]||"")):(this.h=!1,this.i=new Hs(null,this.h))}Kr.prototype.toString=function(){var u=[],d=this.j;d&&u.push($s(d,rw,!0),":");var f=this.g;return(f||d=="file")&&(u.push("//"),(d=this.o)&&u.push($s(d,rw,!0),"@"),u.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&u.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&u.push("/"),u.push($s(f,f.charAt(0)=="/"?NA:MA,!0))),(f=this.i.toString())&&u.push("?",f),(f=this.m)&&u.push("#",$s(f,kA)),u.join("")};function jn(u){return new Kr(u)}function zu(u,d,f){u.j=f?Us(d,!0):d,u.j&&(u.j=u.j.replace(/:$/,""))}function Gu(u,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);u.s=d}else u.s=null}function nw(u,d,f){d instanceof Hs?(u.i=d,OA(u.i,u.h)):(f||(d=$s(d,PA)),u.i=new Hs(d,u.h))}function Ne(u,d,f){u.i.set(d,f)}function Wu(u){return Ne(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Us(u,d){return u?d?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function $s(u,d,f){return typeof u=="string"?(u=encodeURI(u).replace(d,RA),f&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function RA(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var rw=/[#\/\?@]/g,MA=/[#\?:]/g,NA=/[#\?]/g,PA=/[#\?@]/g,kA=/#/g;function Hs(u,d){this.h=this.g=null,this.i=u||null,this.j=!!d}function dr(u){u.g||(u.g=new Map,u.h=0,u.i&&xA(u.i,function(d,f){u.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}n=Hs.prototype,n.add=function(u,d){dr(this),this.i=null,u=Wi(this,u);var f=this.g.get(u);return f||this.g.set(u,f=[]),f.push(d),this.h+=1,this};function iw(u,d){dr(u),d=Wi(u,d),u.g.has(d)&&(u.i=null,u.h-=u.g.get(d).length,u.g.delete(d))}function ow(u,d){return dr(u),d=Wi(u,d),u.g.has(d)}n.forEach=function(u,d){dr(this),this.g.forEach(function(f,g){f.forEach(function(C){u.call(d,C,g,this)},this)},this)},n.na=function(){dr(this);let u=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let g=0;g<d.length;g++){let C=u[g];for(let A=0;A<C.length;A++)f.push(d[g])}return f},n.V=function(u){dr(this);let d=[];if(typeof u=="string")ow(this,u)&&(d=d.concat(this.g.get(Wi(this,u))));else{u=Array.from(this.g.values());for(let f=0;f<u.length;f++)d=d.concat(u[f])}return d},n.set=function(u,d){return dr(this),this.i=null,u=Wi(this,u),ow(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[d]),this.h+=1,this},n.get=function(u,d){return u?(u=this.V(u),0<u.length?String(u[0]):d):d};function sw(u,d,f){iw(u,d),0<f.length&&(u.i=null,u.g.set(Wi(u,d),M(f)),u.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var g=d[f];let A=encodeURIComponent(String(g)),L=this.V(g);for(g=0;g<L.length;g++){var C=A;L[g]!==""&&(C+="="+encodeURIComponent(String(L[g]))),u.push(C)}}return this.i=u.join("&")};function Wi(u,d){return d=String(d),u.j&&(d=d.toLowerCase()),d}function OA(u,d){d&&!u.j&&(dr(u),u.i=null,u.g.forEach(function(f,g){var C=g.toLowerCase();g!=C&&(iw(this,g),sw(this,C,f))},u)),u.j=d}function FA(u,d){let f=new js;if(a.Image){let g=new Image;g.onload=v(hr,f,"TestLoadImage: loaded",!0,d,g),g.onerror=v(hr,f,"TestLoadImage: error",!1,d,g),g.onabort=v(hr,f,"TestLoadImage: abort",!1,d,g),g.ontimeout=v(hr,f,"TestLoadImage: timeout",!1,d,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=u}else d(!1)}function LA(u,d){let f=new js,g=new AbortController,C=setTimeout(()=>{g.abort(),hr(f,"TestPingServer: timeout",!1,d)},1e4);fetch(u,{signal:g.signal}).then(A=>{clearTimeout(C),A.ok?hr(f,"TestPingServer: ok",!0,d):hr(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(C),hr(f,"TestPingServer: error",!1,d)})}function hr(u,d,f,g,C){try{C&&(C.onload=null,C.onerror=null,C.onabort=null,C.ontimeout=null),g(f)}catch{}}function VA(){this.g=new wA}function jA(u,d,f){let g=f||"";try{ew(u,function(C,A){let L=C;l(C)&&(L=Uh(C)),d.push(g+A+"="+encodeURIComponent(L))})}catch(C){throw d.push(g+"type="+encodeURIComponent("_badmap")),C}}function qs(u){this.l=u.Ub||null,this.j=u.eb||!1}b(qs,$h),qs.prototype.g=function(){return new Ku(this.l,this.j)},qs.prototype.i=function(u){return function(){return u}}({});function Ku(u,d){ht.call(this),this.D=u,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(Ku,ht),n=Ku.prototype,n.open=function(u,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=d,this.readyState=1,Gs(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(d.body=u),(this.D||a).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,zs(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Gs(this)),this.g&&(this.readyState=3,Gs(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;aw(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function aw(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var d=u.value?u.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!u.done}))&&(this.response=this.responseText+=d)}u.done?zs(this):Gs(this),this.readyState==3&&aw(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,zs(this))},n.Qa=function(u){this.g&&(this.response=u,zs(this))},n.ga=function(){this.g&&zs(this)};function zs(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Gs(u)}n.setRequestHeader=function(u,d){this.u.append(u,d)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,u.push(f[0]+": "+f[1]),f=d.next();return u.join(`\r
`)};function Gs(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Ku.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function uw(u){let d="";return Z(u,function(f,g){d+=g,d+=":",d+=f,d+=`\r
`}),d}function Jh(u,d,f){e:{for(g in f){var g=!1;break e}g=!0}g||(f=uw(f),typeof u=="string"?f!=null&&encodeURIComponent(String(f)):Ne(u,d,f))}function Be(u){ht.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(Be,ht);var BA=/^https?$/i,UA=["POST","PUT"];n=Be.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,d,f,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);d=d?d.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():zh.g(),this.v=this.o?L_(this.o):L_(zh),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(d,String(u),!0),this.B=!1}catch(A){cw(this,A);return}if(u=f||"",f=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var C in g)f.set(C,g[C]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let A of g.keys())f.set(A,g.get(A));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(f.keys()).find(A=>A.toLowerCase()=="content-type"),C=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(UA,d,void 0))||g||C||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[A,L]of f)this.g.setRequestHeader(A,L);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{hw(this),this.u=!0,this.g.send(u),this.u=!1}catch(A){cw(this,A)}};function cw(u,d){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=d,u.m=5,lw(u),Qu(u)}function lw(u){u.A||(u.A=!0,wt(u,"complete"),wt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,wt(this,"complete"),wt(this,"abort"),Qu(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Qu(this,!0)),Be.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?dw(this):this.bb())},n.bb=function(){dw(this)};function dw(u){if(u.h&&typeof s<"u"&&(!u.v[1]||Bn(u)!=4||u.Z()!=2)){if(u.u&&Bn(u)==4)P_(u.Ea,0,u);else if(wt(u,"readystatechange"),Bn(u)==4){u.h=!1;try{let L=u.Z();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var g;if(g=L===0){var C=String(u.D).match(tw)[1]||null;!C&&a.self&&a.self.location&&(C=a.self.location.protocol.slice(0,-1)),g=!BA.test(C?C.toLowerCase():"")}f=g}if(f)wt(u,"complete"),wt(u,"success");else{u.m=6;try{var A=2<Bn(u)?u.g.statusText:""}catch{A=""}u.l=A+" ["+u.Z()+"]",lw(u)}}finally{Qu(u)}}}}function Qu(u,d){if(u.g){hw(u);let f=u.g,g=u.v[0]?()=>{}:null;u.g=null,u.v=null,d||wt(u,"ready");try{f.onreadystatechange=g}catch{}}}function hw(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Bn(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Bn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var d=this.g.responseText;return u&&d.indexOf(u)==0&&(d=d.substring(u.length)),_A(d)}};function fw(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function $A(u){let d={};u=(u.g&&2<=Bn(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<u.length;g++){if(H(u[g]))continue;var f=D(u[g]);let C=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let A=d[C]||[];d[C]=A,A.push(f)}I(d,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ws(u,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[u]||d}function pw(u){this.Aa=0,this.i=[],this.j=new js,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ws("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ws("baseRetryDelayMs",5e3,u),this.cb=Ws("retryDelaySeedMs",1e4,u),this.Wa=Ws("forwardChannelMaxRetries",2,u),this.wa=Ws("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Q_(u&&u.concurrentRequestLimit),this.Da=new VA,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=pw.prototype,n.la=8,n.G=1,n.connect=function(u,d,f,g){It(0),this.W=u,this.H=d||{},f&&g!==void 0&&(this.H.OSID=f,this.H.OAID=g),this.F=this.X,this.I=Dw(this,null,this.W),Zu(this)};function Xh(u){if(gw(u),u.G==3){var d=u.U++,f=jn(u.I);if(Ne(f,"SID",u.K),Ne(f,"RID",d),Ne(f,"TYPE","terminate"),Ks(u,f),d=new lr(u,u.j,d),d.L=2,d.v=Wu(jn(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&a.Image&&(new Image().src=d.v,f=!0),f||(d.g=Cw(d.j,null),d.g.ea(d.v)),d.F=Date.now(),qu(d)}Ew(u)}function Yu(u){u.g&&(tf(u),u.g.cancel(),u.g=null)}function gw(u){Yu(u),u.u&&(a.clearTimeout(u.u),u.u=null),Ju(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Zu(u){if(!Y_(u.h)&&!u.s){u.s=!0;var d=u.Ga;Ms||S_(),Ns||(Ms(),Ns=!0),Nh.add(d,u),u.B=0}}function HA(u,d){return Z_(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=d.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Vs(m(u.Ga,u,d),Iw(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let C=new lr(this,this.j,u),A=this.o;if(this.S&&(A?(A=y(A),E(A,this.S)):A=this.S),this.m!==null||this.O||(C.H=A,A=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var g=this.i[f];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(d+=g,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=yw(this,C,d),f=jn(this.I),Ne(f,"RID",u),Ne(f,"CVER",22),this.D&&Ne(f,"X-HTTP-Session-Id",this.D),Ks(this,f),A&&(this.O?d="headers="+encodeURIComponent(String(uw(A)))+"&"+d:this.m&&Jh(f,this.m,A)),Zh(this.h,C),this.Ua&&Ne(f,"TYPE","init"),this.P?(Ne(f,"$req",d),Ne(f,"SID","null"),C.T=!0,Wh(C,f,null)):Wh(C,f,d),this.G=2}}else this.G==3&&(u?mw(this,u):this.i.length==0||Y_(this.h)||mw(this))};function mw(u,d){var f;d?f=d.l:f=u.U++;let g=jn(u.I);Ne(g,"SID",u.K),Ne(g,"RID",f),Ne(g,"AID",u.T),Ks(u,g),u.m&&u.o&&Jh(g,u.m,u.o),f=new lr(u,u.j,f,u.B+1),u.m===null&&(f.H=u.o),d&&(u.i=d.D.concat(u.i)),d=yw(u,f,1e3),f.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Zh(u.h,f),Wh(f,g,d)}function Ks(u,d){u.H&&Z(u.H,function(f,g){Ne(d,g,f)}),u.l&&ew({},function(f,g){Ne(d,g,f)})}function yw(u,d,f){f=Math.min(u.i.length,f);var g=u.l?m(u.l.Na,u.l,u):null;e:{var C=u.i;let A=-1;for(;;){let L=["count="+f];A==-1?0<f?(A=C[0].g,L.push("ofs="+A)):A=0:L.push("ofs="+A);let Se=!0;for(let st=0;st<f;st++){let we=C[st].g,ft=C[st].map;if(we-=A,0>we)A=Math.max(0,C[st].g-100),Se=!1;else try{jA(ft,L,"req"+we+"_")}catch{g&&g(ft)}}if(Se){g=L.join("&");break e}}}return u=u.i.splice(0,f),d.D=u,g}function vw(u){if(!u.g&&!u.u){u.Y=1;var d=u.Fa;Ms||S_(),Ns||(Ms(),Ns=!0),Nh.add(d,u),u.v=0}}function ef(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Vs(m(u.Fa,u),Iw(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,_w(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Vs(m(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,It(10),Yu(this),_w(this))};function tf(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function _w(u){u.g=new lr(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var d=jn(u.qa);Ne(d,"RID","rpc"),Ne(d,"SID",u.K),Ne(d,"AID",u.T),Ne(d,"CI",u.F?"0":"1"),!u.F&&u.ja&&Ne(d,"TO",u.ja),Ne(d,"TYPE","xmlhttp"),Ks(u,d),u.m&&u.o&&Jh(d,u.m,u.o),u.L&&(u.g.I=u.L);var f=u.g;u=u.ia,f.L=1,f.v=Wu(jn(d)),f.m=null,f.P=!0,G_(f,u)}n.Za=function(){this.C!=null&&(this.C=null,Yu(this),ef(this),It(19))};function Ju(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function ww(u,d){var f=null;if(u.g==d){Ju(u),tf(u),u.g=null;var g=2}else if(Yh(u.h,d))f=d.D,J_(u.h,d),g=1;else return;if(u.G!=0){if(d.o)if(g==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var C=u.B;g=Uu(),wt(g,new $_(g,f)),Zu(u)}else vw(u);else if(C=d.s,C==3||C==0&&0<d.X||!(g==1&&HA(u,d)||g==2&&ef(u)))switch(f&&0<f.length&&(d=u.h,d.i=d.i.concat(f)),C){case 1:Qr(u,5);break;case 4:Qr(u,10);break;case 3:Qr(u,6);break;default:Qr(u,2)}}}function Iw(u,d){let f=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(f*=2),f*d}function Qr(u,d){if(u.j.info("Error code "+d),d==2){var f=m(u.fb,u),g=u.Xa;let C=!g;g=new Kr(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||zu(g,"https"),Wu(g),C?FA(g.toString(),f):LA(g.toString(),f)}else It(2);u.G=0,u.l&&u.l.sa(d),Ew(u),gw(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),It(2)):(this.j.info("Failed to ping google.com"),It(1))};function Ew(u){if(u.G=0,u.ka=[],u.l){let d=X_(u.h);(d.length!=0||u.i.length!=0)&&(N(u.ka,d),N(u.ka,u.i),u.h.i.length=0,M(u.i),u.i.length=0),u.l.ra()}}function Dw(u,d,f){var g=f instanceof Kr?jn(f):new Kr(f);if(g.g!="")d&&(g.g=d+"."+g.g),Gu(g,g.s);else{var C=a.location;g=C.protocol,d=d?d+"."+C.hostname:C.hostname,C=+C.port;var A=new Kr(null);g&&zu(A,g),d&&(A.g=d),C&&Gu(A,C),f&&(A.l=f),g=A}return f=u.D,d=u.ya,f&&d&&Ne(g,f,d),Ne(g,"VER",u.la),Ks(u,g),g}function Cw(u,d,f){if(d&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=u.Ca&&!u.pa?new Be(new qs({eb:f})):new Be(u.pa),d.Ha(u.J),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Tw(){}n=Tw.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Xu(){}Xu.prototype.g=function(u,d){return new kt(u,d)};function kt(u,d){ht.call(this),this.g=new pw(d),this.l=u,this.h=d&&d.messageUrlParams||null,u=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(u?u["X-WebChannel-Content-Type"]=d.messageContentType:u={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(u?u["X-WebChannel-Client-Profile"]=d.va:u={"X-WebChannel-Client-Profile":d.va}),this.g.S=u,(u=d&&d.Sb)&&!H(u)&&(this.g.m=u),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!H(d)&&(this.g.D=d,u=this.h,u!==null&&d in u&&(u=this.h,d in u&&delete u[d])),this.j=new Ki(this)}b(kt,ht),kt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},kt.prototype.close=function(){Xh(this.g)},kt.prototype.o=function(u){var d=this.g;if(typeof u=="string"){var f={};f.__data__=u,u=f}else this.u&&(f={},f.__data__=Uh(u),u=f);d.i.push(new bA(d.Ya++,u)),d.G==3&&Zu(d)},kt.prototype.N=function(){this.g.l=null,delete this.j,Xh(this.g),delete this.g,kt.aa.N.call(this)};function bw(u){Hh.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var d=u.__sm__;if(d){e:{for(let f in d){u=f;break e}u=void 0}(this.i=u)&&(u=this.i,d=d!==null&&u in d?d[u]:void 0),this.data=d}else this.data=u}b(bw,Hh);function Sw(){qh.call(this),this.status=1}b(Sw,qh);function Ki(u){this.g=u}b(Ki,Tw),Ki.prototype.ua=function(){wt(this.g,"a")},Ki.prototype.ta=function(u){wt(this.g,new bw(u))},Ki.prototype.sa=function(u){wt(this.g,new Sw)},Ki.prototype.ra=function(){wt(this.g,"b")},Xu.prototype.createWebChannel=Xu.prototype.g,kt.prototype.send=kt.prototype.o,kt.prototype.open=kt.prototype.m,kt.prototype.close=kt.prototype.close,Tm=Xn.createWebChannelTransport=function(){return new Xu},Cm=Xn.getStatEventTarget=function(){return Uu()},Dm=Xn.Event=Gr,Ql=Xn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},$u.NO_ERROR=0,$u.TIMEOUT=8,$u.HTTP_ERROR=6,Za=Xn.ErrorCode=$u,H_.COMPLETE="complete",Em=Xn.EventType=H_,V_.EventType=Fs,Fs.OPEN="a",Fs.CLOSE="b",Fs.ERROR="c",Fs.MESSAGE="d",ht.prototype.listen=ht.prototype.K,Uo=Xn.WebChannel=V_,jO=Xn.FetchXmlHttpFactory=qs,Be.prototype.listenOnce=Be.prototype.L,Be.prototype.getLastError=Be.prototype.Ka,Be.prototype.getLastErrorCode=Be.prototype.Ba,Be.prototype.getStatus=Be.prototype.Z,Be.prototype.getResponseJson=Be.prototype.Oa,Be.prototype.getResponseText=Be.prototype.oa,Be.prototype.send=Be.prototype.ea,Be.prototype.setWithCredentials=Be.prototype.Ha,Im=Xn.XhrIo=Be}).apply(typeof Kl<"u"?Kl:typeof self<"u"?self:typeof window<"u"?window:{});var A0="@firebase/firestore";var Je=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Je.UNAUTHENTICATED=new Je(null),Je.GOOGLE_CREDENTIALS=new Je("google-credentials-uid"),Je.FIRST_PARTY=new Je("first-party-uid"),Je.MOCK_USER=new Je("mock-user");var vs="10.14.0";var Pr=new rc("@firebase/firestore");function Go(){return Pr.logLevel}function MT(n){Pr.setLogLevel(n)}function k(n,...e){if(Pr.logLevel<=yn.DEBUG){let t=e.map(Rv);Pr.debug(`Firestore (${vs}): ${n}`,...t)}}function ze(n,...e){if(Pr.logLevel<=yn.ERROR){let t=e.map(Rv);Pr.error(`Firestore (${vs}): ${n}`,...t)}}function hn(n,...e){if(Pr.logLevel<=yn.WARN){let t=e.map(Rv);Pr.warn(`Firestore (${vs}): ${n}`,...t)}}function Rv(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function q(n="Unexpected state"){let e=`FIRESTORE (${vs}) INTERNAL ASSERTION FAILED: `+n;throw ze(e),new Error(e)}function W(n,e){n||q()}function NT(n,e){n||q()}function j(n,e){return n}var x={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},P=class extends Pw{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var nt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var od=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Mm=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Je.UNAUTHENTICATED))}shutdown(){}},Nm=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Pm=class{constructor(e){this.t=e,this.currentUser=Je.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){W(this.o===void 0);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),o=new nt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new nt,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let c=o;e.enqueueRetryable(()=>R(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new nt)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(W(typeof r.accessToken=="string"),new od(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return W(e===null||typeof e=="string"),new Je(e)}},km=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Je.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Om=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new km(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Je.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Fm=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Lm=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){W(this.o===void 0);let r=o=>{o.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.R;return this.R=o.token,k("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(W(typeof t.token=="string"),this.R=t.token,new Fm(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function BO(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var sd=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=BO(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function re(n,e){return n<e?-1:n>e?1:0}function ts(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function PT(n){return n+"\0"}var Ve=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new P(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new P(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new P(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new P(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?re(this.nanoseconds,e.nanoseconds):re(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var K=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Ve(0,0))}static max(){return new n(new Ve(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var ad=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&q(),r===void 0?r=e.length-t:r>e.length-t&&q(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),s=t.get(i);if(o<s)return-1;if(o>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},ye=class n extends ad{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new P(x.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},UO=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ge=class n extends ad{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return UO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new P(x.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new P(x.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new P(x.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new P(x.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(ye.fromString(e))}static fromName(e){return new n(ye.fromString(e).popFirst(5))}static empty(){return new n(ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ye.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ye(e.slice()))}};var ns=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function Vm(n){return n.fields.find(e=>e.kind===2)}function Ii(n){return n.fields.filter(e=>e.kind!==2)}ns.UNKNOWN_ID=-1;var Jo=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var cu=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Xt.min())}};function kT(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=K.fromTimestamp(r===1e9?new Ve(t+1,0):new Ve(t,r));return new Xt(i,B.empty(),e)}function OT(n){return new Xt(n.readTime,n.key,-1)}var Xt=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(K.min(),B.empty(),-1)}static max(){return new n(K.max(),B.empty(),-1)}};function Mv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:re(n.largestBatchId,e.largestBatchId))}var FT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ud=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Hr(n){return R(this,null,function*(){if(n.code!==x.FAILED_PRECONDITION||n.message!==FT)throw n;k("LocalStore","Unexpectedly lost primary lease")})}var S=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},c=>r(c))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let c=0;c<o;c++){let l=c;t(e[l]).next(h=>{s[l]=h,++a,a===o&&r(s)},h=>i(h))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};var cd=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new nt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Si(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=Nv(r.target.error);this.V.reject(new Si(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(o){throw new Si(t,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(k("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new Bm(t)}},kr=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(Qs())===12.2&&ze("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return k("SimpleDb","Removing database:",e),Ei(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!nc())return!1;if(n.v())return!0;let e=Qs(),t=n.S(e),r=0<t&&t<10,i=LT(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return R(this,null,function*(){return this.db||(k("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{let s=o.target.result;t(s)},i.onblocked=()=>{r(new Si(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{let s=o.target.error;s.name==="VersionError"?r(new P(x.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new P(x.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new Si(e,s))},i.onupgradeneeded=o=>{k("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let s=o.target.result;this.p.O(s,i.transaction,o.oldVersion,this.version).next(()=>{k("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return R(this,null,function*(){let o=t==="readonly",s=0;for(;;){++s;try{this.db=yield this.M(e);let a=cd.open(this.db,e,o?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),S.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&s<3;if(k("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function LT(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var jm=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Ei(this.B.delete())}},Si=class extends P{constructor(e,t){super(x.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function qr(n){return n.name==="IndexedDbTransactionError"}var Bm=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(k("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(k("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ei(r)}add(e){return k("SimpleDb","ADD",this.store.name,e,e),Ei(this.store.add(e))}get(e){return Ei(this.store.get(e)).next(t=>(t===void 0&&(t=null),k("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return k("SimpleDb","DELETE",this.store.name,e),Ei(this.store.delete(e))}count(){return k("SimpleDb","COUNT",this.store.name),Ei(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let o=i.getAll(r.range);return new S((s,a)=>{o.onerror=c=>{a(c.target.error)},o.onsuccess=c=>{s(c.target.result)}})}{let o=this.cursor(r),s=[];return this.W(o,(a,c)=>{s.push(c)}).next(()=>s)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new S((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}j(e,t){k("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(o,s,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new S((r,i)=>{t.onerror=o=>{let s=Nv(o.target.error);i(s)},t.onsuccess=o=>{let s=o.target.result;s?e(s.primaryKey,s.value).next(a=>{a?s.continue():r()}):r()}})}W(e,t){let r=[];return new S((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{let a=s.target.result;if(!a)return void i();let c=new jm(a),l=t(a.primaryKey,a.value,c);if(l instanceof S){let h=l.catch(p=>(c.done(),S.reject(p)));r.push(h)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>S.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function Ei(n){return new S((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=Nv(r.target.error);t(i)}})}var x0=!1;function Nv(n){let e=kr.S(Qs());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new P("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return x0||(x0=!0,setTimeout(()=>{throw r},0)),r}}return n}var Um=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){k("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>R(this,null,function*(){this.task=null;try{k("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){qr(t)?k("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield Hr(t)}yield this.X(6e4)}))}},$m=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return R(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,o=!0;return S.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return k("IndexBackfiller",`Processing collection: ${s}`),this.ne(e,s,i).next(a=>{i-=a,r.add(s)});o=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(o=>{let s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.re(i,o)).next(a=>(k("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>s.size)}))}re(e,t){let r=e;return t.changes.forEach((i,o)=>{let s=OT(o);Mv(s,r)>0&&(r=s)}),new Xt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var jt=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Ru(n){return n==null}function lu(n){return n===0&&1/n==-1/0}function VT(n){return typeof n=="number"&&Number.isInteger(n)&&!lu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function St(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=R0(e)),e=$O(n.get(t),e);return R0(e)}function $O(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function R0(n){return n+""}function An(n){let e=n.length;if(W(e>=2),e===2)return W(n.charAt(0)===""&&n.charAt(1)===""),ye.emptyPath();let t=e-2,r=[],i="";for(let o=0;o<e;){let s=n.indexOf("",o);switch((s<0||s>t)&&q(),n.charAt(s+1)){case"":let a=n.substring(o,s),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(o,s),i+="\0";break;case"":i+=n.substring(o,s+1);break;default:q()}o=s+2}return new ye(r)}var M0=["userId","batchId"];function ed(n,e){return[n,St(e)]}function jT(n,e,t){return[n,St(e),t]}var HO={},qO=["prefixPath","collectionGroup","readTime","documentId"],zO=["prefixPath","collectionGroup","documentId"],GO=["collectionGroup","readTime","prefixPath","documentId"],WO=["canonicalId","targetId"],KO=["targetId","path"],QO=["path","targetId"],YO=["collectionId","parent"],ZO=["indexId","uid"],JO=["uid","sequenceNumber"],XO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],eF=["indexId","uid","orderedDocumentKey"],tF=["userId","collectionPath","documentId"],nF=["userId","collectionPath","largestBatchId"],rF=["userId","collectionGroup","largestBatchId"],BT=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],iF=[...BT,"documentOverlays"],UT=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],$T=UT,Pv=[...$T,"indexConfiguration","indexState","indexEntries"],oF=Pv,sF=[...Pv,"globals"];var du=class extends ud{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function rt(n,e){let t=j(n);return kr.F(t._e,e)}function N0(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ji(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function HT(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ke=class n{constructor(e,t){this.comparator=e,this.root=t||Rn.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Rn.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zo(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zo(this.root,e,this.comparator,!0)}},Zo=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Rn=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw q();let e=this.left.check();if(e!==this.right.check())throw q();return e+(this.isRed()?0:1)}};Rn.EMPTY=null,Rn.RED=!0,Rn.BLACK=!1;Rn.EMPTY=new class{constructor(){this.size=0}get key(){throw q()}get value(){throw q()}get color(){throw q()}get left(){throw q()}get right(){throw q()}copy(e,t,r,i,o){return this}insert(e,t,r){return new Rn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Re=class n{constructor(e){this.comparator=e,this.data=new ke(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ld(this.data.getIterator())}getIteratorFrom(e){return new ld(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},ld=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function $o(n){return n.hasNext()?n.getNext():void 0}var Bt=class n{constructor(e){this.fields=e,e.sort(Ge.comparator)}static empty(){return new n([])}unionWith(e){let t=new Re(Ge.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ts(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var dd=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function qT(){return typeof atob<"u"}var Ke=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new dd("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return re(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ke.EMPTY_BYTE_STRING=new Ke("");var aF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function nr(n){if(W(!!n),typeof n=="string"){let e=0,t=aF.exec(n);if(W(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Oe(n.seconds),nanos:Oe(n.nanos)}}function Oe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Or(n){return typeof n=="string"?Ke.fromBase64String(n):Ke.fromUint8Array(n)}function nh(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function kv(n){let e=n.mapValue.fields.__previous_value__;return nh(e)?kv(e):e}function hu(n){let e=nr(n.mapValue.fields.__local_write_time__.timestampValue);return new Ve(e.seconds,e.nanos)}var Hm=class{constructor(e,t,r,i,o,s,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},Fr=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Mr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},td={nullValue:"NULL_VALUE"};function Ai(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?nh(n)?4:zT(n)?9007199254740991:rh(n)?10:11:q()}function Pn(n,e){if(n===e)return!0;let t=Ai(n);if(t!==Ai(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return hu(n).isEqual(hu(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=nr(i.timestampValue),a=nr(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Or(i.bytesValue).isEqual(Or(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return Oe(i.geoPointValue.latitude)===Oe(o.geoPointValue.latitude)&&Oe(i.geoPointValue.longitude)===Oe(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Oe(i.integerValue)===Oe(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=Oe(i.doubleValue),a=Oe(o.doubleValue);return s===a?lu(s)===lu(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return ts(n.arrayValue.values||[],e.arrayValue.values||[],Pn);case 10:case 11:return function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(N0(s)!==N0(a))return!1;for(let c in s)if(s.hasOwnProperty(c)&&(a[c]===void 0||!Pn(s[c],a[c])))return!1;return!0}(n,e);default:return q()}}function fu(n,e){return(n.values||[]).find(t=>Pn(t,e))!==void 0}function Lr(n,e){if(n===e)return 0;let t=Ai(n),r=Ai(e);if(t!==r)return re(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return re(n.booleanValue,e.booleanValue);case 2:return function(o,s){let a=Oe(o.integerValue||o.doubleValue),c=Oe(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return P0(n.timestampValue,e.timestampValue);case 4:return P0(hu(n),hu(e));case 5:return re(n.stringValue,e.stringValue);case 6:return function(o,s){let a=Or(o),c=Or(s);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let a=o.split("/"),c=s.split("/");for(let l=0;l<a.length&&l<c.length;l++){let h=re(a[l],c[l]);if(h!==0)return h}return re(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let a=re(Oe(o.latitude),Oe(s.latitude));return a!==0?a:re(Oe(o.longitude),Oe(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return k0(n.arrayValue,e.arrayValue);case 10:return function(o,s){var a,c,l,h;let p=o.fields||{},m=s.fields||{},v=(a=p.value)===null||a===void 0?void 0:a.arrayValue,b=(c=m.value)===null||c===void 0?void 0:c.arrayValue,M=re(((l=v?.values)===null||l===void 0?void 0:l.length)||0,((h=b?.values)===null||h===void 0?void 0:h.length)||0);return M!==0?M:k0(v,b)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===Mr.mapValue&&s===Mr.mapValue)return 0;if(o===Mr.mapValue)return 1;if(s===Mr.mapValue)return-1;let a=o.fields||{},c=Object.keys(a),l=s.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){let m=re(c[p],h[p]);if(m!==0)return m;let v=Lr(a[c[p]],l[h[p]]);if(v!==0)return v}return re(c.length,h.length)}(n.mapValue,e.mapValue);default:throw q()}}function P0(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return re(n,e);let t=nr(n),r=nr(e),i=re(t.seconds,r.seconds);return i!==0?i:re(t.nanos,r.nanos)}function k0(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Lr(t[i],r[i]);if(o)return o}return re(t.length,r.length)}function rs(n){return qm(n)}function qm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=nr(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Or(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return B.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=qm(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${qm(t.fields[s])}`;return i+"}"}(n.mapValue):q()}function xi(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function zm(n){return!!n&&"integerValue"in n}function pu(n){return!!n&&"arrayValue"in n}function O0(n){return!!n&&"nullValue"in n}function F0(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function nd(n){return!!n&&"mapValue"in n}function rh(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function iu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return ji(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=iu(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=iu(n.arrayValue.values[t]);return e}return Object.assign({},n)}function zT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var GT={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function uF(n){return"nullValue"in n?td:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?xi(Fr.empty(),B.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?rh(n)?GT:{mapValue:{}}:q()}function cF(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?xi(Fr.empty(),B.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?GT:"mapValue"in n?rh(n)?{mapValue:{}}:Mr:q()}function L0(n,e){let t=Lr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function V0(n,e){let t=Lr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var _t=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!nd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=iu(t)}setAll(e){let t=Ge.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=iu(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());nd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Pn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];nd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ji(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(iu(this.value))}};function WT(n){let e=[];return ji(n.fields,(t,r)=>{let i=new Ge([t]);if(nd(r)){let o=WT(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new Bt(e)}var Xe=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,K.min(),K.min(),K.min(),_t.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,K.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,K.min(),K.min(),_t.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,K.min(),K.min(),_t.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_t.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_t.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var kn=class{constructor(e,t){this.position=e,this.inclusive=t}};function j0(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=B.comparator(B.fromName(s.referenceValue),t.key):r=Lr(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function B0(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Pn(n.position[t],e.position[t]))return!1;return!0}var Ri=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function lF(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var hd=class{},he=class n extends hd{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Km(e,t,r):t==="array-contains"?new Zm(e,r):t==="in"?new fd(e,r):t==="not-in"?new Jm(e,r):t==="array-contains-any"?new Xm(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Qm(e,r):new Ym(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Lr(t,this.value)):t!==null&&Ai(this.value)===Ai(t)&&this.matchesComparison(Lr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},be=class n extends hd{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return is(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function is(n){return n.op==="and"}function Gm(n){return n.op==="or"}function Ov(n){return KT(n)&&is(n)}function KT(n){for(let e of n.filters)if(e instanceof be)return!1;return!0}function Wm(n){if(n instanceof he)return n.field.canonicalString()+n.op.toString()+rs(n.value);if(Ov(n))return n.filters.map(e=>Wm(e)).join(",");{let e=n.filters.map(t=>Wm(t)).join(",");return`${n.op}(${e})`}}function QT(n,e){return n instanceof he?function(r,i){return i instanceof he&&r.op===i.op&&r.field.isEqual(i.field)&&Pn(r.value,i.value)}(n,e):n instanceof be?function(r,i){return i instanceof be&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&QT(s,i.filters[a]),!0):!1}(n,e):void q()}function YT(n,e){let t=n.filters.concat(e);return be.create(t,n.op)}function ZT(n){return n instanceof he?function(t){return`${t.field.canonicalString()} ${t.op} ${rs(t.value)}`}(n):n instanceof be?function(t){return t.op.toString()+" {"+t.getFilters().map(ZT).join(" ,")+"}"}(n):"Filter"}var Km=class extends he{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},Qm=class extends he{constructor(e,t){super(e,"in",t),this.keys=JT("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Ym=class extends he{constructor(e,t){super(e,"not-in",t),this.keys=JT("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function JT(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>B.fromName(r.referenceValue))}var Zm=class extends he{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return pu(t)&&fu(t.arrayValue,this.value)}},fd=class extends he{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&fu(this.value.arrayValue,t)}},Jm=class extends he{constructor(e,t){super(e,"not-in",t)}matches(e){if(fu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!fu(this.value.arrayValue,t)}},Xm=class extends he{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!pu(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>fu(this.value.arrayValue,r))}};var ey=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ue=null}};function ty(n,e=null,t=[],r=[],i=null,o=null,s=null){return new ey(n,e,t,r,i,o,s)}function Mi(n){let e=j(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Wm(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),Ru(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>rs(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>rs(r)).join(",")),e.ue=t}return e.ue}function Mu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!lF(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!QT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!B0(n.startAt,e.startAt)&&B0(n.endAt,e.endAt)}function pd(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function gd(n,e){return n.filters.filter(t=>t instanceof he&&t.field.isEqual(e))}function U0(n,e,t){let r=td,i=!0;for(let o of gd(n,e)){let s=td,a=!0;switch(o.op){case"<":case"<=":s=uF(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,a=!1;break;case"!=":case"not-in":s=td}L0({value:r,inclusive:i},{value:s,inclusive:a})<0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];L0({value:r,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}function $0(n,e,t){let r=Mr,i=!0;for(let o of gd(n,e)){let s=Mr,a=!0;switch(o.op){case">=":case">":s=cF(o.value),a=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,a=!1;break;case"!=":case"not-in":s=Mr}V0({value:r,inclusive:i},{value:s,inclusive:a})>0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];V0({value:r,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}var fn=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function XT(n,e,t,r,i,o,s,a){return new fn(n,e,t,r,i,o,s,a)}function _s(n){return new fn(n)}function H0(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Fv(n){return n.collectionGroup!==null}function Xo(n){let e=j(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Re(Ge.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Ri(o,r))}),t.has(Ge.keyField().canonicalString())||e.ce.push(new Ri(Ge.keyField(),r))}return e.ce}function At(n){let e=j(n);return e.le||(e.le=dF(e,Xo(n))),e.le}function dF(n,e){if(n.limitType==="F")return ty(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Ri(i.field,o)});let t=n.endAt?new kn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new kn(n.startAt.position,n.startAt.inclusive):null;return ty(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ny(n,e){let t=n.filters.concat([e]);return new fn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function md(n,e,t){return new fn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Nu(n,e){return Mu(At(n),At(e))&&n.limitType===e.limitType}function eb(n){return`${Mi(At(n))}|lt:${n.limitType}`}function Wo(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>ZT(i)).join(", ")}]`),Ru(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>rs(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>rs(i)).join(",")),`Target(${r})`}(At(n))}; limitType=${n.limitType})`}function Pu(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):B.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of Xo(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,c){let l=j0(s,a,c);return s.inclusive?l<=0:l<0}(r.startAt,Xo(r),i)||r.endAt&&!function(s,a,c){let l=j0(s,a,c);return s.inclusive?l>=0:l>0}(r.endAt,Xo(r),i))}(n,e)}function tb(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function nb(n){return(e,t)=>{let r=!1;for(let i of Xo(n)){let o=hF(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function hF(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):function(o,s,a){let c=s.data.field(o),l=a.data.field(o);return c!==null&&l!==null?Lr(c,l):q()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return q()}}var On=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ji(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return HT(this.inner)}size(){return this.innerSize}};var fF=new ke(B.comparator);function Pt(){return fF}var rb=new ke(B.comparator);function nu(...n){let e=rb;for(let t of n)e=e.insert(t.key,t);return e}function ib(n){let e=rb;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function xn(){return ou()}function ob(){return ou()}function ou(){return new On(n=>n.toString(),(n,e)=>n.isEqual(e))}var pF=new ke(B.comparator),gF=new Re(B.comparator);function ie(...n){let e=gF;for(let t of n)e=e.add(t);return e}var mF=new Re(re);function Lv(){return mF}function Vv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:lu(e)?"-0":e}}function sb(n){return{integerValue:""+n}}function ab(n,e){return VT(e)?sb(e):Vv(n,e)}var os=class{constructor(){this._=void 0}};function yF(n,e,t){return n instanceof Vr?function(i,o){let s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&nh(o)&&(o=kv(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(t,e):n instanceof rr?cb(n,e):n instanceof ir?lb(n,e):function(i,o){let s=ub(i,o),a=q0(s)+q0(i.Pe);return zm(s)&&zm(i.Pe)?sb(a):Vv(i.serializer,a)}(n,e)}function vF(n,e,t){return n instanceof rr?cb(n,e):n instanceof ir?lb(n,e):t}function ub(n,e){return n instanceof jr?function(r){return zm(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var Vr=class extends os{},rr=class extends os{constructor(e){super(),this.elements=e}};function cb(n,e){let t=db(e);for(let r of n.elements)t.some(i=>Pn(i,r))||t.push(r);return{arrayValue:{values:t}}}var ir=class extends os{constructor(e){super(),this.elements=e}};function lb(n,e){let t=db(e);for(let r of n.elements)t=t.filter(i=>!Pn(i,r));return{arrayValue:{values:t}}}var jr=class extends os{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function q0(n){return Oe(n.integerValue||n.doubleValue)}function db(n){return pu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Ni=class{constructor(e,t){this.field=e,this.transform=t}};function _F(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof rr&&i instanceof rr||r instanceof ir&&i instanceof ir?ts(r.elements,i.elements,Pn):r instanceof jr&&i instanceof jr?Pn(r.Pe,i.Pe):r instanceof Vr&&i instanceof Vr}(n.transform,e.transform)}var ry=class{constructor(e,t){this.version=e,this.transformResults=t}},$e=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function rd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var ss=class{};function hb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ur(n.key,$e.none()):new Br(n.key,n.data,$e.none());{let t=n.data,r=_t.empty(),i=new Re(Ge.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new pn(n.key,r,new Bt(i.toArray()),$e.none())}}function wF(n,e,t){n instanceof Br?function(i,o,s){let a=i.value.clone(),c=G0(i.fieldTransforms,o,s.transformResults);a.setAll(c),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof pn?function(i,o,s){if(!rd(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=G0(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(fb(i)),c.setAll(a),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function su(n,e,t,r){return n instanceof Br?function(o,s,a,c){if(!rd(o.precondition,s))return a;let l=o.value.clone(),h=W0(o.fieldTransforms,c,s);return l.setAll(h),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof pn?function(o,s,a,c){if(!rd(o.precondition,s))return a;let l=W0(o.fieldTransforms,c,s),h=s.data;return h.setAll(fb(o)),h.setAll(l),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(n,e,t,r):function(o,s,a){return rd(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function IF(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=ub(r.transform,i||null);o!=null&&(t===null&&(t=_t.empty()),t.set(r.field,o))}return t||null}function z0(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ts(r,i,(o,s)=>_F(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Br=class extends ss{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},pn=class extends ss{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function fb(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function G0(n,e,t){let r=new Map;W(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,vF(s,a,t[i]))}return r}function W0(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,yF(o,s,e))}return r}var Ur=class extends ss{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},gu=class extends ss{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var mu=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&wF(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=su(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=su(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=ob();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let c=hb(s,a);c!==null&&r.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(K.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ie())}isEqual(e){return this.batchId===e.batchId&&ts(this.mutations,e.mutations,(t,r)=>z0(t,r))&&ts(this.baseMutations,e.baseMutations,(t,r)=>z0(t,r))}},iy=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){W(e.mutations.length===r.length);let i=function(){return pF}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var yu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var oy=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ye,me;function pb(n){switch(n){default:return q();case x.CANCELLED:case x.UNKNOWN:case x.DEADLINE_EXCEEDED:case x.RESOURCE_EXHAUSTED:case x.INTERNAL:case x.UNAVAILABLE:case x.UNAUTHENTICATED:return!1;case x.INVALID_ARGUMENT:case x.NOT_FOUND:case x.ALREADY_EXISTS:case x.PERMISSION_DENIED:case x.FAILED_PRECONDITION:case x.ABORTED:case x.OUT_OF_RANGE:case x.UNIMPLEMENTED:case x.DATA_LOSS:return!0}}function gb(n){if(n===void 0)return ze("GRPC error has no .code"),x.UNKNOWN;switch(n){case Ye.OK:return x.OK;case Ye.CANCELLED:return x.CANCELLED;case Ye.UNKNOWN:return x.UNKNOWN;case Ye.DEADLINE_EXCEEDED:return x.DEADLINE_EXCEEDED;case Ye.RESOURCE_EXHAUSTED:return x.RESOURCE_EXHAUSTED;case Ye.INTERNAL:return x.INTERNAL;case Ye.UNAVAILABLE:return x.UNAVAILABLE;case Ye.UNAUTHENTICATED:return x.UNAUTHENTICATED;case Ye.INVALID_ARGUMENT:return x.INVALID_ARGUMENT;case Ye.NOT_FOUND:return x.NOT_FOUND;case Ye.ALREADY_EXISTS:return x.ALREADY_EXISTS;case Ye.PERMISSION_DENIED:return x.PERMISSION_DENIED;case Ye.FAILED_PRECONDITION:return x.FAILED_PRECONDITION;case Ye.ABORTED:return x.ABORTED;case Ye.OUT_OF_RANGE:return x.OUT_OF_RANGE;case Ye.UNIMPLEMENTED:return x.UNIMPLEMENTED;case Ye.DATA_LOSS:return x.DATA_LOSS;default:return q()}}(me=Ye||(Ye={}))[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";var K0=null;function mb(){return new TextEncoder}var EF=new br([4294967295,4294967295],0);function Q0(n){let e=mb().encode(n),t=new wm;return t.update(e),new Uint8Array(t.digest())}function Y0(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new br([t,r],0),new br([i,o],0)]}var sy=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new bi(`Invalid padding: ${t}`);if(r<0)throw new bi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new bi(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new bi(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=br.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(br.fromNumber(r)));return i.compare(EF)===1&&(i=new br([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Q0(e),[r,i]=Y0(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(r,i,o);if(!this.de(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.Ie===0)return;let t=Q0(e),[r,i]=Y0(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(r,i,o);this.Ae(s)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},bi=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var vu=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,_u.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(K.min(),i,new ke(re),Pt(),ie())}},_u=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ie(),ie(),ie())}};var es=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},yd=class{constructor(e,t){this.targetId=e,this.me=t}},vd=class{constructor(e,t,r=Ke.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},_d=class{constructor(){this.fe=0,this.ge=J0(),this.pe=Ke.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ie(),t=ie(),r=ie();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:q()}}),new _u(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=J0()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,W(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},ay=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Pt(),this.qe=Z0(),this.Qe=new ke(re)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:q()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(pd(o))if(r===0){let s=new B(o.path);this.Ue(t,s,Xe.newNoDocument(s,K.min()))}else W(r===1);else{let s=this.Ye(t);if(s!==r){let a=this.Ze(e),c=a?this.Xe(a,e,s):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}K0?.et(function(h,p,m,v,b){var M,N,V,H,O,Y;let ee={localCacheCount:h,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},Z=p.unchangedNames;return Z&&(ee.bloomFilter={applied:b===0,hashCount:(M=Z?.hashCount)!==null&&M!==void 0?M:0,bitmapLength:(H=(V=(N=Z?.bits)===null||N===void 0?void 0:N.bitmap)===null||V===void 0?void 0:V.length)!==null&&H!==void 0?H:0,padding:(Y=(O=Z?.bits)===null||O===void 0?void 0:O.padding)!==null&&Y!==void 0?Y:0,mightContain:I=>{var y;return(y=v?.mightContain(I))!==null&&y!==void 0&&y}}),ee}(s,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=Or(r).toUint8Array()}catch(c){if(c instanceof dd)return hn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new sy(s,i,o)}catch(c){return hn(c instanceof bi?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.Le.tt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,s)=>{let a=this.Je(s);if(a){if(o.current&&pd(a.target)){let c=new B(a.target.path);this.ke.get(c)!==null||this.it(s,c)||this.Ue(s,c,Xe.newNoDocument(c,e))}o.be&&(t.set(s,o.ve()),o.Ce())}});let r=ie();this.qe.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));let i=new vu(e,t,this.Qe,this.ke,r);return this.ke=Pt(),this.qe=Z0(),this.Qe=new ke(re),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new _d,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Re(re),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||k("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new _d),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function Z0(){return new ke(B.comparator)}function J0(){return new ke(B.comparator)}var DF={asc:"ASCENDING",desc:"DESCENDING"},CF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},TF={and:"AND",or:"OR"},uy=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function cy(n,e){return n.useProto3Json||Ru(e)?e:{value:e}}function as(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function yb(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function bF(n,e){return as(n,e.toTimestamp())}function We(n){return W(!!n),K.fromTimestamp(function(t){let r=nr(t);return new Ve(r.seconds,r.nanos)}(n))}function jv(n,e){return ly(n,e).canonicalString()}function ly(n,e){let t=function(i){return new ye(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function vb(n){let e=ye.fromString(n);return W(Ab(e)),e}function wu(n,e){return jv(n.databaseId,e.path)}function Mn(n,e){let t=vb(e);if(t.get(1)!==n.databaseId.projectId)throw new P(x.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new P(x.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(Ib(t))}function _b(n,e){return jv(n.databaseId,e)}function wb(n){let e=vb(n);return e.length===4?ye.emptyPath():Ib(e)}function dy(n){return new ye(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ib(n){return W(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function X0(n,e,t){return{name:wu(n,e),fields:t.value.mapValue.fields}}function Eb(n,e,t){let r=Mn(n,e.name),i=We(e.updateTime),o=e.createTime?We(e.createTime):K.min(),s=new _t({mapValue:{fields:e.fields}}),a=Xe.newFoundDocument(r,i,o,s);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function SF(n,e){return"found"in e?function(r,i){W(!!i.found),i.found.name,i.found.updateTime;let o=Mn(r,i.found.name),s=We(i.found.updateTime),a=i.found.createTime?We(i.found.createTime):K.min(),c=new _t({mapValue:{fields:i.found.fields}});return Xe.newFoundDocument(o,s,a,c)}(n,e):"missing"in e?function(r,i){W(!!i.missing),W(!!i.readTime);let o=Mn(r,i.missing),s=We(i.readTime);return Xe.newNoDocument(o,s)}(n,e):q()}function AF(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:q()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(l,h){return l.useProto3Json?(W(h===void 0||typeof h=="string"),Ke.fromBase64String(h||"")):(W(h===void 0||h instanceof Buffer||h instanceof Uint8Array),Ke.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(l){let h=l.code===void 0?x.UNKNOWN:gb(l.code);return new P(h,l.message||"")}(s);t=new vd(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Mn(n,r.document.name),o=We(r.document.updateTime),s=r.document.createTime?We(r.document.createTime):K.min(),a=new _t({mapValue:{fields:r.document.fields}}),c=Xe.newFoundDocument(i,o,s,a),l=r.targetIds||[],h=r.removedTargetIds||[];t=new es(l,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Mn(n,r.document),o=r.readTime?We(r.readTime):K.min(),s=Xe.newNoDocument(i,o),a=r.removedTargetIds||[];t=new es([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Mn(n,r.document),o=r.removedTargetIds||[];t=new es([],o,i,null)}else{if(!("filter"in e))return q();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new oy(i,o),a=r.targetId;t=new yd(a,s)}}return t}function Iu(n,e){let t;if(e instanceof Br)t={update:X0(n,e.key,e.value)};else if(e instanceof Ur)t={delete:wu(n,e.key)};else if(e instanceof pn)t={update:X0(n,e.key,e.data),updateMask:kF(e.fieldMask)};else{if(!(e instanceof gu))return q();t={verify:wu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){let a=s.transform;if(a instanceof Vr)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof rr)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ir)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof jr)return{fieldPath:s.field.canonicalString(),increment:a.Pe};throw q()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:bF(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:q()}(n,e.precondition)),t}function hy(n,e){let t=e.currentDocument?function(o){return o.updateTime!==void 0?$e.updateTime(We(o.updateTime)):o.exists!==void 0?$e.exists(o.exists):$e.none()}(e.currentDocument):$e.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,a){let c=null;if("setToServerValue"in a)W(a.setToServerValue==="REQUEST_TIME"),c=new Vr;else if("appendMissingElements"in a){let h=a.appendMissingElements.values||[];c=new rr(h)}else if("removeAllFromArray"in a){let h=a.removeAllFromArray.values||[];c=new ir(h)}else"increment"in a?c=new jr(s,a.increment):q();let l=Ge.fromServerFormat(a.fieldPath);return new Ni(l,c)}(n,i)):[];if(e.update){e.update.name;let i=Mn(n,e.update.name),o=new _t({mapValue:{fields:e.update.fields}});if(e.updateMask){let s=function(c){let l=c.fieldPaths||[];return new Bt(l.map(h=>Ge.fromServerFormat(h)))}(e.updateMask);return new pn(i,o,s,t,r)}return new Br(i,o,t,r)}if(e.delete){let i=Mn(n,e.delete);return new Ur(i,t)}if(e.verify){let i=Mn(n,e.verify);return new gu(i,t)}return q()}function xF(n,e){return n&&n.length>0?(W(e!==void 0),n.map(t=>function(i,o){let s=i.updateTime?We(i.updateTime):We(o);return s.isEqual(K.min())&&(s=We(o)),new ry(s,i.transformResults||[])}(t,e))):[]}function Db(n,e){return{documents:[_b(n,e.path)]}}function Cb(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=_b(n,i);let o=function(l){if(l.length!==0)return Sb(be.create(l,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(l){if(l.length!==0)return l.map(h=>function(m){return{field:Ko(m.field),direction:MF(m.dir)}}(h))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=cy(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function Tb(n){let e=wb(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){W(r===1);let h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];t.where&&(o=function(p){let m=bb(p);return m instanceof be&&Ov(m)?m.getFilters():[m]}(t.where));let s=[];t.orderBy&&(s=function(p){return p.map(m=>function(b){return new Ri(Qo(b.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,Ru(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(p){let m=!!p.before,v=p.values||[];return new kn(v,m)}(t.startAt));let l=null;return t.endAt&&(l=function(p){let m=!p.before,v=p.values||[];return new kn(v,m)}(t.endAt)),XT(e,i,s,o,a,"F",c,l)}function RF(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return q()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function bb(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Qo(t.unaryFilter.field);return he.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Qo(t.unaryFilter.field);return he.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Qo(t.unaryFilter.field);return he.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=Qo(t.unaryFilter.field);return he.create(s,"!=",{nullValue:"NULL_VALUE"});default:return q()}}(n):n.fieldFilter!==void 0?function(t){return he.create(Qo(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return q()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return be.create(t.compositeFilter.filters.map(r=>bb(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return q()}}(t.compositeFilter.op))}(n):q()}function MF(n){return DF[n]}function NF(n){return CF[n]}function PF(n){return TF[n]}function Ko(n){return{fieldPath:n.canonicalString()}}function Qo(n){return Ge.fromServerFormat(n.fieldPath)}function Sb(n){return n instanceof he?function(t){if(t.op==="=="){if(F0(t.value))return{unaryFilter:{field:Ko(t.field),op:"IS_NAN"}};if(O0(t.value))return{unaryFilter:{field:Ko(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(F0(t.value))return{unaryFilter:{field:Ko(t.field),op:"IS_NOT_NAN"}};if(O0(t.value))return{unaryFilter:{field:Ko(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ko(t.field),op:NF(t.op),value:t.value}}}(n):n instanceof be?function(t){let r=t.getFilters().map(i=>Sb(i));return r.length===1?r[0]:{compositeFilter:{op:PF(t.op),filters:r}}}(n):q()}function kF(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Ab(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var us=class n{constructor(e,t,r,i,o=K.min(),s=K.min(),a=Ke.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var wd=class{constructor(e){this.ct=e}};function OF(n,e){let t;if(e.document)t=Eb(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=B.fromSegments(e.noDocument.path),i=ki(e.noDocument.readTime);t=Xe.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return q();{let r=B.fromSegments(e.unknownDocument.path),i=ki(e.unknownDocument.version);t=Xe.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let o=new Ve(i[0],i[1]);return K.fromTimestamp(o)}(e.readTime)),t}function eT(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Id(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,s){return{name:wu(o,s.key),fields:s.data.value.mapValue.fields,updateTime:as(o,s.version.toTimestamp()),createTime:as(o,s.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Pi(e.version)};else{if(!e.isUnknownDocument())return q();r.unknownDocument={path:t.path.toArray(),version:Pi(e.version)}}return r}function Id(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Pi(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ki(n){let e=new Ve(n.seconds,n.nanoseconds);return K.fromTimestamp(e)}function Di(n,e){let t=(e.baseMutations||[]).map(o=>hy(n.ct,o));for(let o=0;o<e.mutations.length-1;++o){let s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let a=e.mutations[o+1];s.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let r=e.mutations.map(o=>hy(n.ct,o)),i=Ve.fromMillis(e.localWriteTimeMs);return new mu(e.batchId,i,t,r)}function ru(n){let e=ki(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ki(n.lastLimboFreeSnapshotVersion):K.min(),r;return r=function(o){return o.documents!==void 0}(n.query)?function(o){return W(o.documents.length===1),At(_s(wb(o.documents[0])))}(n.query):function(o){return At(Tb(o))}(n.query),new us(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ke.fromBase64String(n.resumeToken))}function xb(n,e){let t=Pi(e.snapshotVersion),r=Pi(e.lastLimboFreeSnapshotVersion),i;i=pd(e.target)?Db(n.ct,e.target):Cb(n.ct,e.target)._t;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Mi(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Bv(n){let e=Tb({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?md(e,e.limit,"L"):e}function bm(n,e){return new yu(e.largestBatchId,hy(n.ct,e.overlayMutation))}function tT(n,e){let t=e.path.lastSegment();return[n,St(e.path.popLast()),t]}function nT(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Pi(r.readTime),documentKey:St(r.documentKey.path),largestBatchId:r.largestBatchId}}var fy=class{getBundleMetadata(e,t){return rT(e).get(t).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:ki(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,t){return rT(e).put(function(i){return{bundleId:i.id,createTime:Pi(We(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return iT(e).get(t).next(r=>{if(r)return function(o){return{name:o.name,query:Bv(o.bundledQuery),readTime:ki(o.readTime)}}(r)})}saveNamedQuery(e,t){return iT(e).put(function(i){return{name:i.name,readTime:Pi(We(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function rT(n){return rt(n,"bundles")}function iT(n){return rt(n,"namedQueries")}var Ed=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Ja(e).get(tT(this.userId,t)).next(r=>r?bm(this.serializer,r):null)}getOverlays(e,t){let r=xn();return S.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((o,s)=>{let a=new yu(t,s);i.push(this.ht(e,a))}),S.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(s=>i.add(St(s.getCollectionPath())));let o=[];return i.forEach(s=>{let a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(Ja(e).j("collectionPathOverlayIndex",a))}),S.waitFor(o)}getOverlaysForCollection(e,t,r){let i=xn(),o=St(t),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Ja(e).U("collectionPathOverlayIndex",s).next(a=>{for(let c of a){let l=bm(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let o=xn(),s,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Ja(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,h)=>{let p=bm(this.serializer,l);o.size()<i||p.largestBatchId===s?(o.set(p.getKey(),p),s=p.largestBatchId):h.done()}).next(()=>o)}ht(e,t){return Ja(e).put(function(i,o,s){let[a,c,l]=tT(o,s.mutation.key);return{userId:o,collectionPath:c,documentId:l,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:Iu(i.ct,s.mutation)}}(this.serializer,this.userId,t))}};function Ja(n){return rt(n,"documentOverlays")}var py=class{Pt(e){return rt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let r=t?.value;return r?Ke.fromUint8Array(r):Ke.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var er=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Oe(e.integerValue));else if("doubleValue"in e){let r=Oe(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),lu(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=nr(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Or(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?zT(e)?this.dt(t,Number.MAX_SAFE_INTEGER):rh(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):q()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let s="value",a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Oe(a)),this.Vt(s,t),this.Tt(o[s],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),B.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};er.vt=new er;function FF(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function oT(n){let e=64-function(r){let i=0;for(let o=0;o<8;++o){let s=FF(255&r[o]);if(i+=s,s!==8)break}return i}(n);return Math.ceil(e/8)}var gy=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{let i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){let t=this.qt(e),r=oT(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){let t=this.qt(e),r=oT(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){let t=function(o){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},my=class{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}},yy=class{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}},Ci=class{constructor(){this.jt=new gy,this.Ht=new my(this.jt),this.Jt=new yy(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var Ti=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function Sr(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=sT(n.arrayValue,e.arrayValue),t!==0?t:(t=sT(n.directionalValue,e.directionalValue),t!==0?t:B.comparator(n.documentKey,e.documentKey)))}function sT(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Dd=class{constructor(e){this.Xt=new Re((t,r)=>Ge.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(W(e.collectionGroup===this.collectionId),this.nn)return!1;let t=Vm(e);if(t!==void 0&&!this.sn(t))return!1;let r=Ii(e),i=new Set,o=0,s=0;for(;o<r.length&&this.sn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){let a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[o];if(!this.on(a,c)||!this._n(this.en[s++],c))return!1}++o}for(;o<r.length;++o){let a=r[o];if(s>=this.en.length||!this._n(this.en[s++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Re(Ge.comparator),t=[];for(let r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Jo(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Jo(r.field,0))}for(let r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Jo(r.field,r.dir==="asc"?0:1)));return new ns(ns.UNKNOWN_ID,this.collectionId,t,cu.empty())}sn(e){for(let t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function Rb(n){var e,t;if(W(n instanceof he||n instanceof be),n instanceof he){if(n instanceof fd){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>he.create(n.field,"==",o)))||[];return be.create(i,"or")}return n}let r=n.filters.map(i=>Rb(i));return be.create(r,n.op)}function LF(n){if(n.getFilters().length===0)return[];let e=wy(Rb(n));return W(Mb(e)),vy(e)||_y(e)?[e]:e.getFilters()}function vy(n){return n instanceof he}function _y(n){return n instanceof be&&Ov(n)}function Mb(n){return vy(n)||_y(n)||function(t){if(t instanceof be&&Gm(t)){for(let r of t.getFilters())if(!vy(r)&&!_y(r))return!1;return!0}return!1}(n)}function wy(n){if(W(n instanceof he||n instanceof be),n instanceof he)return n;if(n.filters.length===1)return wy(n.filters[0]);let e=n.filters.map(r=>wy(r)),t=be.create(e,n.op);return t=Cd(t),Mb(t)?t:(W(t instanceof be),W(is(t)),W(t.filters.length>1),t.filters.reduce((r,i)=>Uv(r,i)))}function Uv(n,e){let t;return W(n instanceof he||n instanceof be),W(e instanceof he||e instanceof be),t=n instanceof he?e instanceof he?function(i,o){return be.create([i,o],"and")}(n,e):aT(n,e):e instanceof he?aT(e,n):function(i,o){if(W(i.filters.length>0&&o.filters.length>0),is(i)&&is(o))return YT(i,o.getFilters());let s=Gm(i)?i:o,a=Gm(i)?o:i,c=s.filters.map(l=>Uv(l,a));return be.create(c,"or")}(n,e),Cd(t)}function aT(n,e){if(is(e))return YT(e,n.getFilters());{let t=e.filters.map(r=>Uv(n,r));return be.create(t,"or")}}function Cd(n){if(W(n instanceof he||n instanceof be),n instanceof he)return n;let e=n.getFilters();if(e.length===1)return Cd(e[0]);if(KT(n))return n;let t=e.map(i=>Cd(i)),r=[];return t.forEach(i=>{i instanceof he?r.push(i):i instanceof be&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:be.create(r,n.op)}var Iy=class{constructor(){this.un=new Eu}addToCollectionParentIndex(e,t){return this.un.add(t),S.resolve()}getCollectionParents(e,t){return S.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return S.resolve()}deleteFieldIndex(e,t){return S.resolve()}deleteAllFieldIndexes(e){return S.resolve()}createTargetIndexes(e,t){return S.resolve()}getDocumentsMatchingTarget(e,t){return S.resolve(null)}getIndexType(e,t){return S.resolve(0)}getFieldIndexes(e,t){return S.resolve([])}getNextCollectionGroupToUpdate(e){return S.resolve(null)}getMinOffset(e,t){return S.resolve(Xt.min())}getMinOffsetFromCollectionGroup(e,t){return S.resolve(Xt.min())}updateCollectionGroup(e,t,r){return S.resolve()}updateIndexEntries(e,t){return S.resolve()}},Eu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Re(ye.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Re(ye.comparator)).toArray()}};var Yl=new Uint8Array(0),Ey=class{constructor(e,t){this.databaseId=t,this.cn=new Eu,this.ln=new On(r=>Mi(r),(r,i)=>Mu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});let o={collectionId:r,parent:St(i)};return uT(e).put(o)}return S.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[PT(t),""],!1,!0);return uT(e).U(i).next(o=>{for(let s of o){if(s.collectionId!==t)break;r.push(An(s.parent))}return r})}addFieldIndex(e,t){let r=Xa(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let o=r.add(i);if(t.indexState){let s=qo(e);return o.next(a=>{s.put(nT(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let r=Xa(e),i=qo(e),o=Ho(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Xa(e),r=Ho(e),i=qo(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return S.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let o=new Dd(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let r=Ho(e),i=!0,o=new Map;return S.forEach(this.hn(t),s=>this.Pn(e,s).next(a=>{i&&(i=!!a),o.set(s,a)})).next(()=>{if(i){let s=ie(),a=[];return S.forEach(o,(c,l)=>{k("IndexedDbIndexManager",`Using index ${function(O){return`id=${O.indexId}|cg=${O.collectionGroup}|f=${O.fields.map(Y=>`${Y.fieldPath}:${Y.kind}`).join(",")}`}(c)} to execute ${Mi(t)}`);let h=function(O,Y){let ee=Vm(Y);if(ee===void 0)return null;for(let Z of gd(O,ee.fieldPath))switch(Z.op){case"array-contains-any":return Z.value.arrayValue.values||[];case"array-contains":return[Z.value]}return null}(l,c),p=function(O,Y){let ee=new Map;for(let Z of Ii(Y))for(let I of gd(O,Z.fieldPath))switch(I.op){case"==":case"in":ee.set(Z.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return ee.set(Z.fieldPath.canonicalString(),I.value),Array.from(ee.values())}return null}(l,c),m=function(O,Y){let ee=[],Z=!0;for(let I of Ii(Y)){let y=I.kind===0?U0(O,I.fieldPath,O.startAt):$0(O,I.fieldPath,O.startAt);ee.push(y.value),Z&&(Z=y.inclusive)}return new kn(ee,Z)}(l,c),v=function(O,Y){let ee=[],Z=!0;for(let I of Ii(Y)){let y=I.kind===0?$0(O,I.fieldPath,O.endAt):U0(O,I.fieldPath,O.endAt);ee.push(y.value),Z&&(Z=y.inclusive)}return new kn(ee,Z)}(l,c),b=this.In(c,l,m),M=this.In(c,l,v),N=this.Tn(c,l,p),V=this.En(c.indexId,h,b,m.inclusive,M,v.inclusive,N);return S.forEach(V,H=>r.G(H,t.limit).next(O=>{O.forEach(Y=>{let ee=B.fromSegments(Y.documentKey);s.has(ee)||(s=s.add(ee),a.push(ee))})}))}).next(()=>a)}return S.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=LF(be.create(e.filters,"and")).map(r=>ty(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,o,s,a){let c=(t!=null?t.length:1)*Math.max(r.length,o.length),l=c/(t!=null?t.length:1),h=[];for(let p=0;p<c;++p){let m=t?this.dn(t[p/l]):Yl,v=this.An(e,m,r[p%l],i),b=this.Rn(e,m,o[p%l],s),M=a.map(N=>this.An(e,m,N,!0));h.push(...this.createRange(v,b,M))}return h}An(e,t,r,i){let o=new Ti(e,B.empty(),t,r);return i?o:o.Zt()}Rn(e,t,r,i){let o=new Ti(e,B.empty(),t,r);return i?o.Zt():o}Pn(e,t){let r=new Dd(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(let a of o)r.rn(a)&&(!s||a.fields.length>s.fields.length)&&(s=a);return s})}getIndexType(e,t){let r=2,i=this.hn(t);return S.forEach(i,o=>this.Pn(e,o).next(s=>{s?r!==0&&s.fields.length<function(c){let l=new Re(Ge.comparator),h=!1;for(let p of c.filters)for(let m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:l=l.add(m.field));for(let p of c.orderBy)p.field.isKeyField()||(l=l.add(p.field));return l.size+(h?1:0)}(o)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){let r=new Ci;for(let i of Ii(e)){let o=t.data.field(i.fieldPath);if(o==null)return null;let s=r.Yt(i.kind);er.vt.It(o,s)}return r.zt()}dn(e){let t=new Ci;return er.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){let r=new Ci;return er.vt.It(xi(this.databaseId,t),r.Yt(function(o){let s=Ii(o);return s.length===0?0:s[s.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new Ci);let o=0;for(let s of Ii(e)){let a=r[o++];for(let c of i)if(this.fn(t,s.fieldPath)&&pu(a))i=this.gn(i,s,a);else{let l=c.Yt(s.kind);er.vt.It(a,l)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){let i=[...e],o=[];for(let s of r.arrayValue.values||[])for(let a of i){let c=new Ci;c.seed(a.zt()),er.vt.It(s,c.Yt(t.kind)),o.push(c)}return o}fn(e,t){return!!e.filters.find(r=>r instanceof he&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Xa(e),i=qo(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(o=>{let s=[];return S.forEach(o,a=>i.get([a.indexId,this.uid]).next(c=>{s.push(function(h,p){let m=p?new cu(p.sequenceNumber,new Xt(ki(p.readTime),new B(An(p.documentKey)),p.largestBatchId)):cu.empty(),v=h.fields.map(([b,M])=>new Jo(Ge.fromServerFormat(b),M));return new ns(h.indexId,h.collectionGroup,v,m)}(a,c))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:re(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Xa(e),o=qo(e);return this.yn(e).next(s=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>S.forEach(a,c=>o.put(nT(c.indexId,this.uid,s,r)))))}updateIndexEntries(e,t){let r=new Map;return S.forEach(t,(i,o)=>{let s=r.get(i.collectionGroup);return(s?S.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),S.forEach(a,c=>this.wn(e,i,c).next(l=>{let h=this.Sn(o,c);return l.isEqual(h)?S.resolve():this.bn(e,o,c,l,h)}))))})}Dn(e,t,r,i){return Ho(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return Ho(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){let i=Ho(e),o=new Re(Sr);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(s,a)=>{o=o.add(new Ti(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>o)}Sn(e,t){let r=new Re(Sr),i=this.Vn(t,e);if(i==null)return r;let o=Vm(t);if(o!=null){let s=e.data.field(o.fieldPath);if(pu(s))for(let a of s.arrayValue.values||[])r=r.add(new Ti(t.indexId,e.key,this.dn(a),i))}else r=r.add(new Ti(t.indexId,e.key,Yl,i));return r}bn(e,t,r,i,o){k("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let s=[];return function(c,l,h,p,m){let v=c.getIterator(),b=l.getIterator(),M=$o(v),N=$o(b);for(;M||N;){let V=!1,H=!1;if(M&&N){let O=h(M,N);O<0?H=!0:O>0&&(V=!0)}else M!=null?H=!0:V=!0;V?(p(N),N=$o(b)):H?(m(M),M=$o(v)):(M=$o(v),N=$o(b))}}(i,o,Sr,a=>{s.push(this.Dn(e,t,r,a))},a=>{s.push(this.vn(e,t,r,a))}),S.waitFor(s)}yn(e){let t=1;return qo(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((s,a)=>Sr(s,a)).filter((s,a,c)=>!a||Sr(s,c[a-1])!==0);let i=[];i.push(e);for(let s of r){let a=Sr(s,e),c=Sr(s,t);if(a===0)i[0]=e.Zt();else if(a>0&&c<0)i.push(s),i.push(s.Zt());else if(c>0)break}i.push(t);let o=[];for(let s=0;s<i.length;s+=2){if(this.Cn(i[s],i[s+1]))return[];let a=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,Yl,[]],c=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,Yl,[]];o.push(IDBKeyRange.bound(a,c))}return o}Cn(e,t){return Sr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(cT)}getMinOffset(e,t){return S.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||q())).next(cT)}};function uT(n){return rt(n,"collectionParents")}function Ho(n){return rt(n,"indexEntries")}function Xa(n){return rt(n,"indexConfiguration")}function qo(n){return rt(n,"indexState")}function cT(n){W(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;Mv(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Xt(e.readTime,e.documentKey,t)}var lT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Jt=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function Nb(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),o=[],s=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:s},(h,p,m)=>(a++,m.delete()));o.push(c.next(()=>{W(a===1)}));let l=[];for(let h of t.mutations){let p=jT(e,h.key.path,t.batchId);o.push(i.delete(p)),l.push(h.key)}return S.waitFor(o).next(()=>l)}function Td(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw q();e=n.noDocument}return JSON.stringify(e).length}Jt.DEFAULT_COLLECTION_PERCENTILE=10,Jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jt.DEFAULT=new Jt(41943040,Jt.DEFAULT_COLLECTION_PERCENTILE,Jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jt.DISABLED=new Jt(-1,0,0);var bd=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){W(e.uid!=="");let o=e.isAuthenticated()?e.uid:"";return new n(o,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ar(e).J({index:"userMutationsIndex",range:r},(i,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let o=Yo(e),s=Ar(e);return s.add({}).next(a=>{W(typeof a=="number");let c=new mu(a,t,r,i),l=function(v,b,M){let N=M.baseMutations.map(H=>Iu(v.ct,H)),V=M.mutations.map(H=>Iu(v.ct,H));return{userId:b,batchId:M.batchId,localWriteTimeMs:M.localWriteTime.toMillis(),baseMutations:N,mutations:V}}(this.serializer,this.userId,c),h=[],p=new Re((m,v)=>re(m.canonicalString(),v.canonicalString()));for(let m of i){let v=jT(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),h.push(s.put(l)),h.push(o.put(v,HO))}return p.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[a]=c.keys()}),S.waitFor(h).next(()=>c)})}lookupMutationBatch(e,t){return Ar(e).get(t).next(r=>r?(W(r.userId===this.userId),Di(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?S.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ar(e).J({index:"userMutationsIndex",range:i},(s,a,c)=>{a.userId===this.userId&&(W(a.batchId>=r),o=Di(this.serializer,a)),c.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Ar(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ar(e).U("userMutationsIndex",t).next(r=>r.map(i=>Di(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=ed(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return Yo(e).J({range:i},(s,a,c)=>{let[l,h,p]=s,m=An(h);if(l===this.userId&&t.path.isEqual(m))return Ar(e).get(p).next(v=>{if(!v)throw q();W(v.userId===this.userId),o.push(Di(this.serializer,v))});c.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(re),i=[];return t.forEach(o=>{let s=ed(this.userId,o.path),a=IDBKeyRange.lowerBound(s),c=Yo(e).J({range:a},(l,h,p)=>{let[m,v,b]=l,M=An(v);m===this.userId&&o.path.isEqual(M)?r=r.add(b):p.done()});i.push(c)}),S.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=ed(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Re(re);return Yo(e).J({range:s},(c,l,h)=>{let[p,m,v]=c,b=An(m);p===this.userId&&r.isPrefixOf(b)?b.length===i&&(a=a.add(v)):h.done()}).next(()=>this.xn(e,a))}xn(e,t){let r=[],i=[];return t.forEach(o=>{i.push(Ar(e).get(o).next(s=>{if(s===null)throw q();W(s.userId===this.userId),r.push(Di(this.serializer,s))}))}),S.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return Nb(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),S.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return S.resolve();let r=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return Yo(e).J({range:r},(o,s,a)=>{if(o[0]===this.userId){let c=An(o[1]);i.push(c)}else a.done()}).next(()=>{W(i.length===0)})})}containsKey(e,t){return Pb(e,this.userId,t)}Nn(e){return kb(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function Pb(n,e,t){let r=ed(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Yo(n).J({range:o,H:!0},(a,c,l)=>{let[h,p,m]=a;h===e&&p===i&&(s=!0),l.done()}).next(()=>s)}function Ar(n){return rt(n,"mutations")}function Yo(n){return rt(n,"documentMutations")}function kb(n){return rt(n,"mutationQueues")}var cs=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var Dy=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{let r=new cs(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>K.fromTimestamp(new Ve(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>zo(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(W(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0,o=[];return zo(e).J((s,a)=>{let c=ru(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,o.push(this.removeTargetData(e,c)))}).next(()=>S.waitFor(o)).next(()=>i)}forEachTarget(e,t){return zo(e).J((r,i)=>{let o=ru(i);t(o)})}qn(e){return dT(e).get("targetGlobalKey").next(t=>(W(t!==null),t))}Qn(e,t){return dT(e).put("targetGlobalKey",t)}Kn(e,t){return zo(e).put(xb(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=Mi(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return zo(e).J({range:i,index:"queryTargetsIndex"},(s,a,c)=>{let l=ru(a);Mu(t,l.target)&&(o=l,c.done())}).next(()=>o)}addMatchingKeys(e,t,r){let i=[],o=xr(e);return t.forEach(s=>{let a=St(s.path);i.push(o.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,s))}),S.waitFor(i)}removeMatchingKeys(e,t,r){let i=xr(e);return S.forEach(t,o=>{let s=St(o.path);return S.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){let r=xr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=xr(e),o=ie();return i.J({range:r,H:!0},(s,a,c)=>{let l=An(s[1]),h=new B(l);o=o.add(h)}).next(()=>o)}containsKey(e,t){let r=St(t.path),i=IDBKeyRange.bound([r],[PT(r)],!1,!0),o=0;return xr(e).J({index:"documentTargetsIndex",H:!0,range:i},([s,a],c,l)=>{s!==0&&(o++,l.done())}).next(()=>o>0)}ot(e,t){return zo(e).get(t).next(r=>r?ru(r):null)}};function zo(n){return rt(n,"targets")}function dT(n){return rt(n,"targetGlobal")}function xr(n){return rt(n,"targetDocuments")}function hT([n,e],[t,r]){let i=re(n,t);return i===0?re(e,r):i}var Cy=class{constructor(e){this.Un=e,this.buffer=new Re(hT),this.Wn=0}Gn(){return++this.Wn}zn(e){let t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();hT(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Ty=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){k("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>R(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){qr(t)?k("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield Hr(t)}yield this.Hn(3e5)}))}},by=class{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return S.resolve(jt.oe);let r=new Cy(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(k("LruGarbageCollector","Garbage collection skipped; disabled"),S.resolve(lT)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(k("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),lT):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,o,s,a,c,l,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(k("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,s=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,t))).next(p=>(o=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(l=Date.now(),Go()<=yn.DEBUG&&k("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(c-a)+`ms
	Removed ${p} documents in `+(l-c)+`ms
Total Duration: ${l-h}ms`),S.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}};function VF(n,e){return new by(n,e)}var Sy=class{constructor(e,t){this.db=e,this.garbageCollector=VF(this,t)}Yn(e){let t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return Zl(e,r)}removeReference(e,t,r){return Zl(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Zl(e,t)}nr(e,t){return function(i,o){let s=!1;return kb(i).Y(a=>Pb(i,a,o).next(c=>(c&&(s=!0),S.resolve(!c)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.tr(e,(s,a)=>{if(a<=t){let c=this.nr(e,s).next(l=>{if(!l)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,K.min()),xr(e).delete(function(p){return[0,St(p.path)]}(s))))});i.push(c)}}).next(()=>S.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Zl(e,t)}tr(e,t){let r=xr(e),i,o=jt.oe;return r.J({index:"documentTargetsIndex"},([s,a],{path:c,sequenceNumber:l})=>{s===0?(o!==jt.oe&&t(new B(An(i)),o),o=l,i=c):o=jt.oe}).next(()=>{o!==jt.oe&&t(new B(An(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Zl(n,e){return xr(n).put(function(r,i){return{targetId:0,path:St(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var Sd=class{constructor(){this.changes=new On(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Xe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?S.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Ay=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return wi(e).put(r)}removeEntry(e,t,r){return wi(e).delete(function(o,s){let a=o.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Id(s),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=Xe.newInvalidDocument(t);return wi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(eu(t))},(i,o)=>{r=this.ir(t,o)}).next(()=>r)}sr(e,t){let r={size:0,document:Xe.newInvalidDocument(t)};return wi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(eu(t))},(i,o)=>{r={document:this.ir(t,o),size:Td(o)}}).next(()=>r)}getEntries(e,t){let r=Pt();return this._r(e,t,(i,o)=>{let s=this.ir(i,o);r=r.insert(i,s)}).next(()=>r)}ar(e,t){let r=Pt(),i=new ke(B.comparator);return this._r(e,t,(o,s)=>{let a=this.ir(o,s);r=r.insert(o,a),i=i.insert(o,Td(s))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return S.resolve();let i=new Re(gT);t.forEach(c=>i=i.add(c));let o=IDBKeyRange.bound(eu(i.first()),eu(i.last())),s=i.getIterator(),a=s.getNext();return wi(e).J({index:"documentKeyIndex",range:o},(c,l,h)=>{let p=B.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&gT(a,p)<0;)r(a,null),a=s.getNext();a&&a.isEqual(p)&&(r(a,l),a=s.hasNext()?s.getNext():null),a?h.$(eu(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,o){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),Id(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return wi(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{o?.incrementDocumentReadCount(l.length);let h=Pt();for(let p of l){let m=this.ir(B.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Pu(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,t,r,i){let o=Pt(),s=pT(t,r),a=pT(t,Xt.max());return wi(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,a,!0)},(c,l,h)=>{let p=this.ir(B.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);o=o.insert(p.key,p),o.size===i&&h.done()}).next(()=>o)}newChangeBuffer(e){return new xy(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return fT(e).get("remoteDocumentGlobalKey").next(t=>(W(!!t),t))}rr(e,t){return fT(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){let r=OF(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(K.min())))return r}return Xe.newInvalidDocument(e)}};function Ob(n){return new Ay(n)}var xy=class extends Sd{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new On(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Re((o,s)=>re(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{let a=this.lr.get(o);if(t.push(this.cr.removeEntry(e,o,a.readTime)),s.isValidDocument()){let c=eT(this.cr.serializer,s);i=i.add(o.path.popLast());let l=Td(c);r+=l-a.size,t.push(this.cr.addEntry(e,o,c))}else if(r-=a.size,this.trackRemovals){let c=eT(this.cr.serializer,s.convertToNoDocument(K.min()));t.push(this.cr.addEntry(e,o,c))}}),i.forEach(o=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.cr.updateMetadata(e,r)),S.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((o,s)=>{this.lr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}};function fT(n){return rt(n,"remoteDocumentGlobal")}function wi(n){return rt(n,"remoteDocumentsV14")}function eu(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function pT(n,e){let t=e.documentKey.path.toArray();return[n,Id(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function gT(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=re(t[o],r[o]),i)return i;return i=re(t.length,r.length),i||(i=re(t[t.length-2],r[r.length-2]),i||re(t[t.length-1],r[r.length-1]))}var Ry=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Ad=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&su(r.mutation,i,Bt.empty(),Ve.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ie()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ie()){let i=xn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=nu();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=xn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ie()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=Pt(),s=ou(),a=function(){return ou()}();return t.forEach((c,l)=>{let h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof pn)?o=o.insert(l.key,l):h!==void 0?(s.set(l.key,h.mutation.getFieldMask()),su(h.mutation,l,h.mutation.getFieldMask(),Ve.now())):s.set(l.key,Bt.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((l,h)=>s.set(l,h)),t.forEach((l,h)=>{var p;return a.set(l,new Ry(h,(p=s.get(l))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){let r=ou(),i=new ke((s,a)=>s-a),o=ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let h=r.get(c)||Bt.empty();h=a.applyToLocalView(l,h),r.set(c,h);let p=(i.get(a.batchId)||ie()).add(c);i=i.insert(a.batchId,p)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,h=c.value,p=ob();h.forEach(m=>{if(!o.has(m)){let v=hb(t.get(m),r.get(m));v!==null&&p.set(m,v),o=o.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,p))}return S.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return B.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Fv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):S.resolve(xn()),a=-1,c=o;return s.next(l=>S.forEach(l,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),o.get(h)?S.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{c=c.insert(h,m)}))).next(()=>this.populateOverlays(e,l,o)).next(()=>this.computeViews(e,c,l,ie())).next(h=>({batchId:a,changes:ib(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=nu();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=nu();return this.indexManager.getCollectionParents(e,o).next(a=>S.forEach(a,c=>{let l=function(p,m){return new fn(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(h=>{h.forEach((p,m)=>{s=s.insert(p,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((c,l)=>{let h=l.getKey();s.get(h)===null&&(s=s.insert(h,Xe.newInvalidDocument(h)))});let a=nu();return s.forEach((c,l)=>{let h=o.get(c);h!==void 0&&su(h.mutation,l,Bt.empty(),Ve.now()),Pu(t,l)&&(a=a.insert(c,l))}),a})}};var My=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return S.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:We(i.createTime)}}(t)),S.resolve()}getNamedQuery(e,t){return S.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:Bv(i.bundledQuery),readTime:We(i.readTime)}}(t)),S.resolve()}};var Ny=class{constructor(){this.overlays=new ke(B.comparator),this.Ir=new Map}getOverlay(e,t){return S.resolve(this.overlays.get(t))}getOverlays(e,t){let r=xn();return S.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),S.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),S.resolve()}getOverlaysForCollection(e,t,r){let i=xn(),o=t.length+1,s=new B(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&c.largestBatchId>r&&i.set(c.getKey(),c)}return S.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new ke((l,h)=>l-h),s=this.overlays.getIterator();for(;s.hasNext();){let l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let h=o.get(l.largestBatchId);h===null&&(h=xn(),o=o.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let a=xn(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,h)=>a.set(l,h)),!(a.size()>=i)););return S.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new yu(t,r));let o=this.Ir.get(t);o===void 0&&(o=ie(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var Py=class{constructor(){this.sessionToken=Ke.EMPTY_BYTE_STRING}getSessionToken(e){return S.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,S.resolve()}};var Du=class{constructor(){this.Tr=new Re(Ze.Er),this.dr=new Re(Ze.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new Ze(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new Ze(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new B(new ye([])),r=new Ze(t,e),i=new Ze(t,e+1),o=[];return this.dr.forEachInRange([r,i],s=>{this.Vr(s),o.push(s.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new B(new ye([])),r=new Ze(t,e),i=new Ze(t,e+1),o=ie();return this.dr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new Ze(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ze=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return B.comparator(e.key,t.key)||re(e.wr,t.wr)}static Ar(e,t){return re(e.wr,t.wr)||B.comparator(e.key,t.key)}};var ky=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Re(Ze.Er)}checkEmpty(e){return S.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new mu(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.br=this.br.add(new Ze(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return S.resolve(s)}lookupMutationBatch(e,t){return S.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return S.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return S.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return S.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ze(t,0),i=new Ze(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],s=>{let a=this.Dr(s.wr);o.push(a)}),S.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(re);return t.forEach(i=>{let o=new Ze(i,0),s=new Ze(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,s],a=>{r=r.add(a.wr)})}),S.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;B.isDocumentKey(o)||(o=o.child(""));let s=new Ze(new B(o),0),a=new Re(re);return this.br.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.wr)),!0)},s),S.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){W(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return S.forEach(t.mutations,i=>{let o=new Ze(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new Ze(t,0),i=this.br.firstAfterOrEqual(r);return S.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,S.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Oy=class{constructor(e){this.Mr=e,this.docs=function(){return new ke(B.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return S.resolve(r?r.document.mutableCopy():Xe.newInvalidDocument(t))}getEntries(e,t){let r=Pt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Xe.newInvalidDocument(i))}),S.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Pt(),s=t.path,a=new B(s.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:h}}=c.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||Mv(OT(h),r)<=0||(i.has(h.key)||Pu(t,h))&&(o=o.insert(h.key,h.mutableCopy()))}return S.resolve(o)}getAllFromCollectionGroup(e,t,r,i){q()}Or(e,t){return S.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Fy(this)}getSize(e){return S.resolve(this.size)}},Fy=class extends Sd{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),S.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Ly=class{constructor(e){this.persistence=e,this.Nr=new On(t=>Mi(t),Mu),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Du,this.targetCount=0,this.kr=cs.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),S.resolve()}getLastRemoteSnapshotVersion(e){return S.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return S.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),S.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),S.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new cs(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,S.resolve()}updateTargetData(e,t){return this.Kn(t),S.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,S.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),S.waitFor(o).next(()=>i)}getTargetCount(e){return S.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return S.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),S.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),S.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),S.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return S.resolve(r)}containsKey(e,t){return S.resolve(this.Br.containsKey(t))}};var xd=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new jt(0),this.Kr=!1,this.Kr=!0,this.$r=new Py,this.referenceDelegate=e(this),this.Ur=new Ly(this),this.indexManager=new Iy,this.remoteDocumentCache=function(i){return new Oy(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new wd(t),this.Gr=new My(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ny,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new ky(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){k("MemoryPersistence","Starting transaction:",e);let i=new Vy(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return S.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Vy=class extends ud{constructor(e){super(),this.currentSequenceNumber=e}},Rd=class n{constructor(e){this.persistence=e,this.Jr=new Du,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw q()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),S.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),S.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),S.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return S.forEach(this.Xr,r=>{let i=B.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,K.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return S.or([()=>S.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var jy=class{constructor(e){this.serializer=e}O(e,t,r,i){let o=new cd("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",M0,{unique:!0}),c.createObjectStore("documentMutations")}(e),mT(e),function(c){c.createObjectStore("remoteDocuments")}(e));let s=S.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),mT(e)),s=s.next(()=>function(c){let l=c.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:K.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",h)}(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>function(c,l){return l.store("mutations").U().next(h=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",M0,{unique:!0});let p=l.store("mutations"),m=h.map(v=>p.put(v));return S.waitFor(m)})}(e,o))),s=s.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.ni(o))),r<6&&i>=6&&(s=s.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(o)))),r<7&&i>=7&&(s=s.next(()=>this.ii(o))),r<8&&i>=8&&(s=s.next(()=>this.si(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.oi(o))),r<11&&i>=11&&(s=s.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:tF});l.createIndex("collectionPathOverlayIndex",nF,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",rF,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:qO});l.createIndex("documentKeyIndex",zO),l.createIndex("collectionGroupIndex",GO)}(e)).next(()=>this._i(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(s=s.next(()=>this.ai(e,o))),r<15&&i>=15&&(s=s.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:ZO}).createIndex("sequenceNumberIndex",JO,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:XO}).createIndex("documentKeyIndex",eF,{unique:!1})}(e))),r<16&&i>=16&&(s=s.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),s}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=Td(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>S.forEach(i,o=>{let s=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",s).next(a=>S.forEach(a,c=>{W(c.userId===o.userId);let l=Di(this.serializer,c);return Nb(e,o.userId,l).next(()=>{})}))}))}ii(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let o=[];return r.J((s,a)=>{let c=new ye(s),l=function(p){return[0,St(p)]}(c);o.push(t.get(l).next(h=>h?S.resolve():(p=>t.put({targetId:0,path:St(p),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>S.waitFor(o))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:YO});let r=t.store("collectionParents"),i=new Eu,o=s=>{if(i.add(s)){let a=s.lastSegment(),c=s.popLast();return r.put({collectionId:a,parent:St(c)})}};return t.store("remoteDocuments").J({H:!0},(s,a)=>{let c=new ye(s);return o(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([s,a,c],l)=>{let h=An(a);return o(h.popLast())}))}oi(e){let t=e.store("targets");return t.J((r,i)=>{let o=ru(i),s=xb(this.serializer,o);return t.put(s)})}_i(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((o,s)=>{let a=t.store("remoteDocumentsV14"),c=function(p){return p.document?new B(ye.fromString(p.document.name).popFirst(5)):p.noDocument?B.fromSegments(p.noDocument.path):p.unknownDocument?B.fromSegments(p.unknownDocument.path):q()}(s).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(a.put(l))}).next(()=>S.waitFor(i))}ai(e,t){let r=t.store("mutations"),i=Ob(this.serializer),o=new xd(Rd.Zr,this.serializer.ct);return r.U().next(s=>{let a=new Map;return s.forEach(c=>{var l;let h=(l=a.get(c.userId))!==null&&l!==void 0?l:ie();Di(this.serializer,c).keys().forEach(p=>h=h.add(p)),a.set(c.userId,h)}),S.forEach(a,(c,l)=>{let h=new Je(l),p=Ed.lt(this.serializer,h),m=o.getIndexManager(h),v=bd.lt(h,this.serializer,m,o.referenceDelegate);return new Ad(i,v,p,m).recalculateAndSaveOverlaysForDocumentKeys(new du(t,jt.oe),c).next()})})}};function mT(n){n.createObjectStore("targetDocuments",{keyPath:KO}).createIndex("documentTargetsIndex",QO,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",WO,{unique:!0}),n.createObjectStore("targetGlobal")}var Sm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",By=class n{constructor(e,t,r,i,o,s,a,c,l,h,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=o,this.window=s,this.document=a,this.ci=l,this.li=h,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!n.D())throw new P(x.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Sy(this,i),this.Ai=t+"main",this.serializer=new wd(c),this.Ri=new kr(this.Ai,this.hi,new jy(this.serializer)),this.$r=new py,this.Ur=new Dy(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Ob(this.serializer),this.Gr=new fy,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&ze("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new P(x.FAILED_PRECONDITION,Sm);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new jt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=t=>R(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(t=>R(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(()=>R(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Jl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(qr(e))return k("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return k("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return tu(e).get("owner").next(t=>S.resolve(this.vi(t)))}Ci(e){return Jl(e).delete(this.clientId)}Fi(){return R(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=rt(t,"clientMetadata");return r.U().next(i=>{let o=this.xi(i,18e5),s=i.filter(a=>o.indexOf(a)===-1);return S.forEach(s,a=>r.delete(a.clientId)).next(()=>s)})}).catch(()=>[]);if(this.Vi)for(let t of e)this.Vi.removeItem(this.Oi(t.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?S.resolve(!0):tu(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new P(x.FAILED_PRECONDITION,Sm);return!1}}return!(!this.networkEnabled||!this.inForeground)||Jl(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(o||s&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&k("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return R(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new du(e,jt.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()})}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Jl(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return bd.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Ey(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Ed.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){k("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",o=function(c){return c===17?sF:c===16?oF:c===15?Pv:c===14?$T:c===13?UT:c===12?iF:c===11?BT:void q()}(this.hi),s;return this.Ri.runTransaction(e,i,o,a=>(s=new du(a,this.Qr?this.Qr.next():jt.oe),t==="readwrite-primary"?this.wi(s).next(c=>!!c||this.Si(s)).next(c=>{if(!c)throw ze(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new P(x.FAILED_PRECONDITION,FT);return r(s)}).next(c=>this.Di(s).next(()=>c)):this.Ki(s).next(()=>r(s)))).then(a=>(s.raiseOnCommittedEvent(),a))}Ki(e){return tu(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new P(x.FAILED_PRECONDITION,Sm)})}Di(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return tu(e).put("owner",t)}static D(){return kr.D()}bi(e){let t=tu(e);return t.get("owner").next(r=>this.vi(r)?(k("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):S.resolve())}Mi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(ze(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let t=/(?:Version|Mobile)\/1[456]/;sf()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{let r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return k("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ze("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){ze("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function tu(n){return rt(n,"owner")}function Jl(n){return rt(n,"clientMetadata")}function $v(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var Uy=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=ie(),i=ie();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var $y=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Md=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return sf()?8:LT(Qs())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new $y;return this.Xi(e,t,s).next(a=>{if(o.result=a,this.zi)return this.es(e,t,s,a.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Go()<=yn.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",Wo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),S.resolve()):(Go()<=yn.DEBUG&&k("QueryEngine","Query:",Wo(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Go()<=yn.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",Wo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,At(t))):S.resolve())}Yi(e,t){if(H0(t))return S.resolve(null);let r=At(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=md(t,null,"F"),r=At(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=ie(...o);return this.Ji.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.ts(t,a);return this.ns(t,l,s,c.readTime)?this.Yi(e,md(t,null,"F")):this.rs(e,l,t,c)}))})))}Zi(e,t,r,i){return H0(t)||i.isEqual(K.min())?S.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let s=this.ts(t,o);return this.ns(t,s,r,i)?S.resolve(null):(Go()<=yn.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Wo(t)),this.rs(e,s,t,kT(i,-1)).next(a=>a))})}ts(e,t){let r=new Re(nb(e));return t.forEach((i,o)=>{Pu(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return Go()<=yn.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",Wo(t)),this.Ji.getDocumentsMatchingQuery(e,t,Xt.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var Hy=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new ke(re),this._s=new On(o=>Mi(o),Mu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ad(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function Fb(n,e,t,r){return new Hy(n,e,t,r)}function Lb(n,e){return R(this,null,function*(){let t=j(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],c=ie();for(let l of i){s.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}for(let l of o){a.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}return t.localDocuments.getDocuments(r,c).next(l=>({hs:l,removedBatchIds:s,addedBatchIds:a}))})})})}function jF(n,e){let t=j(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,c,l,h){let p=l.batch,m=p.keys(),v=S.resolve();return m.forEach(b=>{v=v.next(()=>h.getEntry(c,b)).next(M=>{let N=l.docVersions.get(b);W(N!==null),M.version.compareTo(N)<0&&(p.applyToRemoteDocument(M,l),M.isValidDocument()&&(M.setReadTime(l.commitVersion),h.addEntry(M)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(c,p))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ie();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Vb(n){let e=j(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function BF(n,e){let t=j(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let a=[];e.targetChanges.forEach((h,p)=>{let m=i.get(p);if(!m)return;a.push(t.Ur.removeMatchingKeys(o,h.removedDocuments,p).next(()=>t.Ur.addMatchingKeys(o,h.addedDocuments,p)));let v=m.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?v=v.withResumeToken(Ke.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),i=i.insert(p,v),function(M,N,V){return M.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=3e8?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0}(m,v,h)&&a.push(t.Ur.updateTargetData(o,v))});let c=Pt(),l=ie();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,h))}),a.push(jb(o,s,e.documentUpdates).next(h=>{c=h.Ps,l=h.Is})),!r.isEqual(K.min())){let h=t.Ur.getLastRemoteSnapshotVersion(o).next(p=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(h)}return S.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,l)).next(()=>c)}).then(o=>(t.os=i,o))}function jb(n,e,t){let r=ie(),i=ie();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=Pt();return t.forEach((a,c)=>{let l=o.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(K.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):k("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Ps:s,Is:i}})}function UF(n,e){let t=j(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ls(n,e){let t=j(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,S.resolve(i)):t.Ur.allocateTargetId(r).next(s=>(i=new us(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function ds(n,e,t){return R(this,null,function*(){let r=j(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!qr(s))throw s;k("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Nd(n,e,t){let r=j(n),i=K.min(),o=ie();return r.persistence.runTransaction("Execute query","readwrite",s=>function(c,l,h){let p=j(c),m=p._s.get(h);return m!==void 0?S.resolve(p.os.get(m)):p.Ur.getTargetData(l,h)}(r,s,At(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>r.ss.getDocumentsMatchingQuery(s,e,t?i:K.min(),t?o:ie())).next(a=>($b(r,tb(e),a),{documents:a,Ts:o})))}function Bb(n,e){let t=j(n),r=j(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>r.ot(o,e).next(s=>s?s.target:null))}function Ub(n,e){let t=j(n),r=t.us.get(e)||K.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,kT(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>($b(t,e,i),i))}function $b(n,e,t){let r=n.us.get(e)||K.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}function $F(n,e,t,r){return R(this,null,function*(){let i=j(n),o=ie(),s=Pt();for(let l of t){let h=e.Es(l.metadata.name);l.document&&(o=o.add(h));let p=e.ds(l);p.setReadTime(e.As(l.metadata.readTime)),s=s.insert(h,p)}let a=i.cs.newChangeBuffer({trackRemovals:!0}),c=yield ls(i,function(h){return At(_s(ye.fromString(`__bundle__/docs/${h}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>jb(l,a,s).next(h=>(a.apply(l),h)).next(h=>i.Ur.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Ur.addMatchingKeys(l,o,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,h.Ps,h.Is)).next(()=>h.Ps)))})}function HF(r,i){return R(this,arguments,function*(n,e,t=ie()){let o=yield ls(n,At(Bv(e.bundledQuery))),s=j(n);return s.persistence.runTransaction("Save named query","readwrite",a=>{let c=We(e.readTime);if(o.snapshotVersion.compareTo(c)>=0)return s.Gr.saveNamedQuery(a,e);let l=o.withResumeToken(Ke.EMPTY_BYTE_STRING,c);return s.os=s.os.insert(l.targetId,l),s.Ur.updateTargetData(a,l).next(()=>s.Ur.removeMatchingKeysForTargetId(a,o.targetId)).next(()=>s.Ur.addMatchingKeys(a,t,o.targetId)).next(()=>s.Gr.saveNamedQuery(a,e))})})}function yT(n,e){return`firestore_clients_${n}_${e}`}function vT(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Am(n,e){return`firestore_targets_${n}_${e}`}var Pd=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){let i=JSON.parse(r),o,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(o=new P(i.error.code,i.error.message))),s?new n(e,t,i.state,o):(ze("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},au=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){let r=JSON.parse(t),i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new P(r.error.code,r.error.message))),o?new n(e,r.state,i):(ze("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},kd=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=Lv();for(let s=0;i&&s<r.activeTargetIds.length;++s)i=VT(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new n(e,o):(ze("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},qy=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(ze("SharedClientState",`Failed to parse online state: ${e}`),null)}},Cu=class{constructor(){this.activeTargetIds=Lv()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},uu=class{constructor(e,t,r,i,o){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new ke(re),this.started=!1,this.bs=[];let s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=yT(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Cu),this.Cs=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){return R(this,null,function*(){let e=yield this.syncEngine.Qi();for(let r of e){if(r===this.ps)continue;let i=this.getItem(yT(this.persistenceKey,r));if(i){let o=kd.Rs(r,i);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();let t=this.storage.getItem(this.xs);if(t){let r=this.Ls(t);r&&this.Bs(r)}for(let r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(Am(this.persistenceKey,e));if(i){let o=au.Rs(e,i);o&&(r=o.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Am(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return k("SharedClientState","READ",e,t),t}setItem(e,t){k("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){k("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){let t=e;if(t.storageArea===this.storage){if(k("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void ze("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>R(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let r=this.Gs(t.key);return this.zs(r,null)}{let r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){let r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){let r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){let r=function(o){let s=jt.oe;if(o!=null)try{let a=JSON.parse(o);W(typeof a=="number"),s=a}catch(a){ze("SharedClientState","Failed to read sequence number from WebStorage",a)}return s}(t.newValue);r!==jt.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){let r=this.Xs(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){let i=new Pd(this.currentUser,e,t,r),o=vT(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Vs())}Qs(e){let t=vT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){let t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){let i=Am(this.persistenceKey,e),o=new au(e,t,r);this.setItem(i,o.Vs())}Ws(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){let t=this.Cs.exec(e);return t?t[1]:null}js(e,t){let r=this.Gs(e);return kd.Rs(r,t)}Hs(e,t){let r=this.Fs.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return Pd.Rs(new Je(o),i,t)}Ys(e,t){let r=this.Ms.exec(e),i=Number(r[1]);return au.Rs(i,t)}Ls(e){return qy.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){return R(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);k("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){let r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),o=this.ks(r),s=[],a=[];return o.forEach(c=>{i.has(c)||s.push(c)}),i.forEach(c=>{o.has(c)||a.push(c)}),this.syncEngine.io(s,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Lv();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Od=class{constructor(){this.so=new Cu,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Cu,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var zy=class{_o(e){}shutdown(){}};var Fd=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){k("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){k("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Xl=null;function xm(){return Xl===null?Xl=function(){return 268435456+Math.round(2147483648*Math.random())}():Xl++,"0x"+Xl.toString(16)}var qF={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Gy=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var vt="WebChannelConnection",Wy=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,s){let a=xm(),c=this.xo(t,r.toUriEncodedString());k("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,o,s),this.No(t,c,l,i).then(h=>(k("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw hn("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",c,"request:",i),h})}Lo(t,r,i,o,s,a){return this.Mo(t,r,i,o,s)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+vs}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>t[s]=o),i&&i.headers.forEach((o,s)=>t[s]=o)}xo(t,r){let i=qF[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=xm();return new Promise((s,a)=>{let c=new Im;c.setWithCredentials(!0),c.listenOnce(Em.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Za.NO_ERROR:let h=c.getResponseJson();k(vt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),s(h);break;case Za.TIMEOUT:k(vt,`RPC '${e}' ${o} timed out`),a(new P(x.DEADLINE_EXCEEDED,"Request time out"));break;case Za.HTTP_ERROR:let p=c.getStatus();if(k(vt,`RPC '${e}' ${o} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);let v=m?.error;if(v&&v.status&&v.message){let b=function(N){let V=N.toLowerCase().replace(/_/g,"-");return Object.values(x).indexOf(V)>=0?V:x.UNKNOWN}(v.status);a(new P(b,v.message))}else a(new P(x.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new P(x.UNAVAILABLE,"Connection failed."));break;default:q()}}finally{k(vt,`RPC '${e}' ${o} completed.`)}});let l=JSON.stringify(i);k(vt,`RPC '${e}' ${o} sending request:`,i),c.send(t,"POST",l,r,15)})}Bo(e,t,r){let i=xm(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Tm(),a=Cm(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let h=o.join("");k(vt,`Creating RPC '${e}' stream ${i}: ${h}`,c);let p=s.createWebChannel(h,c),m=!1,v=!1,b=new Gy({Io:N=>{v?k(vt,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(m||(k(vt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),k(vt,`RPC '${e}' stream ${i} sending:`,N),p.send(N))},To:()=>p.close()}),M=(N,V,H)=>{N.listen(V,O=>{try{H(O)}catch(Y){setTimeout(()=>{throw Y},0)}})};return M(p,Uo.EventType.OPEN,()=>{v||(k(vt,`RPC '${e}' stream ${i} transport opened.`),b.yo())}),M(p,Uo.EventType.CLOSE,()=>{v||(v=!0,k(vt,`RPC '${e}' stream ${i} transport closed`),b.So())}),M(p,Uo.EventType.ERROR,N=>{v||(v=!0,hn(vt,`RPC '${e}' stream ${i} transport errored:`,N),b.So(new P(x.UNAVAILABLE,"The operation could not be completed")))}),M(p,Uo.EventType.MESSAGE,N=>{var V;if(!v){let H=N.data[0];W(!!H);let O=H,Y=O.error||((V=O[0])===null||V===void 0?void 0:V.error);if(Y){k(vt,`RPC '${e}' stream ${i} received error:`,Y);let ee=Y.status,Z=function(w){let E=Ye[w];if(E!==void 0)return gb(E)}(ee),I=Y.message;Z===void 0&&(Z=x.INTERNAL,I="Unknown error status: "+ee+" with message "+Y.message),v=!0,b.So(new P(Z,I)),p.close()}else k(vt,`RPC '${e}' stream ${i} received:`,H),b.bo(H)}}),M(a,Dm.STAT_EVENT,N=>{N.stat===Ql.PROXY?k(vt,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===Ql.NOPROXY&&k(vt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{b.wo()},0),b}};function Hb(){return typeof window<"u"?window:null}function id(){return typeof document<"u"?document:null}function ku(n){return new uy(n,!0)}var Tu=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&k("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Ld=class{constructor(e,t,r,i,o,s,a,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Tu(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return R(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return R(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return R(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===x.RESOURCE_EXHAUSTED?(ze(t.toString()),ze("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===x.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new P(x.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>R(this,null,function*(){this.state=0,this.start()}))}I_(e){return k("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(k("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Ky=class extends Ld{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=AF(this.serializer,e),r=function(o){if(!("targetChange"in o))return K.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?K.min():s.readTime?We(s.readTime):K.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=dy(this.serializer),t.addTarget=function(o,s){let a,c=s.target;if(a=pd(c)?{documents:Db(o,c)}:{query:Cb(o,c)._t},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=yb(o,s.resumeToken);let l=cy(o,s.expectedCount);l!==null&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(K.min())>0){a.readTime=as(o,s.snapshotVersion.toTimestamp());let l=cy(o,s.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=RF(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=dy(this.serializer),t.removeTarget=e,this.a_(t)}},Qy=class extends Ld{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return W(!!e.streamToken),this.lastStreamToken=e.streamToken,W(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){W(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=xF(e.writeResults,e.commitTime),r=We(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=dy(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Iu(this.serializer,r))};this.a_(t)}};var Yy=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new P(x.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Mo(e,ly(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new P(x.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Lo(e,ly(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new P(x.UNKNOWN,s.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Zy=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ze(t),this.D_=!1):k("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var Jy=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(s=>{r.enqueueAndForget(()=>R(this,null,function*(){zr(this)&&(k("RemoteStore","Restarting streams for network reachability change."),yield function(c){return R(this,null,function*(){let l=j(c);l.L_.add(4),yield ws(l),l.q_.set("Unknown"),l.L_.delete(4),yield Ou(l)})}(this))}))}),this.q_=new Zy(r,i)}};function Ou(n){return R(this,null,function*(){if(zr(n))for(let e of n.B_)yield e(!0)})}function ws(n){return R(this,null,function*(){for(let e of n.B_)yield e(!1)})}function ih(n,e){let t=j(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),zv(t)?qv(t):Es(t).r_()&&Hv(t,e))}function hs(n,e){let t=j(n),r=Es(t);t.N_.delete(e),r.r_()&&qb(t,e),t.N_.size===0&&(r.r_()?r.o_():zr(t)&&t.q_.set("Unknown"))}function Hv(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(K.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Es(n).A_(e)}function qb(n,e){n.Q_.xe(e),Es(n).R_(e)}function qv(n){n.Q_=new ay({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Es(n).start(),n.q_.v_()}function zv(n){return zr(n)&&!Es(n).n_()&&n.N_.size>0}function zr(n){return j(n).L_.size===0}function zb(n){n.Q_=void 0}function zF(n){return R(this,null,function*(){n.q_.set("Online")})}function GF(n){return R(this,null,function*(){n.N_.forEach((e,t)=>{Hv(n,e)})})}function WF(n,e){return R(this,null,function*(){zb(n),zv(n)?(n.q_.M_(e),qv(n)):n.q_.set("Unknown")})}function KF(n,e,t){return R(this,null,function*(){if(n.q_.set("Online"),e instanceof vd&&e.state===2&&e.cause)try{yield function(i,o){return R(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.N_.delete(a),i.Q_.removeTarget(a))})}(n,e)}catch(r){k("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Vd(n,r)}else if(e instanceof es?n.Q_.Ke(e):e instanceof yd?n.Q_.He(e):n.Q_.We(e),!t.isEqual(K.min()))try{let r=yield Vb(n.localStore);t.compareTo(r)>=0&&(yield function(o,s){let a=o.Q_.rt(s);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let h=o.N_.get(l);h&&o.N_.set(l,h.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach((c,l)=>{let h=o.N_.get(c);if(!h)return;o.N_.set(c,h.withResumeToken(Ke.EMPTY_BYTE_STRING,h.snapshotVersion)),qb(o,c);let p=new us(h.target,c,l,h.sequenceNumber);Hv(o,p)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){k("RemoteStore","Failed to raise snapshot:",r),yield Vd(n,r)}})}function Vd(n,e,t){return R(this,null,function*(){if(!qr(e))throw e;n.L_.add(1),yield ws(n),n.q_.set("Offline"),t||(t=()=>Vb(n.localStore)),n.asyncQueue.enqueueRetryable(()=>R(this,null,function*(){k("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Ou(n)}))})}function Gb(n,e){return e().catch(t=>Vd(n,t,e))}function Is(n){return R(this,null,function*(){let e=j(n),t=$r(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;QF(e);)try{let i=yield UF(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,YF(e,i)}catch(i){yield Vd(e,i)}Wb(e)&&Kb(e)})}function QF(n){return zr(n)&&n.O_.length<10}function YF(n,e){n.O_.push(e);let t=$r(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Wb(n){return zr(n)&&!$r(n).n_()&&n.O_.length>0}function Kb(n){$r(n).start()}function ZF(n){return R(this,null,function*(){$r(n).p_()})}function JF(n){return R(this,null,function*(){let e=$r(n);for(let t of n.O_)e.m_(t.mutations)})}function XF(n,e,t){return R(this,null,function*(){let r=n.O_.shift(),i=iy.from(r,e,t);yield Gb(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Is(n)})}function eL(n,e){return R(this,null,function*(){e&&$r(n).V_&&(yield function(r,i){return R(this,null,function*(){if(function(s){return pb(s)&&s!==x.ABORTED}(i.code)){let o=r.O_.shift();$r(r).s_(),yield Gb(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Is(r)}})}(n,e)),Wb(n)&&Kb(n)})}function _T(n,e){return R(this,null,function*(){let t=j(n);t.asyncQueue.verifyOperationInProgress(),k("RemoteStore","RemoteStore received new credentials");let r=zr(t);t.L_.add(3),yield ws(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Ou(t)})}function Xy(n,e){return R(this,null,function*(){let t=j(n);e?(t.L_.delete(2),yield Ou(t)):e||(t.L_.add(2),yield ws(t),t.q_.set("Unknown"))})}function Es(n){return n.K_||(n.K_=function(t,r,i){let o=j(t);return o.w_(),new Ky(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:zF.bind(null,n),Ro:GF.bind(null,n),mo:WF.bind(null,n),d_:KF.bind(null,n)}),n.B_.push(e=>R(this,null,function*(){e?(n.K_.s_(),zv(n)?qv(n):n.q_.set("Unknown")):(yield n.K_.stop(),zb(n))}))),n.K_}function $r(n){return n.U_||(n.U_=function(t,r,i){let o=j(t);return o.w_(),new Qy(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:ZF.bind(null,n),mo:eL.bind(null,n),f_:JF.bind(null,n),g_:XF.bind(null,n)}),n.B_.push(e=>R(this,null,function*(){e?(n.U_.s_(),yield Is(n)):(yield n.U_.stop(),n.O_.length>0&&(k("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var ev=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new nt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new P(x.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Ds(n,e){if(ze("AsyncQueue",`${e}: ${n}`),qr(n))return new P(x.UNAVAILABLE,`${e}: ${n}`);throw n}var jd=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=nu(),this.sortedSet=new ke(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Bd=class{constructor(){this.W_=new ke(B.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):q():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},fs=class n{constructor(e,t,r,i,o,s,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,jd.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Nu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var tv=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},nv=class{constructor(){this.queries=wT(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=j(t),o=i.queries;i.queries=wT(),o.forEach((s,a)=>{for(let c of a.j_)c.onError(r)})})(this,new P(x.ABORTED,"Firestore shutting down"))}};function wT(){return new On(n=>eb(n),Nu)}function Gv(n,e){return R(this,null,function*(){let t=j(n),r=3,i=e.query,o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new tv,r=e.J_()?0:1);try{switch(r){case 0:o.z_=yield t.onListen(i,!0);break;case 1:o.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=Ds(s,`Initialization of query '${Wo(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&Kv(t)})}function Wv(n,e){return R(this,null,function*(){let t=j(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.j_.indexOf(e);s>=0&&(o.j_.splice(s,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function tL(n,e){let t=j(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.j_)a.X_(i)&&(r=!0);s.z_=i}}r&&Kv(t)}function nL(n,e,t){let r=j(n),i=r.queries.get(e);if(i)for(let o of i.j_)o.onError(t);r.queries.delete(e)}function Kv(n){n.Y_.forEach(e=>{e.next()})}var rv,IT;(IT=rv||(rv={})).ea="default",IT.Cache="cache";var bu=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new fs(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=fs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==rv.Cache}};var iv=class{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}};var Ud=class{constructor(e){this.serializer=e}Es(e){return Mn(this.serializer,e)}ds(e){return e.metadata.exists?Eb(this.serializer,e.document,!1):Xe.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return We(e)}},ov=class{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Qb(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;let r=ye.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){let t=new Map,r=new Ud(this.serializer);for(let i of e)if(i.metadata.queries){let o=r.Es(i.metadata.name);for(let s of i.metadata.queries){let a=(t.get(s)||ie()).add(o);t.set(s,a)}}return t}complete(){return R(this,null,function*(){let e=yield $F(this.localStore,new Ud(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(let r of this.queries)yield HF(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}})}};function Qb(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var $d=class{constructor(e){this.key=e}},Hd=class{constructor(e){this.key=e}},qd=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ie(),this.mutatedKeys=ie(),this.Aa=nb(e),this.Ra=new jd(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Bd,i=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{let m=i.get(h),v=Pu(this.query,p)?p:null,b=!!m&&this.mutatedKeys.has(m.key),M=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations),N=!1;m&&v?m.data.isEqual(v.data)?b!==M&&(r.track({type:3,doc:v}),N=!0):this.ga(m,v)||(r.track({type:2,doc:v}),N=!0,(c&&this.Aa(v,c)>0||l&&this.Aa(v,l)<0)&&(a=!0)):!m&&v?(r.track({type:0,doc:v}),N=!0):m&&!v&&(r.track({type:1,doc:m}),N=!0,(c||l)&&(a=!0)),N&&(v?(s=s.add(v),o=M?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Ra:s,fa:r,ns:a,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let s=e.fa.G_();s.sort((h,p)=>function(v,b){let M=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return q()}};return M(v)-M(b)}(h.type,p.type)||this.Aa(h.doc,p.doc)),this.pa(r),i=i!=null&&i;let a=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,l=c!==this.Ea;return this.Ea=c,s.length!==0||l?{snapshot:new fs(this.query,e.Ra,o,s,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Bd,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=ie(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Hd(r))}),this.da.forEach(r=>{e.has(r)||t.push(new $d(r))}),t}ba(e){this.Ta=e.Ts,this.da=ie();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return fs.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},sv=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},av=class{constructor(e){this.key=e,this.va=!1}},uv=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new On(a=>eb(a),Nu),this.Ma=new Map,this.xa=new Set,this.Oa=new ke(B.comparator),this.Na=new Map,this.La=new Du,this.Ba={},this.ka=new Map,this.qa=cs.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function rL(n,e,t=!0){return R(this,null,function*(){let r=oh(n),i,o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=yield Yb(r,e,t,!0),i})}function iL(n,e){return R(this,null,function*(){let t=oh(n);yield Yb(t,e,!0,!1)})}function Yb(n,e,t,r){return R(this,null,function*(){let i=yield ls(n.localStore,At(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return r&&(a=yield Qv(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&ih(n.remoteStore,i),a})}function Qv(n,e,t,r,i){return R(this,null,function*(){n.Ka=(p,m,v)=>function(M,N,V,H){return R(this,null,function*(){let O=N.view.ma(V);O.ns&&(O=yield Nd(M.localStore,N.query,!1).then(({documents:I})=>N.view.ma(I,O)));let Y=H&&H.targetChanges.get(N.targetId),ee=H&&H.targetMismatches.get(N.targetId)!=null,Z=N.view.applyChanges(O,M.isPrimaryClient,Y,ee);return cv(M,N.targetId,Z.wa),Z.snapshot})}(n,p,m,v);let o=yield Nd(n.localStore,e,!0),s=new qd(e,o.Ts),a=s.ma(o.documents),c=_u.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=s.applyChanges(a,n.isPrimaryClient,c);cv(n,t,l.wa);let h=new sv(e,t,s);return n.Fa.set(e,h),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),l.snapshot})}function oL(n,e,t){return R(this,null,function*(){let r=j(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(s=>!Nu(s,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield ds(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&hs(r.remoteStore,i.targetId),ps(r,i.targetId)}).catch(Hr))):(ps(r,i.targetId),yield ds(r.localStore,i.targetId,!0))})}function sL(n,e){return R(this,null,function*(){let t=j(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),hs(t.remoteStore,r.targetId))})}function aL(n,e,t){return R(this,null,function*(){let r=Xv(n);try{let i=yield function(s,a){let c=j(s),l=Ve.now(),h=a.reduce((v,b)=>v.add(b.key),ie()),p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",v=>{let b=Pt(),M=ie();return c.cs.getEntries(v,h).next(N=>{b=N,b.forEach((V,H)=>{H.isValidDocument()||(M=M.add(V))})}).next(()=>c.localDocuments.getOverlayedDocuments(v,b)).next(N=>{p=N;let V=[];for(let H of a){let O=IF(H,p.get(H.key).overlayedDocument);O!=null&&V.push(new pn(H.key,O,WT(O.value.mapValue),$e.exists(!0)))}return c.mutationQueue.addMutationBatch(v,l,V,a)}).next(N=>{m=N;let V=N.applyToLocalDocumentSet(p,M);return c.documentOverlayCache.saveOverlays(v,N.batchId,V)})}).then(()=>({batchId:m.batchId,changes:ib(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,c){let l=s.Ba[s.currentUser.toKey()];l||(l=new ke(re)),l=l.insert(a,c),s.Ba[s.currentUser.toKey()]=l}(r,i.batchId,t),yield ar(r,i.changes),yield Is(r.remoteStore)}catch(i){let o=Ds(i,"Failed to persist write");t.reject(o)}})}function Zb(n,e){return R(this,null,function*(){let t=j(n);try{let r=yield BF(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.Na.get(o);s&&(W(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.va=!0:i.modifiedDocuments.size>0?W(s.va):i.removedDocuments.size>0&&(W(s.va),s.va=!1))}),yield ar(t,r,e)}catch(r){yield Hr(r)}})}function ET(n,e,t){let r=j(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,s)=>{let a=s.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){let c=j(s);c.onlineState=a;let l=!1;c.queries.forEach((h,p)=>{for(let m of p.j_)m.Z_(a)&&(l=!0)}),l&&Kv(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function uL(n,e,t){return R(this,null,function*(){let r=j(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),o=i&&i.key;if(o){let s=new ke(B.comparator);s=s.insert(o,Xe.newNoDocument(o,K.min()));let a=ie().add(o),c=new vu(K.min(),new Map,new ke(re),s,a);yield Zb(r,c),r.Oa=r.Oa.remove(o),r.Na.delete(e),Jv(r)}else yield ds(r.localStore,e,!1).then(()=>ps(r,e,t)).catch(Hr)})}function cL(n,e){return R(this,null,function*(){let t=j(n),r=e.batch.batchId;try{let i=yield jF(t.localStore,e);Zv(t,r,null),Yv(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ar(t,i)}catch(i){yield Hr(i)}})}function lL(n,e,t){return R(this,null,function*(){let r=j(n);try{let i=yield function(s,a){let c=j(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return c.mutationQueue.lookupMutationBatch(l,a).next(p=>(W(p!==null),h=p.keys(),c.mutationQueue.removeMutationBatch(l,p))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>c.localDocuments.getDocuments(l,h))})}(r.localStore,e);Zv(r,e,t),Yv(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ar(r,i)}catch(i){yield Hr(i)}})}function dL(n,e){return R(this,null,function*(){let t=j(n);zr(t.remoteStore)||k("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(s){let a=j(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.ka.get(r)||[];i.push(e),t.ka.set(r,i)}catch(r){let i=Ds(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function Yv(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Zv(n,e,t){let r=j(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function ps(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||Jb(n,r)})}function Jb(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(hs(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Jv(n))}function cv(n,e,t){for(let r of t)r instanceof $d?(n.La.addReference(r.key,e),hL(n,r)):r instanceof Hd?(k("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||Jb(n,r.key)):q()}function hL(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(k("SyncEngine","New document in limbo: "+t),n.xa.add(r),Jv(n))}function Jv(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new B(ye.fromString(e)),r=n.qa.next();n.Na.set(r,new av(t)),n.Oa=n.Oa.insert(t,r),ih(n.remoteStore,new us(At(_s(t.path)),r,"TargetPurposeLimboResolution",jt.oe))}}function ar(n,e,t){return R(this,null,function*(){let r=j(n),i=[],o=[],s=[];r.Fa.isEmpty()||(r.Fa.forEach((a,c)=>{s.push(r.Ka(c,e,t).then(l=>{var h;if((l||t)&&r.isPrimaryClient){let p=l?!l.fromCache:(h=t?.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(l){i.push(l);let p=Uy.Wi(c.targetId,l);o.push(p)}}))}),yield Promise.all(s),r.Ca.d_(i),yield function(c,l){return R(this,null,function*(){let h=j(c);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>S.forEach(l,m=>S.forEach(m.$i,v=>h.persistence.referenceDelegate.addReference(p,m.targetId,v)).next(()=>S.forEach(m.Ui,v=>h.persistence.referenceDelegate.removeReference(p,m.targetId,v)))))}catch(p){if(!qr(p))throw p;k("LocalStore","Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let v=h.os.get(m),b=v.snapshotVersion,M=v.withLastLimboFreeSnapshotVersion(b);h.os=h.os.insert(m,M)}}})}(r.localStore,o))})}function fL(n,e){return R(this,null,function*(){let t=j(n);if(!t.currentUser.isEqual(e)){k("SyncEngine","User change. New user:",e.toKey());let r=yield Lb(t.localStore,e);t.currentUser=e,function(o,s){o.ka.forEach(a=>{a.forEach(c=>{c.reject(new P(x.CANCELLED,s))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ar(t,r.hs)}})}function pL(n,e){let t=j(n),r=t.Na.get(e);if(r&&r.va)return ie().add(r.key);{let i=ie(),o=t.Ma.get(e);if(!o)return i;for(let s of o){let a=t.Fa.get(s);i=i.unionWith(a.view.Va)}return i}}function gL(n,e){return R(this,null,function*(){let t=j(n),r=yield Nd(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&cv(t,e.targetId,i.wa),i})}function mL(n,e){return R(this,null,function*(){let t=j(n);return Ub(t.localStore,e).then(r=>ar(t,r))})}function yL(n,e,t,r){return R(this,null,function*(){let i=j(n),o=yield function(a,c){let l=j(a),h=j(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",p=>h.Mn(p,c).next(m=>m?l.localDocuments.getDocuments(p,m):S.resolve(null)))}(i.localStore,e);o!==null?(t==="pending"?yield Is(i.remoteStore):t==="acknowledged"||t==="rejected"?(Zv(i,e,r||null),Yv(i,e),function(a,c){j(j(a).mutationQueue).On(c)}(i.localStore,e)):q(),yield ar(i,o)):k("SyncEngine","Cannot apply mutation batch with id: "+e)})}function vL(n,e){return R(this,null,function*(){let t=j(n);if(oh(t),Xv(t),e===!0&&t.Qa!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield DT(t,r.toArray());t.Qa=!0,yield Xy(t.remoteStore,!0);for(let o of i)ih(t.remoteStore,o)}else if(e===!1&&t.Qa!==!1){let r=[],i=Promise.resolve();t.Ma.forEach((o,s)=>{t.sharedClientState.isLocalQueryTarget(s)?r.push(s):i=i.then(()=>(ps(t,s),ds(t.localStore,s,!0))),hs(t.remoteStore,s)}),yield i,yield DT(t,r),function(s){let a=j(s);a.Na.forEach((c,l)=>{hs(a.remoteStore,l)}),a.La.pr(),a.Na=new Map,a.Oa=new ke(B.comparator)}(t),t.Qa=!1,yield Xy(t.remoteStore,!1)}})}function DT(n,e,t){return R(this,null,function*(){let r=j(n),i=[],o=[];for(let s of e){let a,c=r.Ma.get(s);if(c&&c.length!==0){a=yield ls(r.localStore,At(c[0]));for(let l of c){let h=r.Fa.get(l),p=yield gL(r,h);p.snapshot&&o.push(p.snapshot)}}else{let l=yield Bb(r.localStore,s);a=yield ls(r.localStore,l),yield Qv(r,Xb(l),s,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(o),i})}function Xb(n){return XT(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function _L(n){return function(t){return j(j(t).persistence).Qi()}(j(n).localStore)}function wL(n,e,t,r){return R(this,null,function*(){let i=j(n);if(i.Qa)return void k("SyncEngine","Ignoring unexpected query state notification.");let o=i.Ma.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{let s=yield Ub(i.localStore,tb(o[0])),a=vu.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ke.EMPTY_BYTE_STRING);yield ar(i,s,a);break}case"rejected":yield ds(i.localStore,e,!0),ps(i,e,r);break;default:q()}})}function IL(n,e,t){return R(this,null,function*(){let r=oh(n);if(r.Qa){for(let i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){k("SyncEngine","Adding an already active target "+i);continue}let o=yield Bb(r.localStore,i),s=yield ls(r.localStore,o);yield Qv(r,Xb(o),s.targetId,!1,s.resumeToken),ih(r.remoteStore,s)}for(let i of t)r.Ma.has(i)&&(yield ds(r.localStore,i,!1).then(()=>{hs(r.remoteStore,i),ps(r,i)}).catch(Hr))}})}function oh(n){let e=j(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Zb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=pL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=uL.bind(null,e),e.Ca.d_=tL.bind(null,e.eventManager),e.Ca.$a=nL.bind(null,e.eventManager),e}function Xv(n){let e=j(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=cL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lL.bind(null,e),e}function EL(n,e,t){let r=j(n);(function(o,s,a){return R(this,null,function*(){try{let c=yield s.getMetadata();if(yield function(v,b){let M=j(v),N=We(b.createTime);return M.persistence.runTransaction("hasNewerBundle","readonly",V=>M.Gr.getBundleMetadata(V,b.id)).then(V=>!!V&&V.createTime.compareTo(N)>=0)}(o.localStore,c))return yield s.close(),a._completeWith(function(v){return{taskState:"Success",documentsLoaded:v.totalDocuments,bytesLoaded:v.totalBytes,totalDocuments:v.totalDocuments,totalBytes:v.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(Qb(c));let l=new ov(c,o.localStore,s.serializer),h=yield s.Ua();for(;h;){let m=yield l.la(h);m&&a._updateProgress(m),h=yield s.Ua()}let p=yield l.complete();return yield ar(o,p.Ia,void 0),yield function(v,b){let M=j(v);return M.persistence.runTransaction("Save bundle","readwrite",N=>M.Gr.saveBundleMetadata(N,b))}(o.localStore,c),a._completeWith(p.progress),Promise.resolve(p.Pa)}catch(c){return hn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var lv=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return R(this,null,function*(){this.serializer=ku(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return Fb(this.persistence,new Md,t.initialUser,this.serializer)}Ga(t){return new xd(Rd.Zr,this.serializer)}Wa(t){return new Od}terminate(){return R(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var zd=class n extends lv{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return R(this,null,function*(){yield rf(n.prototype,this,"initialize").call(this,e),yield this.Ja.initialize(this,e),yield Xv(this.Ja.syncEngine),yield Is(this.Ja.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}za(e){return Fb(this.persistence,new Md,e.initialUser,this.serializer)}ja(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new Ty(r,e.asyncQueue,t)}Ha(e,t){let r=new $m(t,this.persistence);return new Um(e.asyncQueue,r)}Ga(e){let t=$v(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Jt.withCacheSize(this.cacheSizeBytes):Jt.DEFAULT;return new By(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Hb(),id(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new Od}},dv=class n extends zd{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return R(this,null,function*(){yield rf(n.prototype,this,"initialize").call(this,e);let t=this.Ja.syncEngine;this.sharedClientState instanceof uu&&(this.sharedClientState.syncEngine={no:yL.bind(null,t),ro:wL.bind(null,t),io:IL.bind(null,t),Qi:_L.bind(null,t),eo:mL.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.yi(r=>R(this,null,function*(){yield vL(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}Wa(e){let t=Hb();if(!uu.D(t))throw new P(x.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=$v(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new uu(t,e.asyncQueue,r,e.clientId,e.initialUser)}},e_=(()=>{class n{initialize(t,r){return R(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>ET(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=fL.bind(null,this.syncEngine),yield Xy(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new nv}()}createDatastore(t){let r=ku(t.databaseInfo.databaseId),i=function(s){return new Wy(s)}(t.databaseInfo);return function(s,a,c,l){return new Yy(s,a,c,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,s,a,c){return new Jy(i,o,s,a,c)}(this.localStore,this.datastore,t.asyncQueue,r=>ET(this.syncEngine,r,0),function(){return Fd.D()?new Fd:new zy}())}createSyncEngine(t,r){return function(o,s,a,c,l,h,p){let m=new uv(o,s,a,c,l,h);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return R(this,null,function*(){var t,r;yield function(o){return R(this,null,function*(){let s=j(o);k("RemoteStore","RemoteStore shutting down."),s.L_.add(5),yield ws(s),s.k_.shutdown(),s.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();function CT(n,e=10240){let t=0;return{read(){return R(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return R(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var gs=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ze("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var hv=class{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new nt,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}getMetadata(){return R(this,null,function*(){return this.metadata.promise})}Ua(){return R(this,null,function*(){return yield this.getMetadata(),this.tu()})}tu(){return R(this,null,function*(){let e=yield this.nu();if(e===null)return null;let t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);let i=yield this.iu(r);return new iv(JSON.parse(i),e.length+r)})}su(){return this.buffer.findIndex(e=>e===123)}nu(){return R(this,null,function*(){for(;this.su()<0&&!(yield this.ou()););if(this.buffer.length===0)return null;let e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}iu(e){return R(this,null,function*(){for(;this.buffer.length<e;)(yield this.ou())&&this.ru("Reached the end of bundle when more is expected.");let t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}ou(){return R(this,null,function*(){let e=yield this.Xa.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var fv=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return R(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new P(x.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,o){return R(this,null,function*(){let s=j(i),a={documents:o.map(p=>wu(s.serializer,p))},c=yield s.Lo("BatchGetDocuments",s.serializer.databaseId,ye.emptyPath(),a,o.length),l=new Map;c.forEach(p=>{let m=SF(s.serializer,p);l.set(m.key.toString(),m)});let h=[];return o.forEach(p=>{let m=l.get(p.toString());W(!!m),h.push(m)}),h})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ur(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return R(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=B.fromPath(r);this.mutations.push(new gu(i,this.precondition(i)))}),yield function(r,i){return R(this,null,function*(){let o=j(r),s={writes:i.map(a=>Iu(o.serializer,a))};yield o.Mo("Commit",o.serializer.databaseId,ye.emptyPath(),s)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw q();t=K.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new P(x.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(K.min())?$e.exists(!1):$e.updateTime(t):$e.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(K.min()))throw new P(x.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return $e.updateTime(t)}return $e.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var pv=class{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this._u=r.maxAttempts,this.t_=new Tu(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(()=>R(this,null,function*(){let e=new fv(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})}))}cu(e){try{let t=this.updateFunction(e);return!Ru(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!pb(t)}return!1}};var gv=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Je.UNAUTHENTICATED,this.clientId=sd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,s=>R(this,null,function*(){k("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(k("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new nt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>R(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Ds(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Rm(n,e){return R(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),k("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>R(this,null,function*(){r.isEqual(i)||(yield Lb(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function TT(n,e){return R(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield t_(n);k("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>_T(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>_T(e.remoteStore,i)),n._onlineComponents=e})}function t_(n){return R(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){k("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Rm(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===x.FAILED_PRECONDITION||i.code===x.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;hn("Error using user provided cache. Falling back to memory cache: "+t),yield Rm(n,new lv)}}else k("FirestoreClient","Using default OfflineComponentProvider"),yield Rm(n,new lv);return n._offlineComponents})}function sh(n){return R(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(k("FirestoreClient","Using user provided OnlineComponentProvider"),yield TT(n,n._uninitializedComponentsProvider._online)):(k("FirestoreClient","Using default OnlineComponentProvider"),yield TT(n,new e_))),n._onlineComponents})}function eS(n){return t_(n).then(e=>e.persistence)}function n_(n){return t_(n).then(e=>e.localStore)}function tS(n){return sh(n).then(e=>e.remoteStore)}function r_(n){return sh(n).then(e=>e.syncEngine)}function DL(n){return sh(n).then(e=>e.datastore)}function ms(n){return R(this,null,function*(){let e=yield sh(n),t=e.eventManager;return t.onListen=rL.bind(null,e.syncEngine),t.onUnlisten=oL.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=iL.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=sL.bind(null,e.syncEngine),t})}function CL(n){return n.asyncQueue.enqueue(()=>R(this,null,function*(){let e=yield eS(n),t=yield tS(n);return e.setNetworkEnabled(!0),function(i){let o=j(i);return o.L_.delete(0),Ou(o)}(t)}))}function TL(n){return n.asyncQueue.enqueue(()=>R(this,null,function*(){let e=yield eS(n),t=yield tS(n);return e.setNetworkEnabled(!1),function(i){return R(this,null,function*(){let o=j(i);o.L_.add(0),yield ws(o),o.q_.set("Offline")})}(t)}))}function bL(n,e){let t=new nt;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,o,s){return R(this,null,function*(){try{let a=yield function(l,h){let p=j(l);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,h))}(i,o);a.isFoundDocument()?s.resolve(a):a.isNoDocument()?s.resolve(null):s.reject(new P(x.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=Ds(a,`Failed to get document '${o} from cache`);s.reject(c)}})}(yield n_(n),e,t)})),t.promise}function nS(n,e,t={}){let r=new nt;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(o,s,a,c,l){let h=new gs({next:m=>{h.Za(),s.enqueueAndForget(()=>Wv(o,p));let v=m.docs.has(a);!v&&m.fromCache?l.reject(new P(x.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&m.fromCache&&c&&c.source==="server"?l.reject(new P(x.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new bu(_s(a.path),h,{includeMetadataChanges:!0,_a:!0});return Gv(o,p)}(yield ms(n),n.asyncQueue,e,t,r)})),r.promise}function SL(n,e){let t=new nt;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,o,s){return R(this,null,function*(){try{let a=yield Nd(i,o,!0),c=new qd(o,a.Ts),l=c.ma(a.documents),h=c.applyChanges(l,!1);s.resolve(h.snapshot)}catch(a){let c=Ds(a,`Failed to execute query '${o} against cache`);s.reject(c)}})}(yield n_(n),e,t)})),t.promise}function rS(n,e,t={}){let r=new nt;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(o,s,a,c,l){let h=new gs({next:m=>{h.Za(),s.enqueueAndForget(()=>Wv(o,p)),m.fromCache&&c.source==="server"?l.reject(new P(x.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new bu(a,h,{includeMetadataChanges:!0,_a:!0});return Gv(o,p)}(yield ms(n),n.asyncQueue,e,t,r)})),r.promise}function AL(n,e){let t=new gs(e);return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,o){j(i).Y_.add(o),o.next()}(yield ms(n),t)})),()=>{t.Za(),n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,o){j(i).Y_.delete(o)}(yield ms(n),t)}))}}function xL(n,e,t,r){let i=function(s,a){let c;return c=typeof s=="string"?mb().encode(s):s,function(h,p){return new hv(h,p)}(function(h,p){if(h instanceof Uint8Array)return CT(h,p);if(h instanceof ArrayBuffer)return CT(new Uint8Array(h),p);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,ku(e));n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){EL(yield r_(n),i,r)}))}function RL(n,e){return n.asyncQueue.enqueue(()=>R(this,null,function*(){return function(r,i){let o=j(r);return o.persistence.runTransaction("Get named query","readonly",s=>o.Gr.getNamedQuery(s,i))}(yield n_(n),e)}))}function iS(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var bT=new Map;function i_(n,e,t){if(!t)throw new P(x.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function o_(n,e,t,r){if(e===!0&&r===!0)throw new P(x.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function ST(n){if(!B.isDocumentKey(n))throw new P(x.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function AT(n){if(B.isDocumentKey(n))throw new P(x.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ah(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":q()}function _e(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new P(x.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=ah(n);throw new P(x.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function oS(n,e){if(e<=0)throw new P(x.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var Gd=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new P(x.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new P(x.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}o_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=iS((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new P(x.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new P(x.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new P(x.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Oi=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Gd({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new P(x.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new P(x.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gd(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Mm;switch(r.type){case"firstParty":return new Om(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new P(x.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return R(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=bT.get(t);r&&(k("ComponentProvider","Removing Datastore"),bT.delete(t),r.terminate())}(this),Promise.resolve()}};function sS(n,e,t,r={}){var i;let o=(n=_e(n,Oi))._getSettings(),s=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&hn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Je.MOCK_USER;else{a=Nw(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new P(x.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Je(l)}n._authCredentials=new Nm(new od(a,c))}}var ct=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Me=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Nn=class n extends ct{constructor(e,t,r){super(e,t,_s(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Me(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function s_(n,e,...t){if(n=Fe(n),i_("collection","path",e),n instanceof Oi){let r=ye.fromString(e,...t);return AT(r),new Nn(n,null,r)}{if(!(n instanceof Me||n instanceof Nn))throw new P(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ye.fromString(e,...t));return AT(r),new Nn(n.firestore,null,r)}}function aS(n,e){if(n=_e(n,Oi),i_("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new P(x.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ct(n,null,function(r){return new fn(ye.emptyPath(),r)}(e))}function Fu(n,e,...t){if(n=Fe(n),arguments.length===1&&(e=sd.newId()),i_("doc","path",e),n instanceof Oi){let r=ye.fromString(e,...t);return ST(r),new Me(n,null,new B(r))}{if(!(n instanceof Me||n instanceof Nn))throw new P(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ye.fromString(e,...t));return ST(r),new Me(n.firestore,n instanceof Nn?n.converter:null,new B(r))}}function a_(n,e){return n=Fe(n),e=Fe(e),(n instanceof Me||n instanceof Nn)&&(e instanceof Me||e instanceof Nn)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function u_(n,e){return n=Fe(n),e=Fe(e),n instanceof ct&&e instanceof ct&&n.firestore===e.firestore&&Nu(n._query,e._query)&&n.converter===e.converter}var Wd=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Tu(this,"async_queue_retry"),this.Vu=()=>{let r=id();r&&k("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=id();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=id();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new nt;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return R(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!qr(e))throw e;k("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),a}(r);throw ze("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=ev.createAndSchedule(this,e,t,r,o=>this.yu(o));return this.Tu.push(i),i}fu(){this.Eu&&q()}verifyOperationInProgress(){}wu(){return R(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function mv(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var yv=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new nt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var uS=-1,je=class extends Oi{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Wd,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return R(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Wd(e),this._firestoreClient=void 0,yield e}})}};function lt(n){if(n._terminated)throw new P(x.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||cS(n),n._firestoreClient}function cS(n){var e,t,r;let i=n._freezeSettings(),o=function(a,c,l,h){return new Hm(a,c,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,iS(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new gv(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}}(n._componentsProvider))}function lS(n,e){hn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return hS(n,e_.provider,{build:r=>new zd(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function dS(n){return R(this,null,function*(){hn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();hS(n,e_.provider,{build:t=>new dv(t,e.cacheSizeBytes)})})}function hS(n,e,t){if((n=_e(n,je))._firestoreClient||n._terminated)throw new P(x.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new P(x.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},cS(n)}function fS(n){if(n._initialized&&!n._terminated)throw new P(x.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new nt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>R(this,null,function*(){try{yield function(r){return R(this,null,function*(){if(!kr.D())return Promise.resolve();let i=r+"main";yield kr.delete(i)})}($v(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function pS(n){return function(t){let r=new nt;return t.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return dL(yield r_(t),r)})),r.promise}(lt(n=_e(n,je)))}function gS(n){return CL(lt(n=_e(n,je)))}function mS(n){return TL(lt(n=_e(n,je)))}function yS(n,e){let t=lt(n=_e(n,je)),r=new yv;return xL(t,n._databaseId,e,r),r}function vS(n,e){return RL(lt(n=_e(n,je)),e).then(t=>t?new ct(n,null,t.query):null)}var Fn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ke.fromBase64String(e))}catch(t){throw new P(x.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ke.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var gn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new P(x.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ge(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var or=class{constructor(e){this._methodName=e}};var Fi=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new P(x.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new P(x.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return re(this._lat,e._lat)||re(this._long,e._long)}};var Su=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var ML=/^__.*__$/,vv=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new pn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Br(e,this.data,t,this.fieldTransforms)}},Kd=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new pn(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function _S(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw q()}}var Qd=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Yd(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(_S(this.Cu)&&ML.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},_v=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ku(e)}Qu(e,t,r,i=!1){return new Qd({Cu:e,methodName:t,qu:r,path:Ge.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Bi(n){let e=n._freezeSettings(),t=ku(n._databaseId);return new _v(n._databaseId,!!e.ignoreUndefinedProperties,t)}function uh(n,e,t,r,i,o={}){let s=n.Qu(o.merge||o.mergeFields?2:0,e,t,i);d_("Data must be an object, but it was:",s,r);let a=ES(r,s),c,l;if(o.merge)c=new Bt(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){let h=[];for(let p of o.mergeFields){let m=Cv(e,p,t);if(!s.contains(m))throw new P(x.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);CS(h,m)||h.push(m)}c=new Bt(h),l=s.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,l=s.fieldTransforms;return new vv(new _t(a),c,l)}var Au=class n extends or{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function wS(n,e,t){return new Qd({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var wv=class n extends or{_toFieldTransform(e){return new Ni(e.path,new Vr)}isEqual(e){return e instanceof n}},Iv=class n extends or{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=wS(this,e,!0),r=this.Ku.map(o=>Ui(o,t)),i=new rr(r);return new Ni(e.path,i)}isEqual(e){return e instanceof n&&af(this.Ku,e.Ku)}},Ev=class n extends or{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=wS(this,e,!0),r=this.Ku.map(o=>Ui(o,t)),i=new ir(r);return new Ni(e.path,i)}isEqual(e){return e instanceof n&&af(this.Ku,e.Ku)}},Dv=class n extends or{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){let t=new jr(e.serializer,ab(e.serializer,this.$u));return new Ni(e.path,t)}isEqual(e){return e instanceof n&&this.$u===e.$u}};function c_(n,e,t,r){let i=n.Qu(1,e,t);d_("Data must be an object, but it was:",i,r);let o=[],s=_t.empty();ji(r,(c,l)=>{let h=h_(e,c,t);l=Fe(l);let p=i.Nu(h);if(l instanceof Au)o.push(h);else{let m=Ui(l,p);m!=null&&(o.push(h),s.set(h,m))}});let a=new Bt(o);return new Kd(s,a,i.fieldTransforms)}function l_(n,e,t,r,i,o){let s=n.Qu(1,e,t),a=[Cv(e,r,t)],c=[i];if(o.length%2!=0)throw new P(x.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<o.length;m+=2)a.push(Cv(e,o[m])),c.push(o[m+1]);let l=[],h=_t.empty();for(let m=a.length-1;m>=0;--m)if(!CS(l,a[m])){let v=a[m],b=c[m];b=Fe(b);let M=s.Nu(v);if(b instanceof Au)l.push(v);else{let N=Ui(b,M);N!=null&&(l.push(v),h.set(v,N))}}let p=new Bt(l);return new Kd(h,p,s.fieldTransforms)}function IS(n,e,t,r=!1){return Ui(t,n.Qu(r?4:3,e))}function Ui(n,e){if(DS(n=Fe(n)))return d_("Unsupported field value:",e,n),ES(n,e);if(n instanceof or)return function(r,i){if(!_S(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let o=[],s=0;for(let a of r){let c=Ui(a,i.Lu(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Fe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return ab(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Ve.fromDate(r);return{timestampValue:as(i.serializer,o)}}if(r instanceof Ve){let o=new Ve(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:as(i.serializer,o)}}if(r instanceof Fi)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Fn)return{bytesValue:yb(i.serializer,r._byteString)};if(r instanceof Me){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.Bu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:jv(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Su)return function(s,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(c=>{if(typeof c!="number")throw a.Bu("VectorValues must only contain numeric values.");return Vv(a.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${ah(r)}`)}(n,e)}function ES(n,e){let t={};return HT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ji(n,(r,i)=>{let o=Ui(i,e.Mu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function DS(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ve||n instanceof Fi||n instanceof Fn||n instanceof Me||n instanceof or||n instanceof Su)}function d_(n,e,t){if(!DS(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=ah(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Cv(n,e,t){if((e=Fe(e))instanceof gn)return e._internalPath;if(typeof e=="string")return h_(n,e);throw Yd("Field path arguments must be of type string or ",n,!1,void 0,t)}var NL=new RegExp("[~\\*/\\[\\]]");function h_(n,e,t){if(e.search(NL)>=0)throw Yd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new gn(...e.split("."))._internalPath}catch{throw Yd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Yd(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${r}`),s&&(c+=` in document ${i}`),c+=")"),new P(x.INVALID_ARGUMENT,a+n+c)}function CS(n,e){return n.some(t=>t.isEqual(e))}var Li=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Tv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(ch("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Tv=class extends Li{data(){return super.data()}};function ch(n,e){return typeof e=="string"?h_(n,e):e instanceof gn?e._internalPath:e._delegate._internalPath}function TS(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new P(x.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var xu=class{},Vi=class extends xu{};function ur(n,e,...t){let r=[];e instanceof xu&&r.push(e),r=r.concat(t),function(o){let s=o.filter(c=>c instanceof bv).length,a=o.filter(c=>c instanceof Zd).length;if(s>1||s>0&&a>0)throw new P(x.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Zd=class n extends Vi{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return OS(e._query,t),new ct(e.firestore,e.converter,ny(e._query,t))}_parse(e){let t=Bi(e.firestore);return function(o,s,a,c,l,h,p){let m;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new P(x.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){RT(p,h);let v=[];for(let b of p)v.push(xT(c,o,b));m={arrayValue:{values:v}}}else m=xT(c,o,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||RT(p,h),m=IS(a,s,p,h==="in"||h==="not-in");return he.create(l,h,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function bS(n,e,t){let r=e,i=ch("where",n);return Zd._create(i,r,t)}var bv=class n extends xu{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:be.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,a=o.getFlattenedFilters();for(let c of a)OS(s,c),s=ny(s,c)}(e._query,t),new ct(e.firestore,e.converter,ny(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Sv=class n extends Vi{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,s){if(i.startAt!==null)throw new P(x.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new P(x.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ri(o,s)}(e._query,this._field,this._direction);return new ct(e.firestore,e.converter,function(i,o){let s=i.explicitOrderBy.concat([o]);return new fn(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function SS(n,e="asc"){let t=e,r=ch("orderBy",n);return Sv._create(r,t)}var Jd=class n extends Vi{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new ct(e.firestore,e.converter,md(e._query,this._limit,this._limitType))}};function AS(n){return oS("limit",n),Jd._create("limit",n,"F")}function xS(n){return oS("limitToLast",n),Jd._create("limitToLast",n,"L")}var Xd=class n extends Vi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=kS(e,this.type,this._docOrFields,this._inclusive);return new ct(e.firestore,e.converter,function(i,o){return new fn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,t))}};function RS(...n){return Xd._create("startAt",n,!0)}function MS(...n){return Xd._create("startAfter",n,!1)}var eh=class n extends Vi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=kS(e,this.type,this._docOrFields,this._inclusive);return new ct(e.firestore,e.converter,function(i,o){return new fn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(e._query,t))}};function NS(...n){return eh._create("endBefore",n,!1)}function PS(...n){return eh._create("endAt",n,!0)}function kS(n,e,t,r){if(t[0]=Fe(t[0]),t[0]instanceof Li)return function(o,s,a,c,l){if(!c)throw new P(x.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let h=[];for(let p of Xo(o))if(p.field.isKeyField())h.push(xi(s,c.key));else{let m=c.data.field(p.field);if(nh(m))throw new P(x.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){let v=p.field.canonicalString();throw new P(x.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}h.push(m)}return new kn(h,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Bi(n.firestore);return function(s,a,c,l,h,p){let m=s.explicitOrderBy;if(h.length>m.length)throw new P(x.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let v=[];for(let b=0;b<h.length;b++){let M=h[b];if(m[b].field.isKeyField()){if(typeof M!="string")throw new P(x.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof M}`);if(!Fv(s)&&M.indexOf("/")!==-1)throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${M}' contains a slash.`);let N=s.path.child(ye.fromString(M));if(!B.isDocumentKey(N))throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);let V=new B(N);v.push(xi(a,V))}else{let N=IS(c,l,M);v.push(N)}}return new kn(v,p)}(n._query,n.firestore._databaseId,i,e,t,r)}}function xT(n,e,t){if(typeof(t=Fe(t))=="string"){if(t==="")throw new P(x.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Fv(e)&&t.indexOf("/")!==-1)throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ye.fromString(t));if(!B.isDocumentKey(r))throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xi(n,new B(r))}if(t instanceof Me)return xi(n,t._key);throw new P(x.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ah(t)}.`)}function RT(n,e){if(!Array.isArray(n)||n.length===0)throw new P(x.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function OS(n,e){let t=function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new P(x.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(x.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var ys=class{convertValue(e,t="none"){switch(Ai(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Oe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Or(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw q()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return ji(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>Oe(s.doubleValue));return new Su(o)}convertGeoPoint(e){return new Fi(Oe(e.latitude),Oe(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=kv(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(hu(e));default:return null}}convertTimestamp(e){let t=nr(e);return new Ve(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ye.fromString(e);W(Ab(r));let i=new Fr(r.get(1),r.get(3)),o=new B(r.popFirst(5));return i.isEqual(t)||ze(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function lh(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Av=class extends ys{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,t)}};var tr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},en=class extends Li{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Nr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(ch("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Nr=class extends en{data(e={}){return super.data(e)}},mn=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new tr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Nr(this._firestore,this._userDataWriter,r.key,r,new tr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new P(x.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let c=new Nr(i._firestore,i._userDataWriter,a.doc.key,a.doc,new tr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let c=new Nr(i._firestore,i._userDataWriter,a.doc.key,a.doc,new tr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,h=-1;return a.type!==0&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),h=s.indexOf(a.doc.key)),{type:PL(a.type),doc:c,oldIndex:l,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function PL(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return q()}}function f_(n,e){return n instanceof en&&e instanceof en?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof mn&&e instanceof mn&&n._firestore===e._firestore&&u_(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function FS(n){n=_e(n,Me);let e=_e(n.firestore,je);return nS(lt(e),n._key).then(t=>y_(e,n,t))}var sr=class extends ys{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,t)}};function LS(n){n=_e(n,Me);let e=_e(n.firestore,je),t=lt(e),r=new sr(e);return bL(t,n._key).then(i=>new en(e,r,n._key,i,new tr(i!==null&&i.hasLocalMutations,!0),n.converter))}function VS(n){n=_e(n,Me);let e=_e(n.firestore,je);return nS(lt(e),n._key,{source:"server"}).then(t=>y_(e,n,t))}function jS(n){n=_e(n,ct);let e=_e(n.firestore,je),t=lt(e),r=new sr(e);return TS(n._query),rS(t,n._query).then(i=>new mn(e,r,n,i))}function BS(n){n=_e(n,ct);let e=_e(n.firestore,je),t=lt(e),r=new sr(e);return SL(t,n._query).then(i=>new mn(e,r,n,i))}function US(n){n=_e(n,ct);let e=_e(n.firestore,je),t=lt(e),r=new sr(e);return rS(t,n._query,{source:"server"}).then(i=>new mn(e,r,n,i))}function p_(n,e,t){n=_e(n,Me);let r=_e(n.firestore,je),i=lh(n.converter,e,t);return Cs(r,[uh(Bi(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,$e.none())])}function g_(n,e,t,...r){n=_e(n,Me);let i=_e(n.firestore,je),o=Bi(i),s;return s=typeof(e=Fe(e))=="string"||e instanceof gn?l_(o,"updateDoc",n._key,e,t,r):c_(o,"updateDoc",n._key,e),Cs(i,[s.toMutation(n._key,$e.exists(!0))])}function $S(n){return Cs(_e(n.firestore,je),[new Ur(n._key,$e.none())])}function HS(n,e){let t=_e(n.firestore,je),r=Fu(n),i=lh(n.converter,e);return Cs(t,[uh(Bi(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,$e.exists(!1))]).then(()=>r)}function m_(n,...e){var t,r,i;n=Fe(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||mv(e[s])||(o=e[s],s++);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(mv(e[s])){let p=e[s];e[s]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[s+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[s+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let c,l,h;if(n instanceof Me)l=_e(n.firestore,je),h=_s(n._key.path),c={next:p=>{e[s]&&e[s](y_(l,n,p))},error:e[s+1],complete:e[s+2]};else{let p=_e(n,ct);l=_e(p.firestore,je),h=p._query;let m=new sr(l);c={next:v=>{e[s]&&e[s](new mn(l,m,p,v))},error:e[s+1],complete:e[s+2]},TS(n._query)}return function(m,v,b,M){let N=new gs(M),V=new bu(v,N,b);return m.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return Gv(yield ms(m),V)})),()=>{N.Za(),m.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return Wv(yield ms(m),V)}))}}(lt(l),h,a,c)}function qS(n,e){return AL(lt(n=_e(n,je)),mv(e)?e:{next:e})}function Cs(n,e){return function(r,i){let o=new nt;return r.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return aL(yield r_(r),i,o)})),o.promise}(lt(n),e)}function y_(n,e,t){let r=t.docs.get(e._key),i=new sr(n);return new en(n,i,e._key,r,new tr(t.hasPendingWrites,t.fromCache),e.converter)}var kL={maxAttempts:5};var th=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Bi(e)}set(e,t,r){this._verifyNotCommitted();let i=Rr(e,this._firestore),o=lh(i.converter,t,r),s=uh(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(s.toMutation(i._key,$e.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let o=Rr(e,this._firestore),s;return s=typeof(t=Fe(t))=="string"||t instanceof gn?l_(this._dataReader,"WriteBatch.update",o._key,t,r,i):c_(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(s.toMutation(o._key,$e.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Rr(e,this._firestore);return this._mutations=this._mutations.concat(new Ur(t._key,$e.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new P(x.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Rr(n,e){if((n=Fe(n)).firestore!==e)throw new P(x.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var xv=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Bi(t)}get(t){let r=Rr(t,this._firestore),i=new Av(this._firestore);return this._transaction.lookup([r._key]).then(o=>{if(!o||o.length!==1)return q();let s=o[0];if(s.isFoundDocument())return new Li(this._firestore,i,s.key,s,r.converter);if(s.isNoDocument())return new Li(this._firestore,i,r._key,null,r.converter);throw q()})}set(t,r,i){let o=Rr(t,this._firestore),s=lh(o.converter,r,i),a=uh(this._dataReader,"Transaction.set",o._key,s,o.converter!==null,i);return this._transaction.set(o._key,a),this}update(t,r,i,...o){let s=Rr(t,this._firestore),a;return a=typeof(r=Fe(r))=="string"||r instanceof gn?l_(this._dataReader,"Transaction.update",s._key,r,i,o):c_(this._dataReader,"Transaction.update",s._key,r),this._transaction.update(s._key,a),this}delete(t){let r=Rr(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Rr(e,this._firestore),r=new sr(this._firestore);return super.get(e).then(i=>new en(this._firestore,r,t._key,i._document,new tr(!1,!1),t.converter))}};function zS(n,e,t){n=_e(n,je);let r=Object.assign(Object.assign({},kL),t);return function(o){if(o.maxAttempts<1)throw new P(x.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(o,s,a){let c=new nt;return o.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){let l=yield DL(o);new pv(o.asyncQueue,l,a,s,c).au()})),c.promise}(lt(n),i=>e(new xv(n,i)),r)}function GS(){return new Au("deleteField")}function WS(){return new wv("serverTimestamp")}function KS(...n){return new Iv("arrayUnion",n)}function QS(...n){return new Ev("arrayRemove",n)}function YS(n){return new Dv("increment",n)}(function(e,t=!0){(function(i){vs=i})(Ow),Ys(new Yr("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new je(new Pm(r.getProvider("auth-internal")),new Lm(r.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new P(x.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fr(l.options.projectId,h)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),fr(A0,"4.7.3",e),fr(A0,"4.7.3","esm2017")})();var OL="@firebase/firestore-compat",FL="0.3.38";function D_(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new P("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function ZS(){if(typeof Uint8Array>"u")throw new P("unimplemented","Uint8Arrays are not available in this environment.")}function JS(){if(!qT())throw new P("unimplemented","Blobs are unavailable in Firestore in this environment.")}var dh=class n{constructor(e){this._delegate=e}static fromBase64String(e){return JS(),new n(Fn.fromBase64String(e))}static fromUint8Array(e){return ZS(),new n(Fn.fromUint8Array(e))}toBase64(){return JS(),this._delegate.toBase64()}toUint8Array(){return ZS(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function v_(n){return LL(n,["next","error","complete"])}function LL(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var __=class{enableIndexedDbPersistence(e,t){return lS(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return dS(e._delegate)}clearIndexedDbPersistence(e){return fS(e._delegate)}},hh=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Fr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&hn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){sS(this._delegate,e,t,r)}enableNetwork(){return gS(this._delegate)}disableNetwork(){return mS(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,o_("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return pS(this._delegate)}onSnapshotsInSync(e){return qS(this._delegate,e)}get app(){if(!this._appCompat)throw new P("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ss(this,s_(this._delegate,e))}catch(t){throw xt(t,"collection()","Firestore.collection()")}}doc(e){try{return new Ln(this,Fu(this._delegate,e))}catch(t){throw xt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new zi(this,aS(this._delegate,e))}catch(t){throw xt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return zS(this._delegate,t=>e(new fh(this,t)))}batch(){return lt(this._delegate),new ph(new th(this._delegate,e=>Cs(this._delegate,e)))}loadBundle(e){return yS(this._delegate,e)}namedQuery(e){return vS(this._delegate,e).then(t=>t?new zi(this,t):null)}},Ts=class extends ys{constructor(e){super(),this.firestore=e}convertBytes(e){return new dh(new Fn(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Ln.forKey(t,this.firestore,null)}};function VL(n){MT(n)}var fh=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Ts(e)}get(e){let t=$i(e);return this._delegate.get(t).then(r=>new Hi(this._firestore,new en(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=$i(e);return r?(D_("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=$i(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=$i(e);return this._delegate.delete(t),this}},ph=class{constructor(e){this._delegate=e}set(e,t,r){let i=$i(e);return r?(D_("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let o=$i(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){let t=$i(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},bs=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new Nr(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new qi(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let o=i.get(t);return o||(o=new n(e,new Ts(e),t),i.set(t,o)),o}};bs.INSTANCES=new WeakMap;var Ln=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ts(e)}static forPath(e,t,r){if(e.length%2!==0)throw new P("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new Me(t._delegate,r,new B(e)))}static forKey(e,t,r){return new n(t,new Me(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Ss(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ss(this.firestore,s_(this._delegate,e))}catch(t){throw xt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Fe(e),e instanceof Me?a_(this._delegate,e):!1}set(e,t){t=D_("DocumentReference.set",t);try{return t?p_(this._delegate,e,t):p_(this._delegate,e)}catch(r){throw xt(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?g_(this._delegate,e):g_(this._delegate,e,t,...r)}catch(i){throw xt(i,"updateDoc()","DocumentReference.update()")}}delete(){return $S(this._delegate)}onSnapshot(...e){let t=XS(e),r=eA(e,i=>new Hi(this.firestore,new en(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return m_(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=LS(this._delegate):e?.source==="server"?t=VS(this._delegate):t=FS(this._delegate),t.then(r=>new Hi(this.firestore,new en(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(bs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function xt(n,e,t){return n.message=n.message.replace(e,t),n}function XS(n){for(let e of n)if(typeof e=="object"&&!v_(e))return e;return{}}function eA(n,e){var t,r;let i;return v_(n[0])?i=n[0]:v_(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:o=>{i.next&&i.next(e(o))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Hi=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Ln(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return f_(this._delegate,e._delegate)}},qi=class extends Hi{data(e){let t=this._delegate.data(e);return this._delegate._converter||NT(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},zi=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ts(e)}where(e,t,r){try{return new n(this.firestore,ur(this._delegate,bS(e,t,r)))}catch(i){throw xt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,ur(this._delegate,SS(e,t)))}catch(r){throw xt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,ur(this._delegate,AS(e)))}catch(t){throw xt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,ur(this._delegate,xS(e)))}catch(t){throw xt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,ur(this._delegate,RS(...e)))}catch(t){throw xt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,ur(this._delegate,MS(...e)))}catch(t){throw xt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,ur(this._delegate,NS(...e)))}catch(t){throw xt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,ur(this._delegate,PS(...e)))}catch(t){throw xt(t,"endAt()","Query.endAt()")}}isEqual(e){return u_(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=BS(this._delegate):e?.source==="server"?t=US(this._delegate):t=jS(this._delegate),t.then(r=>new Lu(this.firestore,new mn(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=XS(e),r=eA(e,i=>new Lu(this.firestore,new mn(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return m_(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(bs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},w_=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new qi(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Lu=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new zi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new qi(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new w_(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new qi(this._firestore,r))})}isEqual(e){return f_(this._delegate,e._delegate)}},Ss=class n extends zi{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Ln(this.firestore,e):null}doc(e){try{return e===void 0?new Ln(this.firestore,Fu(this._delegate)):new Ln(this.firestore,Fu(this._delegate,e))}catch(t){throw xt(t,"doc()","CollectionReference.doc()")}}add(e){return HS(this._delegate,e).then(t=>new Ln(this.firestore,t))}isEqual(e){return a_(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(bs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function $i(n){return _e(n,Me)}var I_=class n{constructor(...e){this._delegate=new gn(...e)}static documentId(){return new n(Ge.keyField().canonicalString())}isEqual(e){return e=Fe(e),e instanceof gn?this._delegate._internalPath.isEqual(e._internalPath):!1}};var E_=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=WS();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=GS();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=KS(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=QS(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=YS(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var jL={Firestore:hh,GeoPoint:Fi,Timestamp:Ve,Blob:dh,Transaction:fh,WriteBatch:ph,DocumentReference:Ln,DocumentSnapshot:Hi,Query:zi,QueryDocumentSnapshot:qi,QuerySnapshot:Lu,CollectionReference:Ss,FieldPath:I_,FieldValue:E_,setLogLevel:VL,CACHE_SIZE_UNLIMITED:uS};function BL(n,e){n.INTERNAL.registerComponent(new Yr("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},jL)))}function UL(n){BL(n,(e,t)=>new hh(e,t,new __)),n.registerVersion(OL,FL)}UL(Rt);function $L(n,e=ea){return new fe(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function tA(n,e){return $L(n,e)}function HL(n,e){return tA(n,e).pipe(ti(void 0),ra(),z(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function b_(n,e){return tA(n,e).pipe(z(t=>({payload:t,type:"query"})))}var gh=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:o}=sA(r,t);return new yh(i,o,this.afs)}snapshotChanges(){return HL(this.ref,this.afs.schedulers.outsideAngular).pipe(Nt)}valueChanges(e={}){return this.snapshotChanges().pipe(z(({payload:t})=>e.idField?Pe(U({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return Ce(this.ref.get(e)).pipe(Nt)}};function mh(n,e){return b_(n,e).pipe(ti(void 0),ra(),z(t=>{let[r,i]=t,o=i.payload.docChanges(),s=o.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let l=o.find(p=>p.doc.ref.isEqual(a.ref)),h=r?.payload.docs.find(p=>p.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&h&&JSON.stringify(h.metadata)===JSON.stringify(a.metadata)||s.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),s}))}function nA(n,e,t){return mh(n,t).pipe(ei((r,i)=>qL(r,i.map(o=>o.payload),e),[]),Mf(),z(r=>r.map(i=>({type:i.type,payload:i}))))}function qL(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=zL(n,r))}),n}function C_(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function zL(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&n[e.newIndex].doc.ref.isEqual(e.doc.ref)))return C_(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return C_(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return C_(n,e.oldIndex,1);break}return n}function rA(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var yh=class{ref;query;afs;constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=mh(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(z(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(ti(void 0),ra(),gt(([r,i])=>i.length>0||!r),z(([,r])=>r),Nt)}auditTrail(e){return this.stateChanges(e).pipe(ei((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=rA(e);return nA(this.query,t,this.afs.schedulers.outsideAngular).pipe(Nt)}valueChanges(e={}){return b_(this.query,this.afs.schedulers.outsideAngular).pipe(z(t=>t.payload.docs.map(r=>e.idField?Pe(U({},r.data()),{[e.idField]:r.id}):r.data())),Nt)}get(e){return Ce(this.query.get(e)).pipe(Nt)}add(e){return this.ref.add(e)}doc(e){return new gh(this.ref.doc(e),this.afs)}},T_=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?mh(this.query,this.afs.schedulers.outsideAngular).pipe(Nt):mh(this.query,this.afs.schedulers.outsideAngular).pipe(z(t=>t.filter(r=>e.indexOf(r.type)>-1)),gt(t=>t.length>0),Nt)}auditTrail(e){return this.stateChanges(e).pipe(ei((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=rA(e);return nA(this.query,t,this.afs.schedulers.outsideAngular).pipe(Nt)}valueChanges(e={}){return b_(this.query,this.afs.schedulers.outsideAngular).pipe(z(r=>r.payload.docs.map(i=>e.idField?U({[e.idField]:i.id},i.data()):i.data())),Nt)}get(e){return Ce(this.query.get(e)).pipe(Nt)}},iA=new Q("angularfire2.enableFirestorePersistence"),oA=new Q("angularfire2.firestore.persistenceSettings"),GL=new Q("angularfire2.firestore.settings"),WL=new Q("angularfire2.firestore.use-emulator");function sA(n,e=t=>t){return{query:e(n),ref:n}}var Ut=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,r,i,o,s,a,c,l,h,p,m,v,b,M,N,V,H){this.schedulers=c;let O=Qa(t,a,r),Y=h;p&&_m(O,a,m,b,M,N,v,V),[this.firestore,this.persistenceEnabled$]=Gl(`${O.name}.firestore`,"AngularFirestore",O.name,()=>{let ee=a.runOutsideAngular(()=>O.firestore());if(o&&ee.settings(o),Y&&ee.useEmulator(...Y),i&&!pi(s)){let Z=()=>{try{return Ce(ee.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(I){return typeof console<"u"&&console.warn(I),J(!1)}};return[ee,a.runOutsideAngular(Z)]}else return[ee,J(!1)]},[o,Y,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:o,query:s}=sA(i,r),a=this.schedulers.ngZone.run(()=>o);return new yh(a,s,this)}collectionGroup(t,r){let i=r||(s=>s),o=this.firestore.collectionGroup(t);return new T_(i(o),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.schedulers.ngZone.run(()=>r);return new gh(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(F(jo),F(Bo,8),F(iA,8),F(GL,8),F(Qt),F(Ae),F(ql),F(oA,8),F(WL,8),F(T0,8),F(fm,8),F(pm,8),F(gm,8),F(mm,8),F(ym,8),F(vm,8),F(_i,8))};static \u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),aA=(()=>{class n{constructor(){Rt.registerVersion("angularfire",Vo.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:iA,useValue:!0},{provide:oA,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Wn({type:n});static \u0275inj=Gn({providers:[Ut]})}return n})();var uA={production:!1,firebase:{apiKey:"AIzaSyAhFvcQd4E5oul3fR56in85HDuEIr0UoQw",authDomain:"my-cv-6e9c0.firebaseapp.com",projectId:"my-cv-6e9c0",storageBucket:"my-cv-6e9c0.firebasestorage.app",messagingSenderId:"425171695930",appId:"1:425171695930:web:e9899d1bf34eef296d3803"}};var cA={providers:[a0(u0),Pp(h0.initializeApp(uA.firebase),aA)]};var vh=class{id;name;description;email;phoneNumber;location;"photo url";GitHub;Linkedin};var _h=class n{constructor(e){this.db=e;this.headerRef=e.collection(this.dbPath)}accesoHeader="header service running...";dbPath="/header";headerRef;getHeader(){return this.headerRef}static \u0275fac=function(t){return new(t||n)(F(Ut))};static \u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})};var wh=class n{constructor(e){this.headerService=e;console.log(this.headerService),this.headerService.getHeader().snapshotChanges().pipe(z(t=>t.map(r=>U({id:r.payload.doc.id},r.payload.doc.data())))).subscribe(t=>{this.header=t[0],console.log(this.header)})}header=new vh;static \u0275fac=function(t){return new(t||n)(ot(_h))};static \u0275cmp=mt({type:n,selectors:[["app-header"]],standalone:!0,features:[yt],decls:21,vars:8,consts:[[1,"header-table"],[1,"info-cell"],[1,"photo-cell"],["alt","Foto de perfil",1,"profile-img",3,"src"],[1,"contact-cell"],["target","_blank",3,"href"]],template:function(t,r){t&1&&(ue(0,"table",0)(1,"tr")(2,"td",1)(3,"h3"),ve(4),ce(),ue(5,"p"),ve(6),ce()(),ue(7,"td",2),de(8,"img",3),ce(),ue(9,"td",4),ve(10),de(11,"br"),ve(12),de(13,"br"),ve(14),de(15,"br"),ue(16,"a",5),ve(17,"GitHub"),ce(),de(18,"br"),ue(19,"a",5),ve(20,"LinkedIn"),ce()()()()),t&2&&(ge(4),wl(r.header.name),ge(2),wl(r.header.description),ge(2),bt("src",r.header["photo url"],gl),ge(2),Te(" ",r.header.email,""),ge(2),Te(" ",r.header.phoneNumber,""),ge(2),Te(" ",r.header.location,""),ge(2),bt("href",r.header.GitHub,gl),ge(3),bt("href",r.header.Linkedin,gl))},styles:[".header-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.photo-cell[_ngcontent-%COMP%]{text-align:center;vertical-align:middle;padding:10px}.profile-img[_ngcontent-%COMP%]{width:180px;height:180px;border-radius:50%;object-fit:cover;border:3px solid #f0f0f0;display:block;margin:0 auto}.info-cell[_ngcontent-%COMP%]{text-align:left;width:40%}.contact-cell[_ngcontent-%COMP%]{text-align:right;width:30%}@media (max-width: 480px){.profile-img[_ngcontent-%COMP%]{width:120px;height:120px}}"]})};var Ih=class n{constructor(e){this.db=e;this.workExperienceRef=e.collection(this.dbPath)}accesoWorkExperience="work experience running...";dbPath="/work-experience";workExperienceRef;getWorkExperience(){return this.workExperienceRef}static \u0275fac=function(t){return new(t||n)(F(Ut))};static \u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})};function YL(n,e){if(n&1&&(ue(0,"ul")(1,"li"),ve(2),ue(3,"i"),ve(4),ce(),de(5,"br"),ue(6,"b"),ve(7),ce(),de(8,"br"),ve(9),de(10,"br"),ce()()),n&2){let t=e.$implicit;ge(2),Ea(" ",t.startDate," - ",t.endDate," "),ge(2),Te("",t.Location," "),ge(3),Te(" ",t.Position," "),ge(2),Te(" ",t.Company," ")}}var Eh=class n{constructor(e){this.workExperienceService=e;console.log(this.workExperienceService),this.workExperienceService.getWorkExperience().snapshotChanges().pipe(z(t=>t.map(r=>U({id:r.payload.doc.id},r.payload.doc.data())))).subscribe(t=>{this.workExperience=t,console.log(this.workExperience)})}workExperience=[];static \u0275fac=function(t){return new(t||n)(ot(Ih))};static \u0275cmp=mt({type:n,selectors:[["app-work-experience"]],standalone:!0,features:[yt],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(t,r){t&1&&un(0,YL,11,5,"ul",0),t&2&&bt("ngForOf",r.workExperience)},dependencies:[cn,bn]})};var Dh=class n{constructor(e){this.db=e;this.skillsRef=e.collection(this.dbPath)}accesoSkills="skills service running...";dbPath="/skills";skillsRef;getSkills(){return this.skillsRef}static \u0275fac=function(t){return new(t||n)(F(Ut))};static \u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})};function JL(n,e){if(n&1&&(ue(0,"ul")(1,"li"),ve(2),ce(),de(3,"br"),ue(4,"li"),ve(5),ce(),de(6,"br"),ue(7,"li"),ve(8),ce(),de(9,"br"),ue(10,"li"),ve(11),ce(),de(12,"br"),ue(13,"li"),ve(14),ce(),de(15,"br"),ue(16,"li"),ve(17),ce(),de(18,"br"),ue(19,"li"),ve(20),ce(),de(21,"br"),ue(22,"li"),ve(23),ce(),de(24,"br"),ue(25,"li"),ve(26),ce()()),n&2){let t=e.$implicit;ge(2),Te(" ",t.Angular," "),ge(3),Te(" ",t.Bootstrap," "),ge(3),Te(" ",t.CSS," "),ge(3),Te(" ",t.Python," "),ge(3),Te(" ",t.HTML," "),ge(3),Te(" ",t.Typescript," "),ge(3),Te(" ",t.React," "),ge(3),Te(" ",t["Java Script"]," "),ge(3),Te(" ",t["Git hub"]," ")}}var Ch=class n{constructor(e){this.skillsService=e}skillsList=[];ngOnInit(){this.skillsService.getSkills().snapshotChanges().pipe(z(e=>e.map(t=>U({id:t.payload.doc.id},t.payload.doc.data())))).subscribe(e=>{this.skillsList=e,console.log(this.skillsList)})}static \u0275fac=function(t){return new(t||n)(ot(Dh))};static \u0275cmp=mt({type:n,selectors:[["app-skills"]],standalone:!0,features:[yt],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(t,r){t&1&&un(0,JL,27,9,"ul",0),t&2&&bt("ngForOf",r.skillsList)},dependencies:[cn,bn]})};var Th=class n{constructor(e){this.db=e;this.educationRef=e.collection(this.dbPath)}accesoEducation="education service running...";dbPath="/education";educationRef;getEducation(){return this.educationRef}static \u0275fac=function(t){return new(t||n)(F(Ut))};static \u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})};function eV(n,e){if(n&1&&(ue(0,"ul")(1,"li"),ve(2),de(3,"br"),ue(4,"b"),ve(5),ce(),de(6,"br"),ve(7),ce()()),n&2){let t=e.$implicit;ge(2),Ea(" ",t.startDate," - ",t.endDate," "),ge(3),Te(" ",t.School," "),ge(2),Te(" ",t.Degree," ")}}var bh=class n{constructor(e){this.educationService=e}educationList=[];ngOnInit(){this.educationService.getEducation().snapshotChanges().pipe(z(e=>e.map(t=>U({id:t.payload.doc.id},t.payload.doc.data())))).subscribe(e=>{this.educationList=e,console.log(this.educationList)})}static \u0275fac=function(t){return new(t||n)(ot(Th))};static \u0275cmp=mt({type:n,selectors:[["app-education"]],standalone:!0,features:[yt],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(t,r){t&1&&un(0,eV,8,4,"ul",0),t&2&&bt("ngForOf",r.educationList)},dependencies:[cn,bn]})};var Sh=class n{constructor(e){this.db=e;this.certificatesRef=e.collection(this.dbPath)}accesoCertificates="certificates service running...";dbPath="/certificates";certificatesRef;getCertificates(){return this.certificatesRef}static \u0275fac=function(t){return new(t||n)(F(Ut))};static \u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})};function nV(n,e){if(n&1&&(ue(0,"ul")(1,"li"),ve(2),ce(),de(3,"br"),ue(4,"li"),ve(5),ce(),de(6,"br"),ue(7,"li"),ve(8),ce()()),n&2){let t=e.$implicit;ge(2),Te(" ",t.Meta," "),ge(3),Te(" ",t.Microsoft," "),ge(3),Te(" ",t.Tecnologico_de_Monterrey," ")}}var Ah=class n{constructor(e){this.certificatesService=e}certificatesList=[];ngOnInit(){this.certificatesService.getCertificates().snapshotChanges().pipe(z(e=>e.map(t=>U({id:t.payload.doc.id},t.payload.doc.data())))).subscribe(e=>{this.certificatesList=e,console.log(this.certificatesList)})}static \u0275fac=function(t){return new(t||n)(ot(Sh))};static \u0275cmp=mt({type:n,selectors:[["app-certificates"]],standalone:!0,features:[yt],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(t,r){t&1&&un(0,nV,9,3,"ul",0),t&2&&bt("ngForOf",r.certificatesList)},dependencies:[cn,bn]})};var xh=class n{constructor(e){this.db=e;this.languagesRef=e.collection(this.dbPath)}accesoLanguages="languages service running...";dbPath="/languages";languagesRef;getLanguages(){return this.languagesRef}static \u0275fac=function(t){return new(t||n)(F(Ut))};static \u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})};function iV(n,e){if(n&1&&(ue(0,"ul")(1,"li")(2,"b"),ve(3),ce(),de(4,"br"),ce()()),n&2){let t=e.$implicit;ge(3),Te(" ",t.English," ")}}var Rh=class n{constructor(e){this.languagesService=e}languagesList=[];ngOnInit(){this.languagesService.getLanguages().snapshotChanges().pipe(z(e=>e.map(t=>U({id:t.payload.doc.id},t.payload.doc.data())))).subscribe(e=>{this.languagesList=e,console.log(this.languagesList)})}static \u0275fac=function(t){return new(t||n)(ot(xh))};static \u0275cmp=mt({type:n,selectors:[["app-languages"]],standalone:!0,features:[yt],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(t,r){t&1&&un(0,iV,5,1,"ul",0),t&2&&bt("ngForOf",r.languagesList)},dependencies:[cn,bn]})};var Mh=class n{title="mycv";static \u0275fac=function(t){return new(t||n)};static \u0275cmp=mt({type:n,selectors:[["app-root"]],standalone:!0,features:[yt],decls:18,vars:0,consts:[[1,"main-container"],["colspan","2"],[2,"width","60%"],[2,"width","40%"],[2,"border-bottom","2px solid black"]],template:function(t,r){t&1&&(ue(0,"div",0)(1,"table")(2,"tr")(3,"td",1),de(4,"app-header"),ce()(),ue(5,"tr")(6,"td",2),de(7,"app-work-experience"),ce(),ue(8,"td",3),de(9,"app-skills"),ce()(),ue(10,"tr")(11,"td",4),de(12,"app-education"),ce(),ue(13,"td",4),de(14,"app-certificates"),ce()(),ue(15,"tr")(16,"td",1),de(17,"app-languages"),ce()()()())},dependencies:[wh,Eh,Ch,bh,Ah,Rh],styles:["body[_ngcontent-%COMP%]{background-color:#e3f2fd;margin:0;padding:0;min-height:100vh}.main-container[_ngcontent-%COMP%]{background-color:#f0f7ff;padding:20px;border-radius:10px;box-shadow:0 0 15px #0000000d;margin-top:20px}"]})};DC(Mh,cA).catch(n=>console.error(n));
